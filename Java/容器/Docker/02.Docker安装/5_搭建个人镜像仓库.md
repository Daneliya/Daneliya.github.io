---
url: /Java/容器/Docker/02.Docker安装/5_搭建个人镜像仓库.md
---

# 搭建个人镜像仓库

https://blog.csdn.net/weixin\_44008788/article/details/144722354

https://cr.console.aliyun.com/

使用阿里云容器镜像服务（ACR）创建并上传自定义镜像，我会按 “注册配置→准备镜像→推送镜像” 的完整流程，一步步教你操作，确保新手也能轻松完成。

### 前提条件

1. 已注册阿里云账号（https://www.aliyun.com/）；
2. 本地安装 Docker（确保`docker -v`能正常输出版本）；
3. 网络能正常访问阿里云服务。

***

## 步骤 1：开通阿里云容器镜像服务并创建镜像仓库

### 1.1 开通 ACR 服务

1. 登录阿里云控制台，搜索 “容器镜像服务”（ACR）；
2. 选择 “个人版 / 企业版”（个人版免费够用），点击 “立即开通”，按提示完成开通（无需额外付费，基础版免费）。

### 1.2 创建镜像仓库

1. 开通后进入 ACR 控制台，选择左侧 “镜像仓库”→“实例列表”，点击默认实例（如`registry.cn-hangzhou.aliyuncs.com`）进入；

2. 点击 “创建镜像仓库”，填写核心信息：

   * **仓库名称**：自定义（如`my-first-image`）；
   * **命名空间**：选已有的或新建（如`my-namespace`，唯一标识）；
   * **仓库类型**：公开 / 私有（测试选公开，生产选私有）；
   * **摘要 / 描述**：可选，填镜像说明；

3. 点击 “创建”，完成后会看到仓库的**公网地址**（如`registry.cn-hangzhou.aliyuncs.com/my-namespace/my-first-image`），保存这个地址，后续推送镜像要用。

### 1.3 获取阿里云镜像仓库登录信息

1. 在镜像仓库详情页，点击 “管理”→“凭证管理”；
2. 记录：
   * 登录服务器：如`registry.cn-hangzhou.aliyuncs.com`；
   * 用户名：阿里云账号 ID（或子账号）；
   * 密码：需先设置 “访问凭证”（个人版可直接用阿里云账号密码，或创建 AccessKey）。

## 1. 登录阿里云 Container Registry

```
$ docker login --username=所爱平山海 registry.cn-hangzhou.aliyuncs.com
```

用于登录的用户名为阿里云账号全名，密码为开通服务时设置的密码。

您可以在访问凭证页面修改凭证密码。

注意：使用 RAM 用户（子账号）登录镜像仓库时，不支持企业别名带有英文半角句号（.）。

## 2. 从Registry中拉取镜像

```
$ docker pull registry.cn-hangzhou.aliyuncs.com/luckilyxxl/xxl:[镜像版本号]
```

## 3. 将镜像推送到Registry

```
$ docker login --username=所爱平山海 registry.cn-hangzhou.aliyuncs.com$ docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/luckilyxxl/xxl:[镜像版本号]$ docker push registry.cn-hangzhou.aliyuncs.com/luckilyxxl/xxl:[镜像版本号]
```

请根据实际镜像信息替换示例中的\[ImageId]和\[镜像版本号]参数。

## 4. 选择合适的镜像仓库地址

从ECS推送镜像时，可以选择使用镜像仓库内网地址。推送速度将得到提升并且将不会损耗您的公网流量。

如果您使用的机器位于VPC网络，请使用 registry-vpc.cn-hangzhou.aliyuncs.com 作为Registry的域名登录。

## 5. 示例

使用"docker tag"命令重命名镜像，并将它通过专有网络地址推送至Registry。

```
$ docker imagesREPOSITORY                                                         TAG                 IMAGE ID            CREATED             VIRTUAL SIZEregistry.aliyuncs.com/acs/agent                                    0.7-dfb6816         37bb9c63c8b2        7 days ago          37.89 MB$ docker tag 37bb9c63c8b2 registry-vpc.cn-hangzhou.aliyuncs.com/acs/agent:0.7-dfb6816
```

使用 "docker push" 命令将该镜像推送至远程。

```
$ docker push registry-vpc.cn-hangzhou.aliyuncs.com/acs/agent:0.7-dfb6816
```

### 使用 Cloudflare 部署 Docker 镜像代理

[使用 Cloudflare 部署 Docker 镜像代理 | Rokcso's Blog](https://rokcso.com/p/cloudflare-docker-proxy/)

[cmliu/CF-Workers-docker.io: 这个项目是一个基于 Cloudflare Workers 的 Docker 镜像代理工具。它能够中转对 Docker 官方镜像仓库的请求，解决一些访问限制和加速访问的问题。](https://github.com/cmliu/CF-Workers-docker.io)
