---
url: /daily/åšå®¢æ–‡æ¡£/VitPress/7_æ’ä»¶.md
---

# æ’ä»¶

## æ—¶é—´çº¿

é‡‡ç”¨äº† [@HanochMa/vitepress-markdown-timeline](https://github.com/HanochMa/vitepress-markdown-timeline) çš„é¡¹ç›®

Demoï¼šhttps://hanochma.github.io/daily/2023-04

```sh
npm install vitepress-markdown-timeline
```

åœ¨ `config.mts` ä¸­æ³¨å†Œ markdown è§£ææ’ä»¶

```js
import timeline from "vitepress-markdown-timeline"; 

export default {
  markdown: { 
    // è¡Œå·æ˜¾ç¤º
    lineNumbers: true, 

    // æ—¶é—´çº¿  // [!code focus:4]
    config: (md) => { 
      md.use(timeline); 
    },
  }, 
}
```

åœ¨ `.vitepress/theme/index.ts` ä¸­å¼•å…¥æ—¶é—´çº¿æ ·å¼

::: info è¯´æ˜

å¦‚æœä½ æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œå°±è‡ªå·±æ–°å»º

:::

```js
// .vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme'

// åªéœ€æ·»åŠ ä»¥ä¸‹ä¸€è¡Œä»£ç ï¼Œå¼•å…¥æ—¶é—´çº¿æ ·å¼
import "vitepress-markdown-timeline/dist/theme/index.css";

export default {
  extends: DefaultTheme,
}
```

æœ€åæˆ‘ä»¬åœ¨markdownæ–‡ä»¶ä¸­ï¼ŒæŒ‰æ ¼å¼ä½¿ç”¨å³å¯

è¾“å…¥ï¼š

```markdown
::: timeline 2023-04-24
- ä¸€ä¸ªéå¸¸æ£’çš„å¼€æºé¡¹ç›® H5-Dooring ç›®å‰ star 3.1k
  - å¼€æºåœ°å€ https://github.com/MrXujiang/h5-Dooring
  - åŸºæœ¬ä»‹ç» http://h5.dooring.cn/doc/zh/guide/
- ã€Šæ·±å…¥æµ…å‡ºwebpackã€‹ http://webpack.wuhaolin.cn/
:::

::: timeline 2023-04-23
:::
```

## è°·æ­Œåˆ†æ

åˆ©ç”¨æ’ä»¶ [google-analytics](https://analytics.google.com/) ï¼Œæ¥æŸ¥çœ‹ç½‘ç«™è®¿é—®é‡

è¿™é‡Œæˆ‘ä»¬ç”¨ [@ZhongxuYang/vitepress-plugin-google-analytics](https://github.com/ZhongxuYang/vitepress-plugin-google-analytics) çš„æ’ä»¶

```markdown
npm install vitepress-plugin-google-analytics
```

åœ¨ `.vitepress/theme/index.ts` ä¸­å¼•å…¥

```js
// .vitepress/theme/index.ts
import DefaultTheme from "vitepress/theme"
import googleAnalytics from 'vitepress-plugin-google-analytics'  // [!code focus:1]

export default {
  extends: DefaultTheme,
  enhanceApp({app}) {
    googleAnalytics({  // [!code focus:3]
      id: 'G-******', //è·Ÿè¸ªIDï¼Œåœ¨analytics.google.comæ³¨å†Œå³å¯
    }),
  },
}
```

## å›¾ç‰‡ç¼©æ”¾

Vuepressæ˜¯å¯ä»¥ç›´æ¥å®‰è£…æ’ä»¶ [medium-zoom](https://github.com/francoischalifour/medium-zoom) çš„ï¼Œéå¸¸å¥½ç”¨

ä½†æ˜¯Vitepressç›´æ¥ç”¨ä¸äº†ï¼Œåœ¨ [vitepressçš„issuesä¸­æ‰¾åˆ°äº†æ–¹æ³•#854](https://github.com/vuejs/vitepress/issues/854)

```sh
npm install medium-zoom
```

åœ¨ `.vitepress/theme/index.ts` æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå¹¶ä¿å­˜

```ts
// .vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme'

import mediumZoom from 'medium-zoom';
import { onMounted, watch, nextTick } from 'vue';
import { useRoute } from 'vitepress';

export default {
  extends: DefaultTheme,

  setup() {
    const route = useRoute();
    const initZoom = () => {
      // mediumZoom('[data-zoomable]', { background: 'var(--vp-c-bg)' }); // é»˜è®¤
      mediumZoom('.main img', { background: 'var(--vp-c-bg)' }); // ä¸æ˜¾å¼æ·»åŠ {data-zoomable}çš„æƒ…å†µä¸‹ä¸ºæ‰€æœ‰å›¾åƒå¯ç”¨æ­¤åŠŸèƒ½
    };
    onMounted(() => {
      initZoom();
    });
    watch(
      () => route.path,
      () => nextTick(() => initZoom())
    );
  },

}
```

ç‚¹å‡»å›¾ç‰‡åï¼Œè¿˜æ˜¯èƒ½çœ‹åˆ°å¯¼èˆªæ ï¼ŒåŠ ä¸€ä¸ªé®æŒ¡æ ·å¼

åœ¨ `.vitepress/theme/style/var.css` ä¸­åŠ å…¥å¦‚ä¸‹ä»£ç ï¼Œå¹¶ä¿å­˜

```css
/* .vitepress/theme/style/var.css */

.medium-zoom-overlay {
  z-index: 30;
}

.medium-zoom-image {
  z-index: 9999 !important;/* ç»™çš„å€¼æ˜¯21ï¼Œä½†æ˜¯å®æµ‹ç›–ä¸ä½ï¼Œç›´æ¥999 */
}
```

åœ¨ `.vitepress/theme/style/index.css` ä¸­å¼•å…¥

```css
/* å›¾ç‰‡ç¼©æ”¾ï¼Œé®æŒ¡å¯¼èˆªæ  */
@import './var.css';
```

## çœ‹æ¿å¨˜

ç¬¬ä¸€æ¬¡æ¥è§¦çš„äººä¼šæ¯”è¾ƒæ‡µï¼Œå…¶å®å°±æ˜¯åœ¨å³ä¸‹è§’æœ‰ä¸ªäºŒæ¬¡å…ƒçš„äººç‰©ï¼Œç±»ä¼¼ç”µå­å® ç‰©

è¿™é‡Œä½¿ç”¨ [@xinlei3166/vitepress-theme-website](https://github.com/xinlei3166/vitepress-theme-website) çš„ [Live2D](https://www.live2d.com/zh-CHS/) æ’ä»¶

```sh
npm install vitepress-theme-website
```

åœ¨ `.vitepress/theme/index.ts` ç²˜è´´ä¸‹é¢ä»£ç å¹¶ä¿å­˜

```js
// .vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme'

import { useLive2d } from 'vitepress-theme-website' // [!code focus:1]

export default {
  extends: DefaultTheme,

  setup() {

    // çœ‹æ¿å¨˜ // [!code focus:20]
    useLive2d({
      enable: true,
      model: {
        url: 'https://raw.githubusercontent.com/iCharlesZ/vscode-live2d-models/master/model-library/hibiki/hibiki.model.json'
      },
      display: {
        position: 'right',
        width: '135px',
        height: '300px',
        xOffset: '35px',
        yOffset: '5px'
      },
      mobile: {
        show: true
      },
      react: {
        opacity: 0.8
      }
    })

  }
}
```

æƒ³è¦æ›´æ¢æ¨¡å‹åœ¨ [@iCharlesZ](https://github.com/iCharlesZ/vscode-live2d-models#url) è¿™é‡Œæ‰¾ï¼Œæ›¿æ¢ `model` ä¸­çš„ `url` é“¾æ¥å³å¯

```js
useLive2d({
  model: {
  url: 'https://raw.githubusercontent.com/iCharlesZ/vscode-live2d-models/master/model-library/bilibili-22/index.json'  // [!code focus:1]
  }
})
```

## æµè§ˆé‡

åŸºæœ¬ä¸Šä½¿ç”¨çš„æ˜¯ [ä¸è’œå­](http://busuanzi.ibruce.info/)ï¼Œå…è´¹çš„ä¸”è¶³å¤Ÿå¥½ç”¨

```sh
npm install busuanzi.pure.js
```

```js
// .vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme'

import { inBrowser } from 'vitepress' // [!code focus:2]
import busuanzi from 'busuanzi.pure.js'

export default {
  extends: DefaultTheme,

  enhanceApp({ app , router }) { // [!code focus:7]
    if (inBrowser) {
      router.onAfterRouteChanged = () => {
        busuanzi.fetch()
      }
    }
  },
  
}
```

ä½¿ç”¨å°±å¾ˆç®€å•äº†ï¼Œå¤åˆ¶åˆ°é¡µé¢ä¸­ä½¿ç”¨å³å¯

::: tip è¯´æ˜

æœ¬åœ°å¼€å‘å‡ºç°æ•°å­—å³ç®—æˆåŠŸï¼Œç­‰ä½ éƒ¨ç½²åä¼šæ˜¾ç¤ºæ­£ç¡®çš„æ•°å€¼

:::

```markdown
æœ¬ç«™æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv" /> æ¬¡
æœ¬ç«™è®¿å®¢æ•° <span id="busuanzi_value_site_uv" /> äººæ¬¡
```

æ ·å¼è¿˜å¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚é€‰æ‹©å°è£…

## â­è‡ªåŠ¨ä¾§è¾¹æ ï¼ˆæ’ä»¶vitepress-sidebarï¼‰

å‘ç°ä¸€æ¬¾è‡ªåŠ¨ä¾§è¾¹æ ï¼Œç®€å•å¥½ç”¨ [@jooy2/vitepress-sidebar](https://github.com/jooy2/vitepress-sidebar)

å®‰è£…æ–‡æ¡£ï¼šhttps://vitepress-sidebar.jooy2.com/guide/getting-started

```sh
npm i -D vitepress-sidebar
```

åœ¨ `configs.mts` ä¸­å¼•å…¥é…ç½®ï¼Œå¯ä»¥æ ¹æ® [ä½œè€…apiæ–‡æ¡£](https://vitepress-sidebar.jooy2.com/guide/api) æŒ‰éœ€ä¿®æ”¹

```js
// .vitepress/configs.mts
import { generateSidebar } from 'vitepress-sidebar';  // [!code focus:5]

const vitepressSidebarOptions = {
  /* Options... */
};

export default defineConfig({
  themeConfig: {
    sidebar: generateSidebar({ // [!code focus:44]
      /*
       * For detailed instructions, see the links below:
       * https://vitepress-sidebar.jooy2.com/guide/api
       */
      documentRootPath: '/docs', //æ–‡æ¡£æ ¹ç›®å½•
      // scanStartPath: null,
      // resolvePath: null,
      // useTitleFromFileHeading: true,
      // useTitleFromFrontmatter: true,
      // frontmatterTitleFieldName: 'title',
      // useFolderTitleFromIndexFile: false, //æ˜¯å¦ä½¿ç”¨å±‚çº§é¦–é¡µæ–‡ä»¶ååšåˆ†çº§æ ‡é¢˜
      // useFolderLinkFromIndexFile: false, //æ˜¯å¦é“¾æ¥è‡³å±‚çº§é¦–é¡µæ–‡ä»¶
      // hyphenToSpace: true,
      // underscoreToSpace: true,
      // capitalizeFirst: false,
      // capitalizeEachWords: false,
      collapsed: false, //æŠ˜å ç»„å…³é—­
      collapseDepth: 2, //æŠ˜å ç»„2çº§èœå•
      // sortMenusByName: false,
      // sortMenusByFrontmatterOrder: false,
      // sortMenusByFrontmatterDate: false,
      // sortMenusOrderByDescending: false,
      // sortMenusOrderNumericallyFromTitle: false,
      // sortMenusOrderNumericallyFromLink: false,
      // frontmatterOrderDefaultValue: 0,
      // manualSortFileNameByPriority: ['first.md', 'second', 'third.md'], //æ‰‹åŠ¨æ’åºï¼Œæ–‡ä»¶å¤¹ä¸ç”¨å¸¦åç¼€
      removePrefixAfterOrdering: false, //åˆ é™¤å‰ç¼€ï¼Œå¿…é¡»ä¸prefixSeparatorä¸€èµ·ä½¿ç”¨
      prefixSeparator: '.', //åˆ é™¤å‰ç¼€çš„ç¬¦å·
      // excludeFiles: ['first.md', 'secret.md'],
      // excludeFilesByFrontmatterFieldName: 'exclude',
      // excludeFolders: ['secret-folder'],
      // includeDotFiles: false,
      // includeRootIndexFile: false,
      // includeFolderIndexFile: false, //æ˜¯å¦åŒ…å«å±‚çº§ä¸»é¡µ
      // includeEmptyFolder: false,
      // rootGroupText: 'Contents',
      // rootGroupLink: 'https://github.com/jooy2',
      // rootGroupCollapsed: false,
      // convertSameNameSubFileToGroupIndexPage: false,
      // folderLinkNotIncludesFileName: false,
      // keepMarkdownSyntaxFromTitle: false,
      // debugPrint: false,
    }),
  },
})
```

ä¸ºäº†é¿å…å®‰è£…æ’ä»¶å½±å“åŸé¡¹ç›®ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹

stackblitzæ¼”ç¤ºï¼šhttps://stackblitz.com/edit/vite-y1rga7

> ç­‰å¾…ç”Ÿæˆåå¯æŸ¥çœ‹ï¼Œå·¦ä¾§æ˜¯ç›®å½•ï¼Œå³ä¾§æ˜¯é¡µé¢
>
> æ³¨æ„ï¼šæ’ä»¶åœ¨è¯»å–ç›®å½•ä¹‹åï¼Œä½ å†ä¿®æ”¹æ–‡ä»¶åï¼Œéœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆ

å½“ä½äºä¸€ä¸ªé¡µé¢æ—¶ï¼Œéšè—å¦ä¸€ä¸ªé¡µé¢çš„èœå•ï¼Œå¯ä»¥å‚è€ƒ[å¤šä¾§è¾¹æ æ“ä½œæ–¹æ³• | VitePress Sidebar](https://vitepress-sidebar.cdget.com/zhHans/advanced-usage/multiple-sidebars-how-to)

### é‡å‘½åæ–‡ä»¶å¤¹å’Œæ ‡é¢˜çš„æ–¹å¼

#### 1. é€šè¿‡ Frontmatter é‡å‘½åæ–‡ä»¶å¤¹æ ‡é¢˜

```yaml
---
title: è‡ªå®šä¹‰æ–‡ä»¶å¤¹æ ‡é¢˜
---
```

åœ¨æ¯ä¸ªæ–‡ä»¶å¤¹çš„ index.md æ–‡ä»¶ä¸­è®¾ç½® title ï¼Œç„¶ååœ¨é…ç½®ä¸­å¯ç”¨ï¼š

```typescript
useTitleFromFrontmatter: true, // ä»frontmatterè·å–æ ‡é¢˜
useFolderTitleFromIndexFile: true, // ä½¿ç”¨æ–‡ä»¶å¤¹ä¸‹index.mdä½œä¸ºåˆ†ç»„æ ‡é¢˜
```

#### 2. æ‰‹åŠ¨æŒ‡å®š Frontmatter å­—æ®µå

```typescript
frontmatterTitleFieldName: 'customTitle', // ä½¿ç”¨frontmatterä¸­çš„customTitleå­—æ®µ
```

ç„¶ååœ¨ index.md ä¸­ï¼š

```yaml
---
customTitle: æˆ‘çš„è‡ªå®šä¹‰æ ‡é¢˜
---
```

#### 3. æ·»åŠ å‰åç¼€ï¼ˆæ”¯æŒå›¾æ ‡ï¼‰

```yaml
---
sidebarPrefix: ğŸš€
sidebarSuffix: <i class="iconfont icon-folder"></i>
---
```

#### 4. æ’åºæ§åˆ¶

```yaml
---
sidebarSort: 1  # æ•°å€¼è¶Šå°è¶Šé å‰
---
```

#### 5. å®Œå…¨è‡ªå®šä¹‰ä¾§è¾¹æ é¡¹

å¦‚æœéœ€è¦æ›´çµæ´»çš„æ§åˆ¶ï¼Œå¯ä»¥æ‰‹åŠ¨é…ç½®ç‰¹å®šè·¯ç”±çš„ä¾§è¾¹æ ï¼š

```typescript
export const sidebarConfig = {
    '/Java/Javaå¼€å‘æŠ€å·§/': [
        {
            text: 'ğŸš€ è‡ªå®šä¹‰åˆ†ç»„æ ‡é¢˜',
            collapsed: false,
            items: [
                {
                    text: 'è‡ªå®šä¹‰æ–‡ç« æ ‡é¢˜',
                    link: '/Java/Javaå¼€å‘æŠ€å·§/custom-guide.md'
                }
            ]
        }
    ]
}
```

#### 6. å…¶ä»–æ’ä»¶çš„é‡å‘½ååŠŸèƒ½

å¦‚æœæƒ³è·å¾—æ›´å¤šé‡å‘½åé€‰é¡¹ï¼Œå¯ä»¥è€ƒè™‘ï¼š

* vitepress-plugin-sidebar-resolve - åŠŸèƒ½æ›´ä¸°å¯Œ
* vite-plugin-vitepress-auto-nav - æ”¯æŒè·¯å¾„çº§åˆ«çš„é‡å‘½åé…ç½®

## è‡ªåŠ¨ä¾§è¾¹æ ï¼ˆæ’ä»¶vite-plugin-vitepress-auto-navï¼‰

> é¡¹ç›®åœ°å€ï¼šhttps://github.com/Xaviw/vite-plugin-vitepress-auto-nav
>
> æ•™ç¨‹ä»‹ç»ï¼šhttps://juejin.cn/post/7283060133646975012

å®‰è£…

```sh
# ä½¿ç”¨ ts æ—¶æ¨èå®‰è£… viteï¼Œå¦åˆ™ä¼šæœ‰ç±»å‹é”™è¯¯
npm i vite-plugin-vitepress-auto-nav vite -D
```

æ·»åŠ æ’ä»¶

```js
// .vitepress/config.ts
import AutoNav from "vite-plugin-vitepress-auto-nav";

export default defineConfig({
  vite: {
    plugins: [
      AutoNav({
        // è‡ªå®šä¹‰é…ç½®
        pattern: ["**/!(README|TODO).md"], // ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ’é™¤ä¸å±•ç¤ºçš„æ–‡ä»¶ï¼Œä¾‹å¦‚ä¸åŒ¹é… README å’Œ TODO æ–‡ä»¶
        settings: {
           a: { hide: true }, // ä¸æ˜¾ç¤ºåç§°ä¸º a çš„æ–‡ä»¶å¤¹æˆ– md æ–‡ä»¶
           b: { title: 'bb' }, // åç§°ä¸º b çš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶åœ¨èœå•ä¸­æ˜¾ç¤ºä¸º bb
           c/b: { sort : 3 }, // é€šè¿‡è·¯å¾„ç²¾ç¡®åŒ¹é… c æ–‡ä»¶å¤¹ä¸‹çš„ b è¿›è¡Œé…ç½®ï¼Œæ’åºæ—¶ä½äºä¸‹æ ‡3çš„ä½ç½®æˆ–æœ€å
           c/b2: { useArticleTitle: false }, // å…³é—­ä½¿ç”¨æ–‡ç« ä¸€çº§æ ‡é¢˜ä½œä¸ºæ–‡ç« åç§°
           d: { collapsed: true }, // æ–‡ä»¶å¤¹æŠ˜å é…ç½®
         },
         compareFn: (a, b) => {
           // æŒ‰æœ€æ–°æäº¤æ—¶é—´(æ²¡æœ‰æäº¤è®°å½•æ—¶ä¸ºæœ¬åœ°æ–‡ä»¶ä¿®æ”¹æ—¶é—´)å‡åºæ’åˆ—
            return (b.options.lastCommitTime || b.options.modifyTime) - (a.options.lastCommitTime || a.options.modifyTime)
          },
          useArticleTitle: true // å…¨å±€å¼€å¯ä½¿ç”¨æ–‡ç« ä¸€çº§æ ‡é¢˜ä½œä¸ºæ–‡ç« åç§°
      }),
    ],
  },
});
```

## è‡ªåŠ¨å¯¼èˆªå’Œä¾§è¾¹æ ï¼ˆå·¥å…·ï¼‰

å‚è€ƒè‡ª[Notes](https://fang-kang.github.io/note/) çš„VitePress è‡ªåŠ¨ç”Ÿæˆå¯¼èˆªå’Œä¾§è¾¹æ 

ä¼˜ç‚¹ï¼šé…ç½®æ ¹ç›®å½•åèƒ½è‡ªåŠ¨ç”Ÿæˆå¯¼èˆªå’Œä¾§è¾¹æ 

å¼Šç«¯ï¼šæ— æ³•è‡ªå®šä¹‰å¯¼èˆªæ åç§°

```js
/* .vitepress/navSidebarUtil.ts */
import { resolve, join, sep } from 'path'
import { readdirSync, statSync } from 'fs'
import { DefaultTheme } from 'vitepress'

interface SidebarGenerateConfig {
  /**
   * éœ€è¦éå†çš„ç›®å½•. é»˜è®¤:articles
   */
  dirName?: string
  /**
   * å¿½ç•¥çš„æ–‡ä»¶å. é»˜è®¤: index.md
   */
  ignoreFileName?: string
  /**
   * å¿½ç•¥çš„æ–‡ä»¶å¤¹åç§°. é»˜è®¤: ['demo','asserts']
   */
  ignoreDirNames?: string[]
}

interface SideBarItem {
  text: string
  collapsible?: boolean
  collapsed?: boolean
  items?: SideBarItem[]
  link?: string
}

interface NavGenerateConfig {
  /**
   * éœ€è¦éå†çš„ç›®å½•. é»˜è®¤:articles
   */
  dirName?: string
  /**
   * æœ€å¤§éå†å±‚çº§. é»˜è®¤:1
   */
  maxLevel?: number
}

/**
 * åˆ¤æ–­æ˜¯å¦ä¸ºmarkdownæ–‡ä»¶
 * @param fileName æ–‡ä»¶å
 * @returns æœ‰è¿”å›å€¼åˆ™è¡¨ç¤ºæ˜¯markdownæ–‡ä»¶,å¦åˆ™ä¸æ˜¯
 */
function isMarkdownFile(fileName: string) {
  return !!fileName.match(/.+\.md$/)
}

// è·å–docsç›®å½•çš„å®Œæ•´åç§°(ä»æ ¹ç›®å½•ä¸€ç›´åˆ°docsç›®å½•)
const docsDirFullPath = join(__dirname, '../')
// è·å–docsç›®å½•çš„å®Œæ•´é•¿åº¦
const docsDirFullPathLen = docsDirFullPath.length

/**
 * è·å–dirOrFileFullNameä¸­ç¬¬ä¸€ä¸ª/docs/åçš„æ‰€æœ‰å†…å®¹
 *  å¦‚:
 * /a-root/docs/test åˆ™ è·å–åˆ° /test
 * /a-root-docs/docs/test åˆ™ è·å–åˆ° /test
 * /a-root-docs/docs/docs/test åˆ™ è·å–åˆ° /docs/test
 * @param dirOrFileFullName æ–‡ä»¶æˆ–è€…ç›®å½•å
 * @returns
 */
function getDocsDirNameAfterStr(dirOrFileFullName: string) {
  // ä½¿ç”¨docsDirFullPathLené‡‡ç”¨å­—ç¬¦ä¸²æˆªå–çš„æ–¹å¼ï¼Œé¿å…å¤šå±‚ç›®å½•éƒ½å«docsçš„é—®é¢˜
  return `${sep}${dirOrFileFullName.substring(docsDirFullPathLen)}`
}

export function getSidebarData(sidebarGenerateConfig: SidebarGenerateConfig = {}) {
  const {
    dirName = 'articles',
    ignoreFileName = 'index.md',
    ignoreDirNames = ['demo', 'asserts'],
  } = sidebarGenerateConfig

  // è·å–ç›®å½•çš„ç»å¯¹è·¯å¾„
  const dirFullPath = resolve(__dirname, `../${dirName}`)
  const allDirAndFileNameArr = readdirSync(dirFullPath)
  const obj = {}

  allDirAndFileNameArr.map(dirName => {
    let subDirFullName = join(dirFullPath, dirName)

    const property = getDocsDirNameAfterStr(subDirFullName).replace(/\\/g, '/') + '/'
    const arr = getSideBarItemTreeData(subDirFullName, 1, 3, ignoreFileName, ignoreDirNames)

    obj[property] = arr
  })

  return obj
}

function getSideBarItemTreeData(
  dirFullPath: string,
  level: number,
  maxLevel: number,
  ignoreFileName: string,
  ignoreDirNames: string[]
): SideBarItem[] {
  // è·å–æ‰€æœ‰æ–‡ä»¶åå’Œç›®å½•å
  const allDirAndFileNameArr = readdirSync(dirFullPath)
  const result: SideBarItem[] = []
  allDirAndFileNameArr.map((fileOrDirName: string, idx: number) => {
    const fileOrDirFullPath = join(dirFullPath, fileOrDirName)
    const stats = statSync(fileOrDirFullPath)
    if (stats.isDirectory()) {
      if (!ignoreDirNames.includes(fileOrDirName)) {
        const text = fileOrDirName.match(/^[0-9]{2}-.+/) ? fileOrDirName.substring(3) : fileOrDirName
        // å½“å‰ä¸ºæ–‡ä»¶å¤¹
        const dirData: SideBarItem = {
          text,
          collapsed: false,
        }
        if (level !== maxLevel) {
          dirData.items = getSideBarItemTreeData(fileOrDirFullPath, level + 1, maxLevel, ignoreFileName, ignoreDirNames)
        }
        if (dirData.items) {
          dirData.collapsible = true
        }
        result.push(dirData)
      }
    } else if (isMarkdownFile(fileOrDirName) && ignoreFileName !== fileOrDirName) {
      // å½“å‰ä¸ºæ–‡ä»¶
      const matchResult = fileOrDirName.match(/(.+)\.md/)
      let text = matchResult ? matchResult[1] : fileOrDirName
      text = text.match(/^[0-9]{2}-.+/) ? text.substring(3) : text

      const fileData: SideBarItem = {
        text,
        link: getDocsDirNameAfterStr(fileOrDirFullPath).replace('.md', '').replace(/\\/g, '/'),
      }

      result.push(fileData)
    }
  })

  return result
}

export function getNavData(navGenerateConfig: NavGenerateConfig = {}) {
  const { dirName = 'articles', maxLevel = 2 } = navGenerateConfig
  const dirFullPath = resolve(__dirname, `../${dirName}`)
  const result = getNavDataArr(dirFullPath, 1, maxLevel)

  return result
}

/**
 * è·å–é¡¶éƒ¨å¯¼èˆªæ•°æ®
 *
 * @param   {string}     dirFullPath  å½“å‰éœ€è¦éå†çš„ç›®å½•ç»å¯¹è·¯å¾„
 * @param   {number}     level        å½“å‰å±‚çº§
 * @param   {number[]}   maxLevel     å…è®¸éå†çš„æœ€å¤§å±‚çº§
 * @return  {NavItem[]}               å¯¼èˆªæ•°æ®æ•°ç»„
 */
function getNavDataArr(dirFullPath: string, level: number, maxLevel: number): DefaultTheme.NavItem[] {
  // è·å–æ‰€æœ‰æ–‡ä»¶åå’Œç›®å½•å
  const allDirAndFileNameArr = readdirSync(dirFullPath)
  const result: DefaultTheme.NavItem[] = []

  allDirAndFileNameArr.map((fileOrDirName: string, idx: number) => {
    const fileOrDirFullPath = join(dirFullPath, fileOrDirName)
    const stats = statSync(fileOrDirFullPath)
    const link = getDocsDirNameAfterStr(fileOrDirFullPath).replace('.md', '').replace(/\\/g, '/')

    const text = fileOrDirName.match(/^[0-9]{2}-.+/) ? fileOrDirName.substring(3) : fileOrDirName

    if (stats.isDirectory()) {
      // å½“å‰ä¸ºæ–‡ä»¶å¤¹
      const dirData: any = {
        text,
        link: `${link}/`,
      }

      if (level !== maxLevel) {
        const arr = getNavDataArr(fileOrDirFullPath, level + 1, maxLevel).filter(v => v.text !== 'index.md')
        if (arr.length > 0) {
          // @ts-ignore
          dirData.items = arr
          delete dirData.link
        }
      }

      dirData.activeMatch = link + '/'
      result.push(dirData)
    } else if (isMarkdownFile(fileOrDirName)) {
      // å½“å‰ä¸ºæ–‡ä»¶
      const fileData: DefaultTheme.NavItem = {
        text,
        link,
      }
      fileData.activeMatch = link + '/'
      result.push(fileData)
    }
  })

  return result
}
```

å¼•å…¥åˆ°é…ç½®ä¸­

```js
/* .vitepress/config.ts */
import { defineConfig } from 'vitepress'
import { getSidebarData, getNavData } from './navSidebarUtil'

export default defineConfig({
  // ...
  themeConfig: {
    nav: getNavData(),
    sidebar: getSidebarData(),
  },
})
```

å…¶ä»–ä¾§è¾¹æ å·¥å…·

https://blog.csdn.net/weixin\_46463785/article/details/128592038

https://docs.zhengxinonly.com ï¼ˆVitePress ç³»åˆ—æ•™ç¨‹ï¼šè‡ªåŠ¨ç”Ÿæˆä¾§è¾¹æ  #7ï¼‰

https://juejin.cn/post/7227358177489961018

## ä»£ç ç»„å›¾æ ‡

ä½¿ç”¨çš„æ˜¯ [@yuyinws/vitepress-plugin-group-icons](https://github.com/yuyinws/vitepress-plugin-group-icons)

å‚ç…§æ•™ç¨‹å®‰è£…ï¼šhttps://vpgi.vercel.app/

```sh
npm install vitepress-plugin-group-icons
```

ç„¶ååœ¨ `config.mts` ä¸­é…ç½®

::: tip `groupIconMdPlugin` æŠ¥é”™ï¼Ÿ

è¯·å¤‡ä»½é…ç½®åŠæ–‡ä»¶åï¼Œé‡æ–°å®‰è£…VitePress

:::

```js
// .vitepress/config.mts
import { defineConfig } from 'vitepress'
import { groupIconMdPlugin, groupIconVitePlugin } from 'vitepress-plugin-group-icons'   // [!code focus:1]

export default defineConfig({

  markdown: {
    config(md) {   // [!code focus:3]
      md.use(groupIconMdPlugin) // ä»£ç ç»„å›¾æ ‡
    },
  },

  vite: {   // [!code focus:5]
    plugins: [
      groupIconVitePlugin() // ä»£ç ç»„å›¾æ ‡
    ],
  },

})
```

æœ€åè¿˜éœ€è¦å† `index.ts` ä¸­å¼•å…¥æ ·å¼

```js
// .vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme'

import 'virtual:group-icons.css' // ä»£ç ç»„æ ·å¼  // [!code focus:1]

export default {
  extends: DefaultTheme,
}
```

ä½¿ç”¨æ—¶ï¼Œè¯·ç¡®ä¿ä»£ç åæœ‰å¯¹åº”çš„æ–‡å­—è§¦å‘

````markdown{2,6,10}
::: code-group
```sh [pnpm]
pnpm -v
```

```sh [yarn]
yarn -v
```

```sh [bun]
bun -v
```
:::
````

å·²ç»å†…ç½®çš„å¸¸ç”¨å›¾æ ‡æœ‰

```js
export const builtInIcons: Record<string, string> = {
  // package manager
  pnpm: 'logos:pnpm',
  npm: 'logos:npm-icon',
  yarn: 'logos:yarn',
  bun: 'logos:bun',
  // framework
  vue: 'logos:vue',
  svelte: 'logos:svelte-icon',
  angular: 'logos:angular-icon',
  react: 'logos:react',
  next: 'logos:nextjs-icon',
  nuxt: 'logos:nuxt-icon',
  solid: 'logos:solidjs-icon',
  // bundler
  rollup: 'logos:rollupjs',
  webpack: 'logos:webpack',
  vite: 'logos:vitejs',
  esbuild: 'logos:esbuild',
}
```

é‚£ä¹ˆå¦‚ä½•è‡ªå®šä¹‰å‘¢ï¼Œæˆ‘ä»¬å…ˆåœ¨ [iconify](https://icon-sets.iconify.design/) ä¸­æ‰¾åˆ°ä¸­æ„çš„å›¾æ ‡

::: tip è¯´æ˜

* æœ¬åœ°å›¾æ ‡æ ¼å¼ï¼šåªèƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„
* è¿œç¨‹å›¾æ ‡æ ¼å¼ï¼šå¿…é¡»æ˜¯ `logos:***`

:::

å›¾æ ‡åå¤åˆ¶åï¼Œå¯ä»¥åœ¨ `config.mts` ä¸­é…ç½®

```js
// .vitepress/config.mts
import { defineConfig } from 'vitepress'
import { groupIconMdPlugin, groupIconVitePlugin, localIconLoader } from 'vitepress-plugin-group-icons' // [!code focus:1]

export default defineConfig({

  markdown: {
    config(md) {
      md.use(groupIconMdPlugin) //ä»£ç ç»„å›¾æ ‡
    },
  },

  vite: {
    plugins: [
      groupIconVitePlugin({  // [!code focus:8]
        customIcon: {
          ts: localIconLoader(import.meta.url, '../public/svg/typescript.svg'), //æœ¬åœ°tså›¾æ ‡å¯¼å…¥
          js: 'logos:javascript', //jså›¾æ ‡
          md: 'logos:markdown', //markdownå›¾æ ‡
          css: 'logos:css-3', //csså›¾æ ‡
        },
      })
    ],
  },

})
```

## ç¦ç”¨F12

ä½¿ç”¨çš„æ˜¯ [@cellinlab/vitepress-protect-plugin](https://github.com/cellinlab/vitepress-protect-plugin/)

```
npm install vitepress-protect-plugin
```

ç„¶ååœ¨ `config.mts` ä¸­é…ç½®ï¼Œä¸ç”¨çš„åŠŸèƒ½ä¸é…ç½®å³å¯

```js
import { defineConfig } from "vitepress"
import vitepressProtectPlugin from "vitepress-protect-plugin" // [!code focus:1]

export default defineConfig({
  // other VitePress configs...
  vite: {
    plugins: [
      vitepressProtectPlugin({ // [!code focus:5]
        disableF12: true, // ç¦ç”¨F12å¼€å‘è€…æ¨¡å¼
        disableCopy: true, // ç¦ç”¨æ–‡æœ¬å¤åˆ¶
        disableSelect: true, // ç¦ç”¨æ–‡æœ¬é€‰æ‹©
      }),
    ],
  },
})
```

## åˆ‡æ¢è·¯ç”±è¿›åº¦æ¡

å½“ä½ åˆ‡æ¢é¡µé¢ï¼Œé¡¶éƒ¨ä¼šæ˜¾ç¤ºè¿›åº¦æ¡ï¼Œä½¿ç”¨çš„æ˜¯ [@Skyleen77/nprogress-v2](https://github.com/Skyleen77/nprogress-v2)

::: tip è¯´æ˜

æœ¬æ–¹å¼ç”± [Aurorxa](https://github.com/Aurorxa) æä¾›æ¨é€ [#36](https://github.com/Yiov/vitepress-doc/pull/36)

:::

å…ˆå®‰è£… `nprogress-v2`

```sh
npm install nprogress-v2
```

ç„¶åå† `index.ts` ä¸­é…ç½®ï¼Œå³å¯ç”Ÿæ•ˆ

```js
// .vitepress/theme/index.ts

import { NProgress } from 'nprogress-v2/dist/index.js' // è¿›åº¦æ¡ç»„ä»¶ // [!code focus:2]
import 'nprogress-v2/dist/index.css' // è¿›åº¦æ¡æ ·å¼

if (inBrowser) {
      NProgress.configure({ showSpinner: false }) // [!code focus:4]
      router.onBeforeRouteChange = () => {
        NProgress.start() // å¼€å§‹è¿›åº¦æ¡
      }
      router.onAfterRouteChanged = () => {
         busuanzi.fetch()
         NProgress.done() // åœæ­¢è¿›åº¦æ¡ // [!code focus:1]
      }
}
```

## è¯„è®º

å„ç§è¯„è®ºç³»ç»Ÿå¯¹æ¯”

|                    è¯„è®ºç³»ç»Ÿ                     |                             è¯´æ˜                             |
| :---------------------------------------------: | :----------------------------------------------------------: |
| [Valine](https://valine.js.org/quickstart.html) | ä¸ç”¨ç™»å½•è´¦å·å³å¯è¯„è®ºï¼Œä½†å®¹æ˜“äº§ç”Ÿåƒåœ¾è¯„è®ºï¼Œå…¶æ¬¡æ²¡æœ‰è¯„è®ºæé†’é€šçŸ¥ |
|        [Waline](https://waline.js.org/)         | æ˜¯Valineçš„å‡çº§ç‰ˆï¼Œç™»å½•åæ–¹å¯è¯„è®ºï¼Œæœ‰é€šçŸ¥ï¼Œä½†æ˜¯éœ€è¦è‡ªå·±éƒ¨ç½²æœåŠ¡ç«¯ |
|        [Twikoo](https://twikoo.js.org/)         | ä¸ç”¨ç™»å½•è´¦å·å³å¯è¯„è®ºï¼Œä½†å®¹æ˜“äº§ç”Ÿåƒåœ¾è¯„è®ºï¼Œæœ‰é€šçŸ¥ï¼Œä½†æ˜¯éœ€è¦è‡ªå·±éƒ¨ç½²æœåŠ¡ç«¯ |
|        [Artalk](https://artalk.js.org/)         | å¯è®¾ç½®æ˜¯å¦å¯ç”¨ç™»å½•è´¦å·åè¯„è®ºï¼Œæœ‰é€šçŸ¥ï¼Œä½†æ˜¯éœ€è¦è‡ªå·±éƒ¨ç½²æœåŠ¡ç«¯ |
|        [utteranc](https://utteranc.es/)         | GitHubç™»å½•åæ–¹å¯è¯„è®ºï¼Œè¯„è®ºæ•°æ®åœ¨ GitHub issues ä¸­ï¼Œè¯„è®ºåæœ‰é‚®ä»¶é€šçŸ¥ï¼Œæ— éœ€éƒ¨ç½²æœåŠ¡ç«¯ï¼Œä½†UIæ ·å¼ä¸€èˆ¬ï¼Œä¸”ç§»åŠ¨ç«¯ä¸æ˜¾ç¤ºå¤´åƒ |
|       [gitalk](https://gitalk.github.io/)       | GitHubç™»å½•åæ–¹å¯è¯„è®ºï¼Œè¯„è®ºæ•°æ®åœ¨ GitHub issues ä¸­ï¼Œè¯„è®ºåæœ‰é‚®ä»¶é€šçŸ¥ï¼Œæ— éœ€éƒ¨ç½²æœåŠ¡ç«¯ï¼ŒUIæ ·å¼ä¸€èˆ¬ï¼Œè¯„è®ºä¸æ”¯æŒç‚¹èµ |
|       â­[Giscus](https://giscus.app/zh-CN)       | GitHubç™»å½•åæ–¹å¯è¯„è®ºï¼Œè¯„è®ºæ•°æ®åœ¨ GitHub Discussions ä¸­ï¼Œè¯„è®ºåæœ‰é‚®ä»¶é€šçŸ¥ï¼Œæ— éœ€éƒ¨ç½²æœåŠ¡ç«¯ï¼ŒUIçˆ±äº† |

ä¹‹å‰åœ¨ vuepress ä¸­ç”¨è¿‡ Valineï¼Œæ•ˆæœå¹¶ä¸æ˜¯ç‰¹åˆ«å¥½

ä»ä¸Šé¢å¯¹æ¯”æ¥çœ‹ï¼Œ[Giscus](https://giscus.app/zh-CN) æœ€ä½³ï¼Œå› æ­¤å†³å®šä½¿ç”¨ [Giscus](https://giscus.app/zh-CN)

::: details å…³äº [@xinlei3166](https://github.com/xinlei3166/) çš„ waline æ’ä»¶

åœ¨ä½¿ç”¨çœ‹æ¿å¨˜å‘æ—¶å€™å°±å·²ç»è£…å¥½äº†ï¼Œç›´æ¥å¼•ç”¨å°±è¡Œäº†

```js
// .vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme'

import { useWaline } from 'vitepress-theme-website' // [!code focus:1]

export default {
  extends: DefaultTheme,

  setup() {

    useWaline({ // [!code focus:3]
      serverURL: 'https://you_url.com'
    }),

  }
}
```

è®°å¾— `serverURL` æ¢æˆè‡ªå·±çš„å³å¯ï¼Œä½†æ˜¯ä½œè€…çš„æ’ä»¶æœ‰ä¸ªbugï¼Œæš—é»‘æ¨¡å¼ä¸‹çœ‹ä¸æ¸…å­—

æ‰€ä»¥è¦ç”¨ [waline](https://waline.js.org/) è¯å°± [å‚è€ƒå®˜æ–¹çš„æ•™ç¨‹](https://waline.js.org/guide/get-started/)

:::

### å®‰è£…giscus

Giscus æ˜¯ä¸€ä¸ªåŸºäº GitHub Discussion çš„è¯„è®ºç³»ç»Ÿï¼Œå¯ç”¨ç®€ä¾¿

è¿› Giscus Appå®˜ç½‘ï¼šhttps://github.com/apps/giscus

ç‚¹å‡» `Install` å®‰è£…

é€‰æ‹© `Only select repositories`ï¼Œå†æŒ‡å®šä¸€ä¸ªä½ æƒ³å¼€å¯è®¨è®ºçš„ä»“åº“

::: tip æ³¨æ„

ä»“åº“å¿…é¡»æ˜¯å…¬å¼€çš„ï¼Œç§æœ‰çš„ä¸è¡Œ

æƒ³å•ç‹¬æ”¾è¯„è®ºï¼Œæ–°å»ºä¸€ä¸ªä¹Ÿå¯

:::

å®‰è£…å®Œæˆåå¯ä»¥åœ¨ä¸ªäººå¤´åƒ-è®¾ç½®-åº”ç”¨ `Applications` ä¸­çœ‹åˆ°

### å¼€å¯è®¨è®º

å› ä¸ºgiscusä¼šæŠŠè¯„è®ºæ•°æ®éƒ½æ”¾åˆ°è®¨è®º `discussions` ä¸­

æˆ‘ä»¬è¿›å…¥è¦å¼€å¯è®¨è®ºçš„ä»“åº“ï¼Œç‚¹è®¾ç½® - å‹¾é€‰è®¨è®º `Settings - discussions`

### ç”Ÿæˆæ•°æ®

è¿›å…¥å®˜ç½‘ï¼šhttps://giscus.app/zh-CN

è¾“å…¥è‡ªå·±çš„ä»“åº“é“¾æ¥ï¼Œæ»¡è¶³æ¡ä»¶ä¼šæç¤ºå¯ç”¨

ä¸‹æ‹‰åˆ° Discussion åˆ†ç±»æ¨èé€‰ `General` ï¼Œæ‡’åŠ è½½è¯„è®ºä¹Ÿå¯ä»¥å‹¾é€‰ä¸‹

å…³äºè®¨è®ºçš„ç±»å‹åˆ†ç±»å¦‚ä¸‹ï¼Œæ¥è‡ªäº [Githubçš„è®¨è®ºæ–‡æ¡£](https://docs.github.com/zh/discussions/managing-discussions-for-your-community/managing-categories-for-discussions#about-categories-for-discussions)

|     ç±»åˆ«      |    ä¸­æ–‡    |          è¯´æ˜          |
| :-----------: | :--------: | :--------------------: |
| Announcements |    å…¬å‘Š    | æ¯æ¬¡è¯„è®ºéƒ½ä¼šæ¨é€æ‰€æœ‰äºº |
|    General    |    å¸¸è§„    |       å¼€æ”¾å¼è®¨è®º       |
|     Ideas     |    æƒ³æ³•    |       å¼€æ”¾å¼è®¨è®º       |
|     Polls     |    æŠ•ç¥¨    |      å¯æŠ•ç¥¨ä¸è®¨è®º      |
|      Q\&A      |    é—®ç­”    |        é—®ç­”å½¢å¼        |
| Show and tell | å±•ç¤ºå’Œè¯´æ˜ |       å¼€æ”¾å¼è®¨è®º       |

ä¸‹æ–¹å°±è‡ªåŠ¨ç”Ÿæˆäº†ä½ çš„å…³é”®æ•°æ®

```js
<script src="https://giscus.app/client.js"
        data-repo="github repository" // [!code focus:4]
        data-repo-id="R_******"
        data-category="General"
        data-category-id="DIC_******"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
```

å…¶ä¸­ `data-repo` ã€ `data-repo-id` ã€ `data-category` å’Œ `data-category-id` è¿™4ä¸ªæ˜¯æˆ‘ä»¬çš„å…³é”®æ•°æ®

### å®‰è£…ä½¿ç”¨

æœ‰èƒ½åŠ›çš„å¯ä»¥ç”¨å®˜æ–¹ç»™çš„jsæ•°æ®å°è£…

æˆ‘è¿™é‡Œç”¨ [@T-miracle/vitepress-plugin-comment-with-giscus](https://github.com/T-miracle/vitepress-plugin-comment-with-giscus) çš„æ’ä»¶

```sh
npm install vitepress-plugin-comment-with-giscus
```

åœ¨ `.vitepress/theme/index.ts` ä¸­å¡«å…¥ä¸‹é¢ä»£ç 

å¹¶å°†æˆ‘ä»¬ä¹‹å‰è·å–çš„4ä¸ªå…³é”®æ•°æ®å¡«å…¥ï¼Œå…¶ä»–ä¿æŒé»˜è®¤ä¿å­˜

```js
// .vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme';
import giscusTalk from 'vitepress-plugin-comment-with-giscus'; // [!code focus:2]
import { useData, useRoute } from 'vitepress';

export default {
  extends: DefaultTheme,

  setup() {
    // Get frontmatter and route // [!code focus:22]
    const { frontmatter } = useData();
    const route = useRoute();
        
    // giscusé…ç½®
    giscusTalk({
      repo: 'your github repository', //ä»“åº“
      repoId: 'your repository id', //ä»“åº“ID
      category: 'Announcements', // è®¨è®ºåˆ†ç±»
      categoryId: 'your category id', //è®¨è®ºåˆ†ç±»ID
      mapping: 'pathname',
      inputPosition: 'bottom',
      lang: 'zh-CN',
      }, 
      {
        frontmatter, route
      },
      //é»˜è®¤å€¼ä¸ºtrueï¼Œè¡¨ç¤ºå·²å¯ç”¨ï¼Œæ­¤å‚æ•°å¯ä»¥å¿½ç•¥ï¼›
      //å¦‚æœä¸ºfalseï¼Œåˆ™è¡¨ç¤ºæœªå¯ç”¨
      //æ‚¨å¯ä»¥ä½¿ç”¨â€œcomment:trueâ€åºè¨€åœ¨é¡µé¢ä¸Šå•ç‹¬å¯ç”¨å®ƒ
      true
    );

}
```

å®‰è£…å®Œçœ‹ä¸‹åº•éƒ¨çš„æ•ˆæœå§

å¦‚æœæŸä¸€é¡µä¸æƒ³å¯ç”¨ï¼Œå¯ä»¥åœ¨å½“å‰é¡µä½¿ç”¨ `Frontmatter` å…³é—­

```markdown
---
comment: false
---
```
