import{_ as i,c as a,o as n,ah as e,nn as l}from"./chunks/framework.D5cOWG0Y.js";const o=JSON.parse('{"title":"Cockpit服务器管理工具","description":"","frontmatter":{"title":"Cockpit服务器管理工具","tags":["Linux"],"categories":["Linux"]},"headers":[],"relativePath":"Linux/OpenEuler/3_Cockpit服务器管理工具.md","filePath":"Linux/OpenEuler/3_Cockpit服务器管理工具.md","lastUpdated":1756054686000}'),p={name:"Linux/OpenEuler/3_Cockpit服务器管理工具.md"};function t(h,s,k,r,d,c){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="一、简介" tabindex="-1">一、简介 <a class="header-anchor" href="#一、简介" aria-label="Permalink to “一、简介”">​</a></h2><p>一登录 centos8, 就提示信息</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Authorized users only. All activities may be monitored and reported.</span></span>
<span class="line"><span>Activate the web console with: systemctl enable --now cockpit.socket</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这个是什么意思呢? 其实这个就是想让你开启cockpit服务。这条命令就是要把cockpit设置为开机自启动并且立刻运行起来，Cockpit 是红帽开发的网页版图像化服务管理工具，官方是说“Cockpit 是一个交互式 Linux 服务器管理接口”，说白了就是给你提供个web页面来管理cneots8服务器，听说这个服务还是非常好用的，后面会更新看下这个服务的具体使用。</p><p>参考资料：<a href="https://zhuanlan.zhihu.com/p/113270502" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/113270502</a></p><p>界面如下：</p><p><img src="`+l+`" alt="image-20250615211823067" loading="lazy"></p><h2 id="二、cockpit更换端口" tabindex="-1">二、Cockpit更换端口 <a class="header-anchor" href="#二、cockpit更换端口" aria-label="Permalink to “二、Cockpit更换端口”">​</a></h2><p>修改 Cockpit 端口</p><p><strong>编辑配置文件</strong>： 打开 Cockpit 的配置文件 <em>cockpit.socket</em>。</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/sockets.target.wants/cockpit.socket</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>修改端口</strong>： 找到 <em>[Socket]</em> 部分，并将 <em>ListenStream</em> 的值修改为所需的端口号，例如 9091。</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Socket] ListenStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">9091</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>完整配置如下</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Cockpit</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Web</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Socket</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Documentation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">man:cockpit-ws</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Wants</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">cockpit-motd.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Socket]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ListenStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">9091</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecStartPost</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">-/usr/share/cockpit/motd/update-motd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> localhost</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecStartPost</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">-/bin/ln</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> -snf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> active.motd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /run/cockpit/motd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecStopPost</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">-/bin/ln</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> -snf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inactive.motd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /run/cockpit/motd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WantedBy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sockets.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>重新加载 systemd 配置</strong>： 保存并关闭文件后，重新加载 systemd 配置以应用更改。</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>重启 Cockpit 服务</strong>： 最后，重启 Cockpit 服务以使更改生效。</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cockpit.socket</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>注意事项</p><p><strong>防火墙配置</strong>：确保新的端口在防火墙中已开放，以便外部访问。</p><p><strong>SELinux 配置</strong>：如果启用了 SELinux，可能需要更新 SELinux 策略以允许新的端口。</p><h2 id="三、更换端口不生效" tabindex="-1">三、更换端口不生效 <a class="header-anchor" href="#三、更换端口不生效" aria-label="Permalink to “三、更换端口不生效”">​</a></h2><p>修改完端口后启动报错</p><p>查看日志</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cockpit.socket</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --since</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;5 minutes ago&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>内容如下</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">6月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:11:27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.0.105</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cockpit.socket:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Failed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> listening</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> socket</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ([::]:9091): Permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">6月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:11:27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.0.105</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cockpit.socket:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Failed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> listen</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sockets:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Permission</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> denied</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">6月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:11:27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.0.105</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Cockpit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Web</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Socket...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">6月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:11:27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.0.105</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cockpit.socket:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Failed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> result</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;resources&#39;.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">6月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 17:11:27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.0.105</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Failed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> listen</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Cockpit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Web</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Socket.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>关键信息如下：</p><ul><li><strong><code>Permission denied</code></strong>：表示 systemd 无法绑定到你指定的端口（如 <code>9091</code>）。</li><li><strong>通常是 SELinux、firewalld 或系统权限限制</strong> 导致。</li></ul><h3 id="🔒-原因一-selinux-阻止了绑定低编号端口-1024" tabindex="-1">🔒 原因一：SELinux 阻止了绑定低编号端口（&lt;1024） <a class="header-anchor" href="#🔒-原因一-selinux-阻止了绑定低编号端口-1024" aria-label="Permalink to “🔒 原因一：SELinux 阻止了绑定低编号端口（&lt;1024）”">​</a></h3><p>虽然你使用的是 <code>9091</code>（&gt;1024），但有时 SELinux 仍然会阻止非标准服务监听某些端口。</p><h4 id="🧪-检查-selinux-状态" tabindex="-1">🧪 检查 SELinux 状态： <a class="header-anchor" href="#🧪-检查-selinux-状态" aria-label="Permalink to “🧪 检查 SELinux 状态：”">​</a></h4><p>bash深色版本</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>sestatus</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如果输出是 <code>enabled</code>，说明 SELinux 是开启的。</p><h4 id="🛠-解决方法" tabindex="-1">🛠 解决方法： <a class="header-anchor" href="#🛠-解决方法" aria-label="Permalink to “🛠 解决方法：”">​</a></h4><p>你可以临时禁用 SELinux 测试是否与此有关：</p><p>bash深色版本</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>setenforce 0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>然后尝试重启服务：</p><p>bash深色版本</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>systemctl daemon-reload</span></span>
<span class="line"><span>systemctl restart cockpit.socket</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>✅ 如果成功了，说明确实是 SELinux 的问题。</p><h4 id="永久解决-推荐" tabindex="-1">永久解决（推荐）： <a class="header-anchor" href="#永久解决-推荐" aria-label="Permalink to “永久解决（推荐）：”">​</a></h4><p>创建一个 SELinux 策略允许 <code>cockpit</code> 监听新端口，比如 <code>9091</code>：</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># 安装 semanage 工具（如果没有）</span></span>
<span class="line"><span>dnf install -y policycoreutils-python-utils</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 添加端口到允许列表</span></span>
<span class="line"><span>semanage port -a -t http_port_t -p tcp 9091</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 再次尝试启动</span></span>
<span class="line"><span>systemctl restart cockpit.socket</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="🧱-原因二-防火墙或-apparmor-少见" tabindex="-1">🧱 原因二：防火墙或 AppArmor（少见） <a class="header-anchor" href="#🧱-原因二-防火墙或-apparmor-少见" aria-label="Permalink to “🧱 原因二：防火墙或 AppArmor（少见）”">​</a></h3><p>如果你修改了端口，但没有开放对应防火墙规则，也可能导致失败。</p><p>不过这个错误是 <code>Permission denied</code>，更可能是 SELinux 或内核权限问题。</p><h3 id="🗃️-原因三-系统限制-capabilities" tabindex="-1">🗃️ 原因三：系统限制（Capabilities） <a class="header-anchor" href="#🗃️-原因三-系统限制-capabilities" aria-label="Permalink to “🗃️ 原因三：系统限制（Capabilities）”">​</a></h3><p>Cockpit 使用 systemd socket 激活方式运行，默认不需要 root 权限，但如果绑定某些特殊端口或功能受限，也可能会失败。</p><p>检查 <code>/usr/lib/systemd/system/cockpit.socket</code> 中的 <code>[Socket]</code> 配置是否异常。</p><p>修复完整流程</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看 SELinux 状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sestatus</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 semanage（如未安装）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> policycoreutils-python-utils</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 允许 9091 端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">semanage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http_port_t</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9091</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改 cockpit.socket 文件中的 ListenStream=9091</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/lib/systemd/system/cockpit.socket</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重新加载并启动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cockpit.socket</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cockpit.socket</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 开放防火墙</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=9091/tcp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div>`,55)])])}const g=i(p,[["render",t]]);export{o as __pageData,g as default};
