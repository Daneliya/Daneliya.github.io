import{_ as s,c as i,o as a,ah as l}from"./chunks/framework.D5cOWG0Y.js";const E=JSON.parse('{"title":"Python数据分析—整理数据","description":"","frontmatter":{"title":"Python数据分析—整理数据","tags":["Python"],"categories":["Python"]},"headers":[],"relativePath":"Python/数据分析/11_Python数据分析—整理数据.md","filePath":"Python/数据分析/11_Python数据分析—整理数据.md","lastUpdated":1755802517000}'),n={name:"Python/数据分析/11_Python数据分析—整理数据.md"};function e(h,t,d,k,p,r){return a(),i("div",null,[...t[0]||(t[0]=[l(`<p>在数据清洗干净后，很多时候，我们可以直接开始可视化或分析了，但也有些时候，我们还需要一些额外步骤。</p><p>比如：当我们从多个数据源获取相关数据，或者数据集本身包括了多个表格，那就可能涉及一些数据连接或合并等操作。</p><h2 id="一、对dataframe进行拼接" tabindex="-1">一、对DataFrame进行拼接 <a class="header-anchor" href="#一、对dataframe进行拼接" aria-label="Permalink to “一、对DataFrame进行拼接”">​</a></h2><p>其中，最简单的操作，就是把两个DataFrame，纵向或横向连接到一起。</p><h3 id="一-、对dataframe进行纵向拼接" tabindex="-1">(一)、对DataFrame进行纵向拼接 <a class="header-anchor" href="#一-、对dataframe进行纵向拼接" aria-label="Permalink to “(一)、对DataFrame进行纵向拼接”">​</a></h3><ol><li>可以用Pandas的concat函数，给concat函数传入一个列表，列表里面放上想要拼接的DataFrame，会返回一个前面两个DataFrame纵相拼接后的新DataFrame</li><li>索引</li></ol><p><strong>concat函数，默认保留DataFrame索引，包括位置索引。</strong></p><p><strong>但位置索引没有啥意义，且拼接后索引会乱掉</strong></p><p><strong>可以指定可选参数ignore_index=True，这样拼接时就会对原本DataFrame索引进行忽略，返回的新结果里，索引就是从0开始排序的位置索引</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;商品名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iPhone 12&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MacBook Air&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iPad&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Apple Watch Series 6&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;单价（元）&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6799</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8499</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3199</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2699</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;颜色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;蓝色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;金色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;灰色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;粉色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;库存数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;商品名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;AirPods Pro&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;HomePod mini&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Apple TV 4K&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Beats Flex&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;单价（元）&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1599</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">749</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1499</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">399</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;颜色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;白色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;空间灰色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;黑色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;黄色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;库存数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">iPhone 12</td><td style="text-align:left;">6799</td><td style="text-align:left;">蓝色</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">MacBook Air</td><td style="text-align:left;">8499</td><td style="text-align:left;">金色</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">iPad</td><td style="text-align:left;">3199</td><td style="text-align:left;">灰色</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Apple Watch Series 6</td><td style="text-align:left;">2699</td><td style="text-align:left;">粉色</td><td style="text-align:left;">80</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">AirPods Pro</td><td style="text-align:left;">1599</td><td style="text-align:left;">白色</td><td style="text-align:left;">120</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">HomePod mini</td><td style="text-align:left;">749</td><td style="text-align:left;">空间灰色</td><td style="text-align:left;">80</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Apple TV 4K</td><td style="text-align:left;">1499</td><td style="text-align:left;">黑色</td><td style="text-align:left;">60</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Beats Flex</td><td style="text-align:left;">399</td><td style="text-align:left;">黄色</td><td style="text-align:left;">200</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.concat([df1, df2])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">iPhone 12</td><td style="text-align:left;">6799</td><td style="text-align:left;">蓝色</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">MacBook Air</td><td style="text-align:left;">8499</td><td style="text-align:left;">金色</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">iPad</td><td style="text-align:left;">3199</td><td style="text-align:left;">灰色</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Apple Watch Series 6</td><td style="text-align:left;">2699</td><td style="text-align:left;">粉色</td><td style="text-align:left;">80</td></tr><tr><td><strong>0</strong></td><td style="text-align:left;">AirPods Pro</td><td style="text-align:left;">1599</td><td style="text-align:left;">白色</td><td style="text-align:left;">120</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">HomePod mini</td><td style="text-align:left;">749</td><td style="text-align:left;">空间灰色</td><td style="text-align:left;">80</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Apple TV 4K</td><td style="text-align:left;">1499</td><td style="text-align:left;">黑色</td><td style="text-align:left;">60</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Beats Flex</td><td style="text-align:left;">399</td><td style="text-align:left;">黄色</td><td style="text-align:left;">200</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.concat([df1, df2], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ignore_index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">iPhone 12</td><td style="text-align:left;">6799</td><td style="text-align:left;">蓝色</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">MacBook Air</td><td style="text-align:left;">8499</td><td style="text-align:left;">金色</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">iPad</td><td style="text-align:left;">3199</td><td style="text-align:left;">灰色</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Apple Watch Series 6</td><td style="text-align:left;">2699</td><td style="text-align:left;">粉色</td><td style="text-align:left;">80</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">AirPods Pro</td><td style="text-align:left;">1599</td><td style="text-align:left;">白色</td><td style="text-align:left;">120</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">HomePod mini</td><td style="text-align:left;">749</td><td style="text-align:left;">空间灰色</td><td style="text-align:left;">80</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">Apple TV 4K</td><td style="text-align:left;">1499</td><td style="text-align:left;">黑色</td><td style="text-align:left;">60</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">Beats Flex</td><td style="text-align:left;">399</td><td style="text-align:left;">黄色</td><td style="text-align:left;">200</td></tr></tbody></table><ol><li>列名</li></ol><p><strong>当参与拼接的两个DataFrame，存在列名不同时，并不会产生报错，此时DataFrame的所有列都会被进行保留，匹配不上的地方，就会自动用NaN值进行填充</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;商品名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iPhone 12&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MacBook Air&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iPad&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Apple Watch Series 6&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;单价（元）&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6799</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8499</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3199</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2699</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;颜色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;蓝色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;金色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;灰色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;粉色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;库存数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;商品名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;AirPods Pro&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;HomePod mini&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Apple TV 4K&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Beats Flex&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;单价&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1599</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">749</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1499</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">399</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;颜色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;白色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;空间灰色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;黑色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;黄色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;库存数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">iPhone 12</td><td style="text-align:left;">6799</td><td style="text-align:left;">蓝色</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">MacBook Air</td><td style="text-align:left;">8499</td><td style="text-align:left;">金色</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">iPad</td><td style="text-align:left;">3199</td><td style="text-align:left;">灰色</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Apple Watch Series 6</td><td style="text-align:left;">2699</td><td style="text-align:left;">粉色</td><td style="text-align:left;">80</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">AirPods Pro</td><td style="text-align:left;">1599</td><td style="text-align:left;">白色</td><td style="text-align:left;">120</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">HomePod mini</td><td style="text-align:left;">749</td><td style="text-align:left;">空间灰色</td><td style="text-align:left;">80</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Apple TV 4K</td><td style="text-align:left;">1499</td><td style="text-align:left;">黑色</td><td style="text-align:left;">60</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Beats Flex</td><td style="text-align:left;">399</td><td style="text-align:left;">黄色</td><td style="text-align:left;">200</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.concat([df3, df4], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ignore_index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th><th style="text-align:left;"><strong>单价</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">iPhone 12</td><td style="text-align:left;">6799.0</td><td style="text-align:left;">蓝色</td><td style="text-align:left;">100</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">MacBook Air</td><td style="text-align:left;">8499.0</td><td style="text-align:left;">金色</td><td style="text-align:left;">50</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">iPad</td><td style="text-align:left;">3199.0</td><td style="text-align:left;">灰色</td><td style="text-align:left;">150</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Apple Watch Series 6</td><td style="text-align:left;">2699.0</td><td style="text-align:left;">粉色</td><td style="text-align:left;">80</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">AirPods Pro</td><td style="text-align:left;">NaN</td><td style="text-align:left;">白色</td><td style="text-align:left;">120</td><td style="text-align:left;">1599.0</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">HomePod mini</td><td style="text-align:left;">NaN</td><td style="text-align:left;">空间灰色</td><td style="text-align:left;">80</td><td style="text-align:left;">749.0</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">Apple TV 4K</td><td style="text-align:left;">NaN</td><td style="text-align:left;">黑色</td><td style="text-align:left;">60</td><td style="text-align:left;">1499.0</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">Beats Flex</td><td style="text-align:left;">NaN</td><td style="text-align:left;">黄色</td><td style="text-align:left;">200</td><td style="text-align:left;">399.0</td></tr></tbody></table><h3 id="二-、对dataframe进行横向拼接" tabindex="-1">(二)、对DataFrame进行横向拼接 <a class="header-anchor" href="#二-、对dataframe进行横向拼接" aria-label="Permalink to “(二)、对DataFrame进行横向拼接”">​</a></h3><p>仍然可以用concat函数，额外传入可选参数axis=1。因为此时是沿着列名横向操作，因此拼接的时候就是横向进行拼接。</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;商品名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iPhone 12&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MacBook Air&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;iPad&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Apple Watch Series 6&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;单价（元）&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6799</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8499</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3199</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2699</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;颜色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;蓝色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;金色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;灰色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;粉色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;库存数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">iPhone 12</td><td style="text-align:left;">6799</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">MacBook Air</td><td style="text-align:left;">8499</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">iPad</td><td style="text-align:left;">3199</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Apple Watch Series 6</td><td style="text-align:left;">2699</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">蓝色</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">金色</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">灰色</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">粉色</td><td style="text-align:left;">80</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.concat([df5, df6], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品名</strong></th><th style="text-align:left;"><strong>单价（元）</strong></th><th style="text-align:left;"><strong>颜色</strong></th><th style="text-align:left;"><strong>库存数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">iPhone 12</td><td style="text-align:left;">6799</td><td style="text-align:left;">蓝色</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">MacBook Air</td><td style="text-align:left;">8499</td><td style="text-align:left;">金色</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">iPad</td><td style="text-align:left;">3199</td><td style="text-align:left;">灰色</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Apple Watch Series 6</td><td style="text-align:left;">2699</td><td style="text-align:left;">粉色</td><td style="text-align:left;">80</td></tr></tbody></table><h2 id="二、对dataframe进行合并" tabindex="-1">二、对DataFrame进行合并 <a class="header-anchor" href="#二、对dataframe进行合并" aria-label="Permalink to “二、对DataFrame进行合并”">​</a></h2><h3 id="一-、根据某列的值合并dataframe" tabindex="-1">（一）、根据某列的值合并DataFrame <a class="header-anchor" href="#一-、根据某列的值合并dataframe" aria-label="Permalink to “（一）、根据某列的值合并DataFrame”">​</a></h3><p>拼接相当于把两坨数据，简单粗暴地拼到一起；而合并是基于某些列的匹配连接。</p><h4 id="_1、一般情况" tabindex="-1">1、一般情况 <a class="header-anchor" href="#_1、一般情况" aria-label="Permalink to “1、一般情况”">​</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(df1, df2, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;列名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>用Pandas的merge函数，传入要合并的DataFrame作为参数，可选参数on，来指定我们根据哪列的值匹配来进行合并</p><p><strong>给on传入的列名，要同时出现在要合并的两个DataFrame里面</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Amy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Bill&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Cathy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Dave&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;邮箱&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;amy@xxx.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;bill@xxx.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cat@xxx.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dave@xxx.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">75</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>邮箱</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Amy</td><td style="text-align:left;"><a href="mailto:amy@xxx.com" target="_blank" rel="noreferrer">amy@xxx.com</a></td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bill</td><td style="text-align:left;"><a href="mailto:bill@xxx.com" target="_blank" rel="noreferrer">bill@xxx.com</a></td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Cathy</td><td style="text-align:left;"><a href="mailto:cat@xxx.com" target="_blank" rel="noreferrer">cat@xxx.com</a></td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Dave</td><td style="text-align:left;"><a href="mailto:dave@xxx.com" target="_blank" rel="noreferrer">dave@xxx.com</a></td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>销售额</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">1</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">1</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">2</td><td style="text-align:left;">75</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">4</td><td style="text-align:left;">90</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">4</td><td style="text-align:left;">120</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(customer_df, order_df, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>邮箱</strong></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>销售额</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Amy</td><td style="text-align:left;"><a href="mailto:amy@xxx.com" target="_blank" rel="noreferrer">amy@xxx.com</a></td><td style="text-align:left;">1</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Amy</td><td style="text-align:left;"><a href="mailto:amy@xxx.com" target="_blank" rel="noreferrer">amy@xxx.com</a></td><td style="text-align:left;">2</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bill</td><td style="text-align:left;"><a href="mailto:bill@xxx.com" target="_blank" rel="noreferrer">bill@xxx.com</a></td><td style="text-align:left;">3</td><td style="text-align:left;">75</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Dave</td><td style="text-align:left;"><a href="mailto:dave@xxx.com" target="_blank" rel="noreferrer">dave@xxx.com</a></td><td style="text-align:left;">4</td><td style="text-align:left;">90</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Dave</td><td style="text-align:left;"><a href="mailto:dave@xxx.com" target="_blank" rel="noreferrer">dave@xxx.com</a></td><td style="text-align:left;">5</td><td style="text-align:left;">120</td></tr></tbody></table><p>如上例子，我们只有把顾客信息和订单信息分开在两个表里面，相同信息才不会多次重复出现。</p><p>假设我们只有一个表，里面又有订单数据又有客户信息的话。如果客户1下单了50次，那她的姓名和邮箱，就会在这个表里面重复50次；特别是，如果当客户1更改邮箱，那所有出现了她邮箱信息的行，都得去进行更新；但是如果我们把订单数据和客户信息放在两个表中，我们就只需要更新客户信息表中的一行。</p><p>由上可知，把不同的信息分开在不同表中，实际上是一个最佳实践。</p><p><strong>因此，在数据分析中，经常需要对DataFrame进行合并。</strong></p><h4 id="_2、根据多列的值匹配来进行合并" tabindex="-1">2、根据多列的值匹配来进行合并 <a class="header-anchor" href="#_2、根据多列的值匹配来进行合并" aria-label="Permalink to “2、根据多列的值匹配来进行合并”">​</a></h4><p><code>on=[&#39;列名1&#39;, &#39;列名2&#39;...]</code></p><p>在合并的时候根据多列的值，要求它们得同时匹配</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A004&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张三&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李四&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王五&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;手机号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;13512345678&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;13612345678&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;13712345678&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>销售额</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">A001</td><td style="text-align:left;">2000-01-01</td><td style="text-align:left;">C001</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">A002</td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">C002</td><td style="text-align:left;">200</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">A003</td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">C001</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">A004</td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C003</td><td style="text-align:left;">300</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>手机号</strong></th><th style="text-align:left;"><strong>订单日期</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">C001</td><td style="text-align:left;">张三</td><td style="text-align:left;">13512345678</td><td style="text-align:left;">2000-01-01</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">C002</td><td style="text-align:left;">李四</td><td style="text-align:left;">13612345678</td><td style="text-align:left;">2000-01-02</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">C003</td><td style="text-align:left;">王五</td><td style="text-align:left;">13712345678</td><td style="text-align:left;">2000-01-03</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(order_df2, customer_df2, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;订单日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>手机号</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">A001</td><td style="text-align:left;">2000-01-01</td><td style="text-align:left;">C001</td><td style="text-align:left;">100</td><td style="text-align:left;">张三</td><td style="text-align:left;">13512345678</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">A002</td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">C002</td><td style="text-align:left;">200</td><td style="text-align:left;">李四</td><td style="text-align:left;">13612345678</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">A004</td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C003</td><td style="text-align:left;">300</td><td style="text-align:left;">王五</td><td style="text-align:left;">13712345678</td></tr></tbody></table><h4 id="_3、当某个变量-虽然在两个dataframe里面出现-但是列名并不统一" tabindex="-1">3、当某个变量，虽然在两个DataFrame里面出现，但是列名并不统一 <a class="header-anchor" href="#_3、当某个变量-虽然在两个dataframe里面出现-但是列名并不统一" aria-label="Permalink to “3、当某个变量，虽然在两个DataFrame里面出现，但是列名并不统一”">​</a></h4><ol><li>对任一DataFrame列名，进行重命名</li><li>把可选参数<code>on</code>,替换成<code>left_on</code>和<code>right_on</code>，给<code>left_on</code>传入的是左边DataFrame用于合并的列名，给<code>right_on</code>传入的是右边DataFrame用于合并的列名</li></ol><p><strong>合并后，原来的两个DataFrame的列都会保留，用于匹配的列的值一致</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A004&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张三&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李四&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王五&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;手机号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;13512345678&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;13612345678&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;13712345678&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;交易日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>客户编号</strong></th><th style="text-align:left;"><strong>销售额</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">A001</td><td style="text-align:left;">2000-01-01</td><td style="text-align:left;">C001</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">A002</td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">C002</td><td style="text-align:left;">200</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">A003</td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">C001</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">A004</td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C003</td><td style="text-align:left;">300</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>手机号</strong></th><th style="text-align:left;"><strong>交易日期</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">C001</td><td style="text-align:left;">张三</td><td style="text-align:left;">13512345678</td><td style="text-align:left;">2000-01-01</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">C002</td><td style="text-align:left;">李四</td><td style="text-align:left;">13612345678</td><td style="text-align:left;">2000-01-02</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">C003</td><td style="text-align:left;">王五</td><td style="text-align:left;">13712345678</td><td style="text-align:left;">2000-01-03</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(order_df3, customer_df3, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">left_on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;订单日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">right_on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;交易日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>客户编号</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>手机号</strong></th><th style="text-align:left;"><strong>交易日期</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">A001</td><td style="text-align:left;">2000-01-01</td><td style="text-align:left;">C001</td><td style="text-align:left;">100</td><td style="text-align:left;">C001</td><td style="text-align:left;">张三</td><td style="text-align:left;">13512345678</td><td style="text-align:left;">2000-01-01</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">A002</td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">C002</td><td style="text-align:left;">200</td><td style="text-align:left;">C002</td><td style="text-align:left;">李四</td><td style="text-align:left;">13612345678</td><td style="text-align:left;">2000-01-02</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">A004</td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C003</td><td style="text-align:left;">300</td><td style="text-align:left;">C003</td><td style="text-align:left;">王五</td><td style="text-align:left;">13712345678</td><td style="text-align:left;">2000-01-03</td></tr></tbody></table><h4 id="_4、除了用于匹配的列-两张表还有其它的重名列" tabindex="-1">4、除了用于匹配的列，两张表还有其它的重名列 <a class="header-anchor" href="#_4、除了用于匹配的列-两张表还有其它的重名列" aria-label="Permalink to “4、除了用于匹配的列，两张表还有其它的重名列”">​</a></h4><p>不会报错</p><p>合并后，为了区分某个重名的列到底来自哪个表，merge函数会自动为列名的结尾加上后缀，&#39;_x&#39;表示来自第一个表，&#39;_y&#39;表示来自第二个表</p><ol><li>自定义后缀</li></ol><p>传入可选参数<code>suffixes=[&#39;第一个表的重名列的后缀&#39;, &#39;第二个表的重名列的后缀&#39;]</code></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;店铺&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df8 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-01-04&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;店铺&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;D&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>店铺</strong></th><th style="text-align:left;"><strong>销售额</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">2000-01-01</td><td style="text-align:left;">A</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">B</td><td style="text-align:left;">200</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C</td><td style="text-align:left;">300</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df8</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>店铺</strong></th><th style="text-align:left;"><strong>销售额</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">B</td><td style="text-align:left;">400</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C</td><td style="text-align:left;">500</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2000-01-04</td><td style="text-align:left;">D</td><td style="text-align:left;">600</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(df7, df8, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;店铺&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>店铺</strong></th><th style="text-align:left;"><strong>销售额_x</strong></th><th style="text-align:left;"><strong>销售额_y</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">B</td><td style="text-align:left;">200</td><td style="text-align:left;">400</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C</td><td style="text-align:left;">300</td><td style="text-align:left;">500</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(df7, df8, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;店铺&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">suffixes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_df7&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_df8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>店铺</strong></th><th style="text-align:left;"><strong>销售额_df7</strong></th><th style="text-align:left;"><strong>销售额_df8</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">2000-01-02</td><td style="text-align:left;">B</td><td style="text-align:left;">200</td><td style="text-align:left;">400</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2000-01-03</td><td style="text-align:left;">C</td><td style="text-align:left;">300</td><td style="text-align:left;">500</td></tr></tbody></table><h4 id="_5、合并类型" tabindex="-1">5、合并类型 <a class="header-anchor" href="#_5、合并类型" aria-label="Permalink to “5、合并类型”">​</a></h4><p>1）合并类型包括：inner、outer、left、right</p><p>inner表示合并结果里，只保留左右表都有匹配的值；</p><p>outer表示合并结果里，保留左右表的所有值，如果有匹配不上的，用NaN值填充，因此最终结果里所有行都出现了；</p><p>left表示合并结果里，会保留左边表的所有值，然后右边表根据左边的值去匹配，如果有匹配不上的用NaN值填充，因此最终结果里左边表的行都会在；</p><p>right表示合并结果里，会保留右边表的所有值，然后左边表根据右边的值去匹配，如果有匹配不上的用NaN值填充，因此最终结果里右边表的行都会在。</p><p>2）可以给merge函数传入可选参数<code>how=&#39;合并类型&#39;</code>，用来指定合并类型，默认合并类型是inner</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customers_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Tom&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Bob&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Mary&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;年龄&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">35</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">27</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(customers_data)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">orders_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1002</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1003</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1004</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1005</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1006</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;订单日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-03-12&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-03-13&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-03-13&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-03-15&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-03-18&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2000-03-21&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;产品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;D&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;E&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;F&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(orders_data)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Mary</td><td style="text-align:left;">27</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Alice</td><td style="text-align:left;">19</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">John</td><td style="text-align:left;">42</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>产品</strong></th><th style="text-align:left;"><strong>数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1001</td><td style="text-align:left;">2000-03-12</td><td style="text-align:left;">1</td><td style="text-align:left;">A</td><td style="text-align:left;">2</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">1002</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">1</td><td style="text-align:left;">B</td><td style="text-align:left;">3</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">1003</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">2</td><td style="text-align:left;">C</td><td style="text-align:left;">1</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">1004</td><td style="text-align:left;">2000-03-15</td><td style="text-align:left;">6</td><td style="text-align:left;">D</td><td style="text-align:left;">4</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">1005</td><td style="text-align:left;">2000-03-18</td><td style="text-align:left;">5</td><td style="text-align:left;">E</td><td style="text-align:left;">5</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">1006</td><td style="text-align:left;">2000-03-21</td><td style="text-align:left;">3</td><td style="text-align:left;">F</td><td style="text-align:left;">2</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(customer_df4, order_df4, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">how</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inner&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>产品</strong></th><th style="text-align:left;"><strong>数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20</td><td style="text-align:left;">1001</td><td style="text-align:left;">2000-03-12</td><td style="text-align:left;">A</td><td style="text-align:left;">2</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20</td><td style="text-align:left;">1002</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">B</td><td style="text-align:left;">3</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td><td style="text-align:left;">1003</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">C</td><td style="text-align:left;">1</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Mary</td><td style="text-align:left;">27</td><td style="text-align:left;">1006</td><td style="text-align:left;">2000-03-21</td><td style="text-align:left;">F</td><td style="text-align:left;">2</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">John</td><td style="text-align:left;">42</td><td style="text-align:left;">1005</td><td style="text-align:left;">2000-03-18</td><td style="text-align:left;">E</td><td style="text-align:left;">5</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(customer_df4, order_df4, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">how</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;outer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>产品</strong></th><th style="text-align:left;"><strong>数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20.0</td><td style="text-align:left;">1001.0</td><td style="text-align:left;">2000-03-12</td><td style="text-align:left;">A</td><td style="text-align:left;">2.0</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20.0</td><td style="text-align:left;">1002.0</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">B</td><td style="text-align:left;">3.0</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bob</td><td style="text-align:left;">35.0</td><td style="text-align:left;">1003.0</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">C</td><td style="text-align:left;">1.0</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Mary</td><td style="text-align:left;">27.0</td><td style="text-align:left;">1006.0</td><td style="text-align:left;">2000-03-21</td><td style="text-align:left;">F</td><td style="text-align:left;">2.0</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Alice</td><td style="text-align:left;">19.0</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">John</td><td style="text-align:left;">42.0</td><td style="text-align:left;">1005.0</td><td style="text-align:left;">2000-03-18</td><td style="text-align:left;">E</td><td style="text-align:left;">5.0</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">6</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">1004.0</td><td style="text-align:left;">2000-03-15</td><td style="text-align:left;">D</td><td style="text-align:left;">4.0</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(customer_df4, order_df4, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">how</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;left&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>产品</strong></th><th style="text-align:left;"><strong>数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20</td><td style="text-align:left;">1001.0</td><td style="text-align:left;">2000-03-12</td><td style="text-align:left;">A</td><td style="text-align:left;">2.0</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20</td><td style="text-align:left;">1002.0</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">B</td><td style="text-align:left;">3.0</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td><td style="text-align:left;">1003.0</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">C</td><td style="text-align:left;">1.0</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Mary</td><td style="text-align:left;">27</td><td style="text-align:left;">1006.0</td><td style="text-align:left;">2000-03-21</td><td style="text-align:left;">F</td><td style="text-align:left;">2.0</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Alice</td><td style="text-align:left;">19</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">John</td><td style="text-align:left;">42</td><td style="text-align:left;">1005.0</td><td style="text-align:left;">2000-03-18</td><td style="text-align:left;">E</td><td style="text-align:left;">5.0</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.merge(customer_df4, order_df4, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">how</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;right&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>产品</strong></th><th style="text-align:left;"><strong>数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20.0</td><td style="text-align:left;">1001</td><td style="text-align:left;">2000-03-12</td><td style="text-align:left;">A</td><td style="text-align:left;">2</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20.0</td><td style="text-align:left;">1002</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">B</td><td style="text-align:left;">3</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bob</td><td style="text-align:left;">35.0</td><td style="text-align:left;">1003</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">C</td><td style="text-align:left;">1</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">6</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">1004</td><td style="text-align:left;">2000-03-15</td><td style="text-align:left;">D</td><td style="text-align:left;">4</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">John</td><td style="text-align:left;">42.0</td><td style="text-align:left;">1005</td><td style="text-align:left;">2000-03-18</td><td style="text-align:left;">E</td><td style="text-align:left;">5</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Mary</td><td style="text-align:left;">27.0</td><td style="text-align:left;">1006</td><td style="text-align:left;">2000-03-21</td><td style="text-align:left;">F</td><td style="text-align:left;">2</td></tr></tbody></table><h3 id="二-、根据索引合并dataframe" tabindex="-1">（二）、根据索引合并DataFrame <a class="header-anchor" href="#二-、根据索引合并dataframe" aria-label="Permalink to “（二）、根据索引合并DataFrame”">​</a></h3><p>join方法</p><p>join方法是根据索引去合并DataFrame，会保留两个DataFrame的所有的列</p><p><strong>假如有重名列，会报错，需要传入可选参数</strong><code>**lsuffix=&#39;左边DataFrame重名列的后缀&#39;**</code><strong>和</strong><code>**rsuffix=&#39;右边DataFrame重名列的后缀&#39;**</code></p><p><strong>join是方法，不是函数，所以我们是要用某个DataFrame去调用</strong></p><p><strong>join方法也可以传入可选参数</strong><code>**how**</code><strong>，来指定去进行哪个类型的合并</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Mary</td><td style="text-align:left;">27</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Alice</td><td style="text-align:left;">19</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">John</td><td style="text-align:left;">42</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">order_df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>客户ID</strong></th><th style="text-align:left;"><strong>产品</strong></th><th style="text-align:left;"><strong>数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1001</td><td style="text-align:left;">2000-03-12</td><td style="text-align:left;">1</td><td style="text-align:left;">A</td><td style="text-align:left;">2</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">1002</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">1</td><td style="text-align:left;">B</td><td style="text-align:left;">3</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">1003</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">2</td><td style="text-align:left;">C</td><td style="text-align:left;">1</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">1004</td><td style="text-align:left;">2000-03-15</td><td style="text-align:left;">6</td><td style="text-align:left;">D</td><td style="text-align:left;">4</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">1005</td><td style="text-align:left;">2000-03-18</td><td style="text-align:left;">5</td><td style="text-align:left;">E</td><td style="text-align:left;">5</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">1006</td><td style="text-align:left;">2000-03-21</td><td style="text-align:left;">3</td><td style="text-align:left;">F</td><td style="text-align:left;">2</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_df4.join(order_df4, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">lsuffix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_customer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">rsuffix</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_order&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户ID_customer</strong></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>订单ID</strong></th><th style="text-align:left;"><strong>订单日期</strong></th><th style="text-align:left;"><strong>客户ID_order</strong></th><th style="text-align:left;"><strong>产品</strong></th><th style="text-align:left;"><strong>数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1</td><td style="text-align:left;">Tom</td><td style="text-align:left;">20</td><td style="text-align:left;">1001</td><td style="text-align:left;">2000-03-12</td><td style="text-align:left;">1</td><td style="text-align:left;">A</td><td style="text-align:left;">2</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2</td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td><td style="text-align:left;">1002</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">1</td><td style="text-align:left;">B</td><td style="text-align:left;">3</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">3</td><td style="text-align:left;">Mary</td><td style="text-align:left;">27</td><td style="text-align:left;">1003</td><td style="text-align:left;">2000-03-13</td><td style="text-align:left;">2</td><td style="text-align:left;">C</td><td style="text-align:left;">1</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4</td><td style="text-align:left;">Alice</td><td style="text-align:left;">19</td><td style="text-align:left;">1004</td><td style="text-align:left;">2000-03-15</td><td style="text-align:left;">6</td><td style="text-align:left;">D</td><td style="text-align:left;">4</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">5</td><td style="text-align:left;">John</td><td style="text-align:left;">42</td><td style="text-align:left;">1005</td><td style="text-align:left;">2000-03-18</td><td style="text-align:left;">5</td><td style="text-align:left;">E</td><td style="text-align:left;">5</td></tr></tbody></table><p>随着数据表的数量增加，和分析数据的复杂度的增加，可能会越来越多的用merge做合并数据的操作。</p><h2 id="三、分组聚合" tabindex="-1">三、分组聚合 <a class="header-anchor" href="#三、分组聚合" aria-label="Permalink to “三、分组聚合”">​</a></h2><h3 id="一-、聚合函数" tabindex="-1">（一）、聚合函数 <a class="header-anchor" href="#一-、聚合函数" aria-label="Permalink to “（一）、聚合函数”">​</a></h3><p>定义好的聚合函数包括：</p><ol><li>count()，得到元素的数量</li><li>first()，得到第一个元素</li><li>last()，得到最后一个元素</li><li>mean()，得到所有元素平均值</li><li>median()，得到所有元素中位数</li><li>min()，得到所有元素最小值</li><li>max()，得到所有元素最大值</li><li>std()，得到所有元素的标准差</li><li>var()，得到所有元素的方差</li><li>prod()，得到所有元素的积</li><li>sum()，得到所有元素的和</li></ol><h3 id="一-、对dataframe进行分组聚合运算" tabindex="-1">（一）、对DataFrame进行分组聚合运算 <a class="header-anchor" href="#一-、对dataframe进行分组聚合运算" aria-label="Permalink to “（一）、对DataFrame进行分组聚合运算”">​</a></h3><h4 id="_1、根据单个变量进行分组聚合运算" tabindex="-1">1、根据单个变量进行分组聚合运算 <a class="header-anchor" href="#_1、根据单个变量进行分组聚合运算" aria-label="Permalink to “1、根据单个变量进行分组聚合运算”">​</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;商品类别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2700</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">105</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">171</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">162</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">67</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">57</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>分店编号</strong></th><th style="text-align:left;"><strong>时间段</strong></th><th style="text-align:left;"><strong>商品类别</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">1500</td><td style="text-align:left;">105</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">2000</td><td style="text-align:left;">84</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">3000</td><td style="text-align:left;">171</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">2500</td><td style="text-align:left;">162</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">1800</td><td style="text-align:left;">67</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">2200</td><td style="text-align:left;">150</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">3200</td><td style="text-align:left;">99</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">2700</td><td style="text-align:left;">57</td></tr></tbody></table><p>DataFrame的groupby方法</p><ol><li>根据变量进行分组，得到一个叫做DataFrameGroupBy的实例</li></ol><p><code>df.groupby(&#39;变量&#39;)</code></p><ol start="2"><li>底层逻辑</li></ol><p>groupby方法，会自动把变量值相同的行分组组合到一起，并返回一个叫做DataFrameGroupBy的实例。</p><p>分组组合，可以看成把变量值相同的许多数据组合进，以组为单位的单元格中，这时一个单元格里面有多个数据，并不是有效的表格数据，无法返回DataFrame。</p><p>因此，最后需要通过聚合函数，生成有效表格数据。</p><ol start="3"><li>提取变量，对DataFrameGroupBy的实例，提取出要进行聚合运算的单列或多列</li></ol><p>1)单列</p><p><code>df.groupby(&#39;变量&#39;)[&#39;要进行聚合运算的单列&#39;]</code></p><p>2)多列</p><p>在方括号里传入一个列表</p><p><code>df.groupby(&#39;变量&#39;)[[&#39;变量1&#39;, &#39;变量2&#39;]]</code></p><ol start="4"><li>进行聚合运算</li></ol><p><code>df.groupby(&#39;变量&#39;)[&#39;要进行聚合运算的单列&#39;].聚合函数()</code></p><ol start="5"><li>结果</li></ol><p>返回的结果的索引，是我们给groupby传入的变量名</p><p>返回的结果，是Series还是DataFrame，取决于聚合运算前提取出的变量是单个还是多个</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pandas.core.groupby.generic.DataFrameGroupBy </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000001F57F84C390</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pandas.core.groupby.generic.SeriesGroupBy </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000001F57905BAD0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pandas.core.groupby.generic.DataFrameGroupBy </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000001F51882FC10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].mean()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">分店编号</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">01</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    2375.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">02</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    2350.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 销售额, dtype: float64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]].mean()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th><strong>销售额</strong></th><th><strong>销售数量</strong></th></tr></thead><tbody><tr><td><strong>分店编号</strong></td><td></td><td></td></tr><tr><td><strong>001</strong></td><td>2375.0</td><td>110.50</td></tr><tr><td><strong>002</strong></td><td>2350.0</td><td>113.25</td></tr></tbody></table><h4 id="_2、根据多个变量进行分组聚合运算" tabindex="-1">2、根据多个变量进行分组聚合运算 <a class="header-anchor" href="#_2、根据多个变量进行分组聚合运算" aria-label="Permalink to “2、根据多个变量进行分组聚合运算”">​</a></h4><p>给groupby方法传入一个列表，里面放上多个变量</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.groupby([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]].mean()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th></th><th><strong>销售额</strong></th><th><strong>销售数量</strong></th></tr></thead><tbody><tr><td><strong>分店编号</strong></td><td><strong>时间段</strong></td><td></td><td></td></tr><tr><td><strong>001</strong></td><td><strong>2022Q1</strong></td><td>2250.0</td><td>138.0</td></tr><tr><td></td><td><strong>2022Q2</strong></td><td>2500.0</td><td>83.0</td></tr><tr><td><strong>002</strong></td><td><strong>2022Q1</strong></td><td>2250.0</td><td>123.0</td></tr><tr><td></td><td><strong>2022Q2</strong></td><td>2450.0</td><td>103.5</td></tr></tbody></table><h4 id="_3、自定义聚合函数" tabindex="-1">3、自定义聚合函数 <a class="header-anchor" href="#_3、自定义聚合函数" aria-label="Permalink to “3、自定义聚合函数”">​</a></h4><p>自定义聚合函数的要求是，它能把Series里一堆数字汇总成一个数字</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> max_plus_10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nums):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nums.max() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>可以用apply方法，参数传入自定义聚合函数的函数名，详见Dataframe章节</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df.groupby([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]].apply(max_plus_10)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th></th><th><strong>销售额</strong></th><th><strong>销售数量</strong></th></tr></thead><tbody><tr><td><strong>分店编号</strong></td><td><strong>时间段</strong></td><td></td><td></td></tr><tr><td><strong>001</strong></td><td><strong>2022Q1</strong></td><td>3010</td><td>181</td></tr><tr><td></td><td><strong>2022Q2</strong></td><td>3210</td><td>109</td></tr><tr><td><strong>002</strong></td><td><strong>2022Q1</strong></td><td>2510</td><td>172</td></tr><tr><td></td><td><strong>2022Q2</strong></td><td>2710</td><td>160</td></tr></tbody></table><h3 id="三-、透视表" tabindex="-1">（三）、透视表 <a class="header-anchor" href="#三-、透视表" aria-label="Permalink to “（三）、透视表”">​</a></h3><p>Pandas的<code>pivot_table</code>函数</p><ol><li>功能</li></ol><p>基于原始数据对表进行重塑，让表变得更加直观，方便我们阅读和理解</p><ol start="2"><li>语法</li></ol><p><code>pd.pivot_table(DataFrame, index=[&#39;列名1&#39;, &#39;列名2&#39;], columns=&#39;列名3&#39;, values=&#39;列名4&#39;, aggfunc=&#39;函数名&#39;)</code></p><p>把包含数据的DataFrame和想设定的索引、列、值以及聚合函数的函数名，都作为参数，传入pivot_table函数</p><p>需要两层索引，可以给<code>index</code>传入一个列表</p><p><strong>由于重塑得到的表格，每个单元格，相当于包含经索引和列分组后的数据，大多数情况下不是一个数据，所以需要聚合函数</strong></p><p><strong>不指定</strong><code>**aggfunc**</code><strong>时，默认是NumPy的</strong><code>**mean**</code><strong>函数</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>分店编号</strong></th><th style="text-align:left;"><strong>时间段</strong></th><th style="text-align:left;"><strong>商品类别</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售数量</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">1500</td><td style="text-align:left;">105</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">2000</td><td style="text-align:left;">84</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">3000</td><td style="text-align:left;">171</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q1</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">2500</td><td style="text-align:left;">162</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">1800</td><td style="text-align:left;">67</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">生鲜食品</td><td style="text-align:left;">2200</td><td style="text-align:left;">150</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">001</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">3200</td><td style="text-align:left;">99</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">002</td><td style="text-align:left;">2022Q2</td><td style="text-align:left;">休闲食品</td><td style="text-align:left;">2700</td><td style="text-align:left;">57</td></tr></tbody></table><p>把df的分店编号和时间段作为索引，商品类别作为列，计算销售额的总和</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.pivot_table(df, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;商品类别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">aggfunc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.sum)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品类别</strong></th><th><strong>休闲食品</strong></th><th><strong>生鲜食品</strong></th></tr></thead><tbody><tr><td><strong>分店编号</strong></td><td style="text-align:left;"><strong>时间段</strong></td><td></td><td></td></tr><tr><td><strong>001</strong></td><td style="text-align:left;"><strong>2022Q1</strong></td><td>3000</td><td>1500</td></tr><tr><td></td><td style="text-align:left;"><strong>2022Q2</strong></td><td>3200</td><td>1800</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;"><strong>2022Q1</strong></td><td>2500</td><td>2000</td></tr><tr><td></td><td style="text-align:left;"><strong>2022Q2</strong></td><td>2700</td><td>2200</td></tr></tbody></table><p><strong>由于Series底层实现就是NumPy的数组，所以针对数组的函数也可以用在Pandas的Series上</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.pivot_table(df, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;商品类别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">aggfunc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品类别</strong></th><th><strong>休闲食品</strong></th><th><strong>生鲜食品</strong></th></tr></thead><tbody><tr><td><strong>分店编号</strong></td><td style="text-align:left;"><strong>时间段</strong></td><td></td><td></td></tr><tr><td><strong>001</strong></td><td style="text-align:left;"><strong>2022Q1</strong></td><td>3000</td><td>1500</td></tr><tr><td></td><td style="text-align:left;"><strong>2022Q2</strong></td><td>3200</td><td>1800</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;"><strong>2022Q1</strong></td><td>2500</td><td>2000</td></tr><tr><td></td><td style="text-align:left;"><strong>2022Q2</strong></td><td>2700</td><td>2200</td></tr></tbody></table><p><strong>因为sum是Python内置函数，所以也不一定调用NumPy数据库</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 把df的分店编号和时间段作为索引，商品类别作为列，计算销售额的平均值</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 由于这里重塑的表格每个单元格只包含原来DataFrame的一个单元格的数据，所以求和和求平均的结果一致</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.pivot_table(df, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;商品类别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>商品类别</strong></th><th><strong>休闲食品</strong></th><th><strong>生鲜食品</strong></th></tr></thead><tbody><tr><td><strong>分店编号</strong></td><td style="text-align:left;"><strong>时间段</strong></td><td></td><td></td></tr><tr><td><strong>001</strong></td><td style="text-align:left;"><strong>2022Q1</strong></td><td>3000</td><td>1500</td></tr><tr><td></td><td style="text-align:left;"><strong>2022Q2</strong></td><td>3200</td><td>1800</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;"><strong>2022Q1</strong></td><td>2500</td><td>2000</td></tr><tr><td></td><td style="text-align:left;"><strong>2022Q2</strong></td><td>2700</td><td>2200</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 把df的商品类别作为索引，分店编号作为列，计算销售额的平均值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.pivot_table(df, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;商品类别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>分店编号</strong></th><th><strong>001</strong></th><th><strong>002</strong></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>商品类别</strong></td><td></td><td></td></tr><tr><td style="text-align:left;"><strong>休闲食品</strong></td><td>3100</td><td>2600</td></tr><tr><td style="text-align:left;"><strong>生鲜食品</strong></td><td>1650</td><td>2100</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 把df的商品类别作为索引，分店编号作为列，计算销售额的总和</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.pivot_table(df, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;商品类别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">aggfunc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">np.sum)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>分店编号</strong></th><th><strong>001</strong></th><th><strong>002</strong></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>商品类别</strong></td><td></td><td></td></tr><tr><td style="text-align:left;"><strong>休闲食品</strong></td><td>6200</td><td>5200</td></tr><tr><td style="text-align:left;"><strong>生鲜食品</strong></td><td>3300</td><td>4200</td></tr></tbody></table><h3 id="四-、groupby方法和pivot-table函数异同" tabindex="-1">（四）、groupby方法和pivot_table函数异同 <a class="header-anchor" href="#四-、groupby方法和pivot-table函数异同" aria-label="Permalink to “（四）、groupby方法和pivot_table函数异同”">​</a></h3><ol><li><strong>groupby方法和pivot_table函数的相同之处：</strong></li></ol><p><strong>都可以进行分组聚合运算</strong></p><ol start="2"><li><strong>groupby方法和pivot_table函数的不同之处：</strong></li></ol><p><strong>pivot_table函数可以把变量作为索引分组，也可以把变量作为列进行分组；</strong></p><p><strong>groupby方法把数据分组后，用于分组的变量只能作为索引</strong></p><p><strong>当主要目的是分组聚合运算时，groupby方法会更加常用，因为根据什么分组，提取什么变量，做什么聚合操作，这个逻辑更加直接</strong></p><p>分组聚合操作是数据分析中的重要方法。</p><p>针对某个数据集，假如想把地区作为切入点，看地区之间是否有差异，就可以对数据用地区变量进行分组，进行聚合分析。</p><h2 id="四、数据分箱" tabindex="-1">四、数据分箱 <a class="header-anchor" href="#四、数据分箱" aria-label="Permalink to “四、数据分箱”">​</a></h2><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;residents_data.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>性别</strong></th><th style="text-align:left;"><strong>居住地</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">北京</td><td style="text-align:left;">38</td><td style="text-align:left;">18053</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">上海</td><td style="text-align:left;">42</td><td style="text-align:left;">9382</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">广州</td><td style="text-align:left;">23</td><td style="text-align:left;">6376</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">深圳</td><td style="text-align:left;">36</td><td style="text-align:left;">10746</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">杭州</td><td style="text-align:left;">20</td><td style="text-align:left;">5284</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">南京</td><td style="text-align:left;">34</td><td style="text-align:left;">9828</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">成都</td><td style="text-align:left;">33</td><td style="text-align:left;">9366</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">重庆</td><td style="text-align:left;">47</td><td style="text-align:left;">22820</td></tr><tr><td><strong>8</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">武汉</td><td style="text-align:left;">36</td><td style="text-align:left;">16927</td></tr><tr><td><strong>9</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">西安</td><td style="text-align:left;">42</td><td style="text-align:left;">11591</td></tr><tr><td><strong>10</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">南昌</td><td style="text-align:left;">42</td><td style="text-align:left;">11316</td></tr><tr><td><strong>11</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">合肥</td><td style="text-align:left;">27</td><td style="text-align:left;">7426</td></tr><tr><td><strong>12</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">长沙</td><td style="text-align:left;">23</td><td style="text-align:left;">4705</td></tr><tr><td><strong>13</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">福州</td><td style="text-align:left;">41</td><td style="text-align:left;">24117</td></tr><tr><td><strong>14</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">厦门</td><td style="text-align:left;">50</td><td style="text-align:left;">69153</td></tr><tr><td><strong>15</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">济南</td><td style="text-align:left;">32</td><td style="text-align:left;">5559</td></tr><tr><td><strong>16</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">郑州</td><td style="text-align:left;">56</td><td style="text-align:left;">6391</td></tr><tr><td><strong>17</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">长春</td><td style="text-align:left;">60</td><td style="text-align:left;">11020</td></tr><tr><td><strong>18</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">哈尔滨</td><td style="text-align:left;">59</td><td style="text-align:left;">68189</td></tr><tr><td><strong>19</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">南宁</td><td style="text-align:left;">32</td><td style="text-align:left;">15661</td></tr></tbody></table><h3 id="一-、进行数据分箱" tabindex="-1">（一）、进行数据分箱 <a class="header-anchor" href="#一-、进行数据分箱" aria-label="Permalink to “（一）、进行数据分箱”">​</a></h3><p><strong>分箱，就是把数据按特定的规则进行分组，实现数据的离散化，增强数据稳定性。</strong></p><p>针对某个数据集，如果想把年龄作为切入点，对数据用年龄变量进行分组，进行聚合分析；会发现因为年龄存在很多可能性，出现非常多组。</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df1.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;年龄&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;工资&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].mean()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">年龄</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     5284.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">23</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     5540.5</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">27</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     7426.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    10610.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">33</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     9366.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">34</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     9828.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">36</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    13836.5</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">38</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    18053.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">41</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    24117.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    10763.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">47</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    22820.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    69153.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">56</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     6391.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">59</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    68189.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    11020.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 工资, dtype: float64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="_1、pandas的cut函数" tabindex="-1">1、Pandas的cut函数 <a class="header-anchor" href="#_1、pandas的cut函数" aria-label="Permalink to “1、Pandas的cut函数”">​</a></h4><p>这时可以调用Pandas的cut函数</p><p>1）功能</p><p>可以帮我们对Series，根据数字范围进行划分，之后用划分后的标签进行分组</p><p>2）步骤</p><ul><li>新建一个列表，用它来表示数字的分组边界，也即分箱的规则</li><li>新建一个列表，用来表示各个范围所对应的标签，</li><li>根据分箱规则对变量进行分箱，并使用分组标签</li><li>把将分箱结果作为新的一列添加到原数据集中，然后可以开始进行分组聚合运算</li></ul><p>3）语法</p><p>函数中，传入要进行分箱的Series，和创建好的分箱规则，可选参数labels=&#39;分组标签列表&#39;</p><p><strong>标签和区间按顺序一一对应，因此分箱规则的列表需要比标签的列表多一个元素。</strong></p><p>4）结果</p><p>返回一个新的Series，数据类型是category，其中的种类就是根据传入的分箱规则划分的结果，展示了原始Series里面各个数字分别是属于什么范围的。</p><p>假如不传入可选参数labels，结果中Series的值，会以区间形式呈现，圆括号和方括号分别表示开区间和闭区间；假如传入可选参数labels，结果中Series的值，就变成了我们前面指定的标签</p><h4 id="_2、示例" tabindex="-1">2、示例 <a class="header-anchor" href="#_2、示例" aria-label="Permalink to “2、示例”">​</a></h4><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 定义年龄分组列表</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 并根据以上分组对df1的年龄列进行分箱</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">age_bins </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.cut(df1.年龄, age_bins)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 年龄, dtype: category</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Categories (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, interval[int64, right]): [(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 定义年龄分组列表</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 定义分组标签列表</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 根据分组对df1的年龄列进行分箱，并使用以上分组标签</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">age_bins </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">120</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">age_labels </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;儿童&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;青少年&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;青年&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;壮年&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;中年&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;中老年&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;老年&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pd.cut(df1.年龄, age_bins, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">age_labels)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      壮年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      中年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      青年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      壮年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     青少年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      壮年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      壮年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      中年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      壮年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      中年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     中年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     青年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     青年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     中年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     中年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     壮年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    中老年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    中老年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    中老年</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     壮年</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 年龄, dtype: category</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Categories (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;儿童&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;青少年&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;青年&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;壮年&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;中年&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;中老年&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;老年&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4.为df1新建&quot;年龄组&quot;列，值为以上分组标签</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;年龄组&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.cut(df1.年龄, age_bins, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">labels</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">age_labels)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>性别</strong></th><th style="text-align:left;"><strong>居住地</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th><th style="text-align:left;"><strong>年龄组</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">北京</td><td style="text-align:left;">38</td><td style="text-align:left;">18053</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">上海</td><td style="text-align:left;">42</td><td style="text-align:left;">9382</td><td style="text-align:left;">中年</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">广州</td><td style="text-align:left;">23</td><td style="text-align:left;">6376</td><td style="text-align:left;">青年</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">深圳</td><td style="text-align:left;">36</td><td style="text-align:left;">10746</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">杭州</td><td style="text-align:left;">20</td><td style="text-align:left;">5284</td><td style="text-align:left;">青少年</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">南京</td><td style="text-align:left;">34</td><td style="text-align:left;">9828</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">成都</td><td style="text-align:left;">33</td><td style="text-align:left;">9366</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">重庆</td><td style="text-align:left;">47</td><td style="text-align:left;">22820</td><td style="text-align:left;">中年</td></tr><tr><td><strong>8</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">武汉</td><td style="text-align:left;">36</td><td style="text-align:left;">16927</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>9</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">西安</td><td style="text-align:left;">42</td><td style="text-align:left;">11591</td><td style="text-align:left;">中年</td></tr><tr><td><strong>10</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">南昌</td><td style="text-align:left;">42</td><td style="text-align:left;">11316</td><td style="text-align:left;">中年</td></tr><tr><td><strong>11</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">合肥</td><td style="text-align:left;">27</td><td style="text-align:left;">7426</td><td style="text-align:left;">青年</td></tr><tr><td><strong>12</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">长沙</td><td style="text-align:left;">23</td><td style="text-align:left;">4705</td><td style="text-align:left;">青年</td></tr><tr><td><strong>13</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">福州</td><td style="text-align:left;">41</td><td style="text-align:left;">24117</td><td style="text-align:left;">中年</td></tr><tr><td><strong>14</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">厦门</td><td style="text-align:left;">50</td><td style="text-align:left;">69153</td><td style="text-align:left;">中年</td></tr><tr><td><strong>15</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">济南</td><td style="text-align:left;">32</td><td style="text-align:left;">5559</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>16</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">郑州</td><td style="text-align:left;">56</td><td style="text-align:left;">6391</td><td style="text-align:left;">中老年</td></tr><tr><td><strong>17</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">长春</td><td style="text-align:left;">60</td><td style="text-align:left;">11020</td><td style="text-align:left;">中老年</td></tr><tr><td><strong>18</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">哈尔滨</td><td style="text-align:left;">59</td><td style="text-align:left;">68189</td><td style="text-align:left;">中老年</td></tr><tr><td><strong>19</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">南宁</td><td style="text-align:left;">32</td><td style="text-align:left;">15661</td><td style="text-align:left;">壮年</td></tr></tbody></table><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. 对df1根据年龄组进行分组，计算各个年龄组的平均工资</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;年龄组&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;工资&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].mean()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">年龄组</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">儿童              NaN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">青少年     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5284.000000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">青年      </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6169.000000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">壮年     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12305.714286</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">中年     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24729.833333</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">中老年    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28533.333333</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">老年              NaN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 工资, dtype: float64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="二-、层次化索引" tabindex="-1">（二）、层次化索引 <a class="header-anchor" href="#二-、层次化索引" aria-label="Permalink to “（二）、层次化索引”">​</a></h3><p>在用groupby方法分组的时候，利用了一个以上的变量，会发现得到的DataFrame会出现层次化索引</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;商品类别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;生鲜食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;休闲食品&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2700</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">105</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">84</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">171</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">162</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">67</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">99</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">57</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grouped_df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df2.groupby([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;分店编号&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;时间段&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售数量&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]].mean()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grouped_df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><table tabindex="0"><thead><tr><th></th><th></th><th><strong>销售额</strong></th><th><strong>销售数量</strong></th></tr></thead><tbody><tr><td><strong>分店编号</strong></td><td><strong>时间段</strong></td><td></td><td></td></tr><tr><td><strong>001</strong></td><td><strong>2022Q1</strong></td><td>2250.0</td><td>138.0</td></tr><tr><td></td><td><strong>2022Q2</strong></td><td>2500.0</td><td>83.0</td></tr><tr><td><strong>002</strong></td><td><strong>2022Q1</strong></td><td>2250.0</td><td>123.0</td></tr><tr><td></td><td><strong>2022Q2</strong></td><td>2450.0</td><td>103.5</td></tr></tbody></table><h4 id="_1、针对层次化索引的dataframe-提取数据行" tabindex="-1">1、针对层次化索引的DataFrame，提取数据行 <a class="header-anchor" href="#_1、针对层次化索引的dataframe-提取数据行" aria-label="Permalink to “1、针对层次化索引的DataFrame，提取数据行”">​</a></h4><p>依然可以用方括号里面放上索引，去提取数据行</p><p>1）用外层索引，会一次性提取出多行</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grouped_df2.loc[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th><strong>销售额</strong></th><th><strong>销售数量</strong></th></tr></thead><tbody><tr><td><strong>时间段</strong></td><td></td><td></td></tr><tr><td><strong>2022Q1</strong></td><td>2250.0</td><td>138.0</td></tr><tr><td><strong>2022Q2</strong></td><td>2500.0</td><td>83.0</td></tr></tbody></table><p>2）要提取一行，可以在外层索引后，继续用内层索引继续去提取</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grouped_df2.loc[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].loc[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2022Q1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">销售额     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2250.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">销售数量     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">138.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">2022Q1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dtype: float64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>不能直接用内层索引去提取数据行</strong></p><h4 id="_2、重置索引" tabindex="-1">2、重置索引 <a class="header-anchor" href="#_2、重置索引" aria-label="Permalink to “2、重置索引”">​</a></h4><p>DataFrame的<code>reset_index</code>方法</p><p>索引会变成某列数据，详见清理数据章节</p><h3 id="三-、根据条件筛选数据" tabindex="-1">（三）、根据条件筛选数据 <a class="header-anchor" href="#三-、根据条件筛选数据" aria-label="Permalink to “（三）、根据条件筛选数据”">​</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>性别</strong></th><th style="text-align:left;"><strong>居住地</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th><th style="text-align:left;"><strong>年龄组</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">北京</td><td style="text-align:left;">38</td><td style="text-align:left;">18053</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">上海</td><td style="text-align:left;">42</td><td style="text-align:left;">9382</td><td style="text-align:left;">中年</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">广州</td><td style="text-align:left;">23</td><td style="text-align:left;">6376</td><td style="text-align:left;">青年</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">深圳</td><td style="text-align:left;">36</td><td style="text-align:left;">10746</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">杭州</td><td style="text-align:left;">20</td><td style="text-align:left;">5284</td><td style="text-align:left;">青少年</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">南京</td><td style="text-align:left;">34</td><td style="text-align:left;">9828</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">成都</td><td style="text-align:left;">33</td><td style="text-align:left;">9366</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">重庆</td><td style="text-align:left;">47</td><td style="text-align:left;">22820</td><td style="text-align:left;">中年</td></tr><tr><td><strong>8</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">武汉</td><td style="text-align:left;">36</td><td style="text-align:left;">16927</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>9</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">西安</td><td style="text-align:left;">42</td><td style="text-align:left;">11591</td><td style="text-align:left;">中年</td></tr><tr><td><strong>10</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">南昌</td><td style="text-align:left;">42</td><td style="text-align:left;">11316</td><td style="text-align:left;">中年</td></tr><tr><td><strong>11</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">合肥</td><td style="text-align:left;">27</td><td style="text-align:left;">7426</td><td style="text-align:left;">青年</td></tr><tr><td><strong>12</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">长沙</td><td style="text-align:left;">23</td><td style="text-align:left;">4705</td><td style="text-align:left;">青年</td></tr><tr><td><strong>13</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">福州</td><td style="text-align:left;">41</td><td style="text-align:left;">24117</td><td style="text-align:left;">中年</td></tr><tr><td><strong>14</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">厦门</td><td style="text-align:left;">50</td><td style="text-align:left;">69153</td><td style="text-align:left;">中年</td></tr><tr><td><strong>15</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">济南</td><td style="text-align:left;">32</td><td style="text-align:left;">5559</td><td style="text-align:left;">壮年</td></tr><tr><td><strong>16</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">郑州</td><td style="text-align:left;">56</td><td style="text-align:left;">6391</td><td style="text-align:left;">中老年</td></tr><tr><td><strong>17</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">长春</td><td style="text-align:left;">60</td><td style="text-align:left;">11020</td><td style="text-align:left;">中老年</td></tr><tr><td><strong>18</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">哈尔滨</td><td style="text-align:left;">59</td><td style="text-align:left;">68189</td><td style="text-align:left;">中老年</td></tr><tr><td><strong>19</strong></td><td style="text-align:left;">女</td><td style="text-align:left;">南宁</td><td style="text-align:left;">32</td><td style="text-align:left;">15661</td><td style="text-align:left;">壮年</td></tr></tbody></table><h4 id="_1、把series作为dataframe的索引" tabindex="-1">1、把Series作为DataFrame的索引 <a class="header-anchor" href="#_1、把series作为dataframe的索引" aria-label="Permalink to “1、把Series作为DataFrame的索引”">​</a></h4><p>把条件是否符合对应的布尔值的Series，作为DataFrame的索引，来筛选出所有布尔值为True的行</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[(df1[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;性别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;男&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (df1[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;年龄&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>性别</strong></th><th style="text-align:left;"><strong>居住地</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th><th style="text-align:left;"><strong>年龄组</strong></th></tr></thead><tbody><tr><td><strong>4</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">杭州</td><td style="text-align:left;">20</td><td style="text-align:left;">5284</td><td style="text-align:left;">青少年</td></tr></tbody></table><h4 id="_2、dataframe的query方法" tabindex="-1">2、DataFrame的query方法 <a class="header-anchor" href="#_2、dataframe的query方法" aria-label="Permalink to “2、DataFrame的query方法”">​</a></h4><p>1）优点</p><p>写法更加简洁直观</p><p>2）语法</p><p>给query方法传入一个字符串，字符串内容是想要筛选的条件，不同条件之间用括号包围，中间放上逻辑符号</p><p><strong>条件中的列名，不需要带DataFrame的名字，也不需要引号包围，直接用列名表示</strong></p><p><strong>条件里的普通字符串，需要带引号，并需要与query方法传入字符串外面，用不一样的引号；或者引号前面加上</strong><code>**\\**</code><strong>，进行一个转义，让代码知道这是字符串里面的单引号</strong></p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.query(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;(性别 == &quot;男&quot;) &amp; (年龄 &lt;= 20)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>性别</strong></th><th style="text-align:left;"><strong>居住地</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th><th style="text-align:left;"><strong>年龄组</strong></th></tr></thead><tbody><tr><td><strong>4</strong></td><td style="text-align:left;">男</td><td style="text-align:left;">杭州</td><td style="text-align:left;">20</td><td style="text-align:left;">5284</td><td style="text-align:left;">青少年</td></tr></tbody></table>`,255)])])}const y=s(n,[["render",e]]);export{E as __pageData,y as default};
