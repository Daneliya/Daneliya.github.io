import{_ as i,c as a,o as n,aN as l}from"./chunks/framework.CMIDsdwV.js";const E=JSON.parse('{"title":"NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®","description":"","frontmatter":{"title":"NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®","permalink":"/java/mse/registry/nacos-xml","tags":["Nacos"],"categories":["Nacos"]},"headers":[],"relativePath":"Java/å¾®æœåŠ¡ä¸“æ /03.æ³¨å†Œä¸­å¿ƒ/6_NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®.md","filePath":"Java/å¾®æœåŠ¡ä¸“æ /03.æ³¨å†Œä¸­å¿ƒ/6_NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®.md","lastUpdated":1768294263000}'),t={name:"Java/å¾®æœåŠ¡ä¸“æ /03.æ³¨å†Œä¸­å¿ƒ/6_NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®.md"};function e(p,s,h,k,r,o){return n(),a("div",null,[...s[0]||(s[0]=[l(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /Java\\å¾®æœåŠ¡ä¸“æ \\03.æ³¨å†Œä¸­å¿ƒ\\6_NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®.md for this page in Markdown format</div><h1 id="nacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®" tabindex="-1">NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½® <a class="header-anchor" href="#nacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®" aria-label="Permalink to &quot;NacosåŠ¨æ€è¯»å–xmlæ—¥å¿—é…ç½®&quot;">â€‹</a></h1><h2 id="ä¸€ã€æ ¸å¿ƒç›®æ ‡" tabindex="-1"><strong>ä¸€ã€æ ¸å¿ƒç›®æ ‡</strong> <a class="header-anchor" href="#ä¸€ã€æ ¸å¿ƒç›®æ ‡" aria-label="Permalink to &quot;**ä¸€ã€æ ¸å¿ƒç›®æ ‡**&quot;">â€‹</a></h2><p>åœ¨ Spring Boot / Spring Cloud Alibaba é¡¹ç›®ä¸­ï¼Œå°† <code>logback-spring.xml</code> æ—¥å¿—é…ç½®æ–‡ä»¶æ‰˜ç®¡åˆ° <strong>Nacos é…ç½®ä¸­å¿ƒ</strong>ï¼Œå®ç°ï¼š</p><ul><li><strong>æ—¥å¿—é…ç½®é›†ä¸­ç®¡ç†</strong></li><li><strong>æ— éœ€é‡å¯æœåŠ¡å³å¯åŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«ã€è¾“å‡ºè·¯å¾„ã€æ»šåŠ¨ç­–ç•¥ç­‰</strong></li></ul><h2 id="äºŒã€å®ç°åŸç†ä¸å…³é”®ç‚¹" tabindex="-1"><strong>äºŒã€å®ç°åŸç†ä¸å…³é”®ç‚¹</strong> <a class="header-anchor" href="#äºŒã€å®ç°åŸç†ä¸å…³é”®ç‚¹" aria-label="Permalink to &quot;**äºŒã€å®ç°åŸç†ä¸å…³é”®ç‚¹**&quot;">â€‹</a></h2><h3 id="_1-åŠ è½½é¡ºåºé—®é¢˜" tabindex="-1"><strong>1. åŠ è½½é¡ºåºé—®é¢˜</strong> <a class="header-anchor" href="#_1-åŠ è½½é¡ºåºé—®é¢˜" aria-label="Permalink to &quot;**1. åŠ è½½é¡ºåºé—®é¢˜**&quot;">â€‹</a></h3><ul><li><strong><code>logback.xml</code></strong>ï¼šç”± Logback æ¡†æ¶ç›´æ¥åŠ è½½ï¼Œ<strong>æ—©äº Spring å®¹å™¨åˆå§‹åŒ–</strong>ï¼Œæ— æ³•è¯»å– Spring æˆ– Nacos é…ç½®ã€‚</li><li><strong><code>logback-spring.xml</code></strong>ï¼šç”± Spring Boot åœ¨åˆå§‹åŒ– LoggingSystem æ—¶åŠ è½½ï¼Œ<strong>æ™šäº application.yml</strong>ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ <code>&lt;springProperty&gt;</code> è¯»å– Spring ç¯å¢ƒå˜é‡ï¼ˆåŒ…æ‹¬æ¥è‡ª Nacos çš„é…ç½®ï¼‰ã€‚</li></ul><blockquote><p>âœ… <strong>ç»“è®º</strong>ï¼šå¿…é¡»ä½¿ç”¨ <code>logback-spring.xml</code>ï¼ˆæˆ–è‡ªå®šä¹‰åç§° + æ˜¾å¼æŒ‡å®šï¼‰æ‰èƒ½æ”¯æŒåŠ¨æ€é…ç½®ã€‚</p></blockquote><hr><h3 id="_2-nacos-é…ç½®åˆ·æ–°æœºåˆ¶" tabindex="-1"><strong>2. Nacos é…ç½®åˆ·æ–°æœºåˆ¶</strong> <a class="header-anchor" href="#_2-nacos-é…ç½®åˆ·æ–°æœºåˆ¶" aria-label="Permalink to &quot;**2. Nacos é…ç½®åˆ·æ–°æœºåˆ¶**&quot;">â€‹</a></h3><ul><li>å½“ Nacos ä¸­çš„é…ç½®å˜æ›´å¹¶å‘å¸ƒåï¼ŒSpring Cloud Alibaba ä¼šè§¦å‘ <code>RefreshEvent</code>ã€‚</li><li>æ­¤æ—¶ <code>PropertySourceBootstrapConfiguration</code> ä¼š <strong>é‡æ–°åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿ</strong>ï¼ˆè°ƒç”¨ <code>reinitializeLoggingSystem</code>ï¼‰ã€‚</li><li><strong>é—®é¢˜</strong>ï¼šå¦‚æœä»…åœ¨æœ¬åœ° <code>application.yml</code> ä¸­é€šè¿‡ <code>logging.config=classpath:xxx.xml</code> æŒ‡å®šäº†æ—¥å¿—æ–‡ä»¶ï¼Œ<strong>åˆ·æ–°æ—¶è¯¥é…ç½®å¯èƒ½ä¸¢å¤±æˆ–è¢«è¦†ç›–</strong>ï¼Œå¯¼è‡´æ—¥å¿—åœæ­¢è¾“å‡ºã€‚</li></ul><blockquote><p>âš ï¸ <strong>å…³é”®å‘ç‚¹</strong>ï¼šå¿…é¡»ç¡®ä¿ <strong>æ—¥å¿—é…ç½®æœ¬èº«ä¹Ÿæ¥è‡ª Nacos</strong>ï¼Œæ‰èƒ½åœ¨åˆ·æ–°æ—¶è¢«æ­£ç¡®é‡æ–°åŠ è½½ã€‚</p></blockquote><hr><h2 id="ä¸‰ã€æ ‡å‡†é…ç½®æ­¥éª¤" tabindex="-1"><strong>ä¸‰ã€æ ‡å‡†é…ç½®æ­¥éª¤</strong> <a class="header-anchor" href="#ä¸‰ã€æ ‡å‡†é…ç½®æ­¥éª¤" aria-label="Permalink to &quot;**ä¸‰ã€æ ‡å‡†é…ç½®æ­¥éª¤**&quot;">â€‹</a></h2><h3 id="æ­¥éª¤-1-åœ¨-nacos-ä¸­åˆ›å»ºä¸¤ä¸ªé…ç½®" tabindex="-1"><strong>æ­¥éª¤ 1ï¼šåœ¨ Nacos ä¸­åˆ›å»ºä¸¤ä¸ªé…ç½®</strong> <a class="header-anchor" href="#æ­¥éª¤-1-åœ¨-nacos-ä¸­åˆ›å»ºä¸¤ä¸ªé…ç½®" aria-label="Permalink to &quot;**æ­¥éª¤ 1ï¼šåœ¨ Nacos ä¸­åˆ›å»ºä¸¤ä¸ªé…ç½®**&quot;">â€‹</a></h3><h4 id="_1-åº”ç”¨ä¸»é…ç½®-å¦‚-your-app-dev-yml" tabindex="-1"><strong>(1) åº”ç”¨ä¸»é…ç½®ï¼ˆå¦‚</strong> <code>your-app-dev.yml</code><strong>ï¼‰</strong> <a class="header-anchor" href="#_1-åº”ç”¨ä¸»é…ç½®-å¦‚-your-app-dev-yml" aria-label="Permalink to &quot;**(1) åº”ç”¨ä¸»é…ç½®ï¼ˆå¦‚** \`your-app-dev.yml\`**ï¼‰**&quot;">â€‹</a></h4><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your-app</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ... å…¶ä»–ä¸šåŠ¡é…ç½®</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ã€å…³é”®ã€‘æŒ‡å®šæ—¥å¿—é…ç½®æ–‡ä»¶æ¥æºä¸º Nacos ä¸Šçš„ logback-spring.xml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://\${spring.cloud.nacos.config.server-addr}/nacos/v1/cs/configs?group=DEFAULT_GROUP&amp;dataId=logback-spring.xml&amp;tenant=\${spring.cloud.nacos.config.namespace}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>ğŸ” <strong>è¯´æ˜</strong>ï¼šé€šè¿‡ HTTP URL ç›´æ¥æŒ‡å‘ Nacos ä¸­å­˜å‚¨çš„ XML å†…å®¹ã€‚</p></blockquote><h4 id="_2-æ—¥å¿—é…ç½®æ–‡ä»¶-data-id-logback-spring-xml-æ ¼å¼-text" tabindex="-1"><strong>(2) æ—¥å¿—é…ç½®æ–‡ä»¶ï¼ˆData ID:</strong> <code>logback-spring.xml</code><strong>ï¼Œæ ¼å¼ï¼šTEXTï¼‰</strong> <a class="header-anchor" href="#_2-æ—¥å¿—é…ç½®æ–‡ä»¶-data-id-logback-spring-xml-æ ¼å¼-text" aria-label="Permalink to &quot;**(2) æ—¥å¿—é…ç½®æ–‡ä»¶ï¼ˆData ID:** \`logback-spring.xml\`**ï¼Œæ ¼å¼ï¼šTEXTï¼‰**&quot;">â€‹</a></h4><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;?</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">xml</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UTF-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- ä» Spring ç¯å¢ƒï¼ˆå³ Nacos ä¸»é…ç½®ï¼‰ä¸­è¯»å–å˜é‡ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">springProperty</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;context&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LOG_PATH&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;logging.path&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defaultValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./logs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">springProperty</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;context&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;APP_NAME&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;spring.application.name&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defaultValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;app&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">appender</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;FILE&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;\${LOG_PATH}/\${APP_NAME}.log&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rollingPolicy</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">fileNamePattern</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;\${LOG_PATH}/\${APP_NAME}.%d{yyyy-MM-dd}.%i.log&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">fileNamePattern</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">maxFileSize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;10MB&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">maxFileSize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">maxHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;30&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">maxHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rollingPolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">encoder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">pattern</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">pattern</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">encoder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">appender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INFO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">appender-ref</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;FILE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="æ­¥éª¤-2-é¡¹ç›®é…ç½®-bootstrap-yml" tabindex="-1"><strong>æ­¥éª¤ 2ï¼šé¡¹ç›®é…ç½®ï¼ˆ</strong><code>bootstrap.yml</code><strong>ï¼‰</strong> <a class="header-anchor" href="#æ­¥éª¤-2-é¡¹ç›®é…ç½®-bootstrap-yml" aria-label="Permalink to &quot;**æ­¥éª¤ 2ï¼šé¡¹ç›®é…ç½®ï¼ˆ**\`bootstrap.yml\`**ï¼‰**&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your-app</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  cloud</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    nacos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      discovery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        server-addr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">localhost:8848</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your-namespace-id</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # å¯é€‰</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        server-addr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">localhost:8848</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your-namespace-id</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        file-extension</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yml</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # ç¡®ä¿ä¸»é…ç½®èƒ½è¢«åŠ è½½</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DEFAULT_GROUP</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><blockquote><p>ğŸ’¡ <strong>æ³¨æ„</strong>ï¼š<code>logging.config</code> çš„é…ç½®å¿…é¡»æ”¾åœ¨ <strong>Nacos çš„ä¸»é…ç½®æ–‡ä»¶ä¸­</strong>ï¼Œè€Œä¸æ˜¯æœ¬åœ° <code>bootstrap.yml</code>ï¼Œå¦åˆ™åˆ·æ–°æ—¶ä¼šå¤±æ•ˆã€‚</p></blockquote><hr><h2 id="å››ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" tabindex="-1"><strong>å››ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</strong> <a class="header-anchor" href="#å››ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to &quot;**å››ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ**&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">é—®é¢˜ç°è±¡</th><th style="text-align:left;">åŸå› </th><th style="text-align:left;">è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td style="text-align:left;">ä¿®æ”¹ Nacos é…ç½®åï¼Œæ—¥å¿—ä¸å†è¾“å‡º</td><td style="text-align:left;">Spring Cloud åˆ·æ–°æ—¥å¿—ä¸Šä¸‹æ–‡æ—¶ï¼Œæœªé‡æ–°åŠ è½½æ­£ç¡®çš„ logback é…ç½®</td><td style="text-align:left;"><strong>å°† <code>logging.config</code> é…ç½®é¡¹ä¹Ÿæ”¾å…¥ Nacos ä¸»é…ç½®ä¸­</strong>ï¼Œç¡®ä¿åˆ·æ–°æ—¶èƒ½é‡æ–°è·å–æ—¥å¿—æ–‡ä»¶ä½ç½®</td></tr><tr><td style="text-align:left;">å¯åŠ¨æ—¶æŠ¥ â€œContext has been already given a nameâ€ è­¦å‘Š</td><td style="text-align:left;">Nacos å®¢æˆ·ç«¯è‡ªèº«ä½¿ç”¨äº† Logbackï¼Œå¹¶è®¾ç½®äº† <code>contextName</code></td><td style="text-align:left;">åœ¨ <code>logback-spring.xml</code> ä¸­æ˜¾å¼è®¾ç½® <code>nacos</code> é¿å…å†²çª</td></tr><tr><td style="text-align:left;"><code>&lt;springProperty&gt;</code> æ— æ³•è¯»å– Nacos ä¸­çš„å€¼</td><td style="text-align:left;">é…ç½®é¡¹æœªæ­£ç¡®åŠ è½½åˆ° Spring Environment</td><td style="text-align:left;">ç¡®ä¿ Nacos é…ç½® Data ID å’Œ Group æ­£ç¡®ï¼Œå¹¶åœ¨ <code>bootstrap.yml</code> ä¸­æ­£ç¡®å¼•ç”¨</td></tr></tbody></table><h2 id="äº”ã€é«˜çº§æŠ€å·§-å¯é€‰" tabindex="-1"><strong>äº”ã€é«˜çº§æŠ€å·§ï¼ˆå¯é€‰ï¼‰</strong> <a class="header-anchor" href="#äº”ã€é«˜çº§æŠ€å·§-å¯é€‰" aria-label="Permalink to &quot;**äº”ã€é«˜çº§æŠ€å·§ï¼ˆå¯é€‰ï¼‰**&quot;">â€‹</a></h2><h3 id="æ–¹æ¡ˆ-a-ç›‘å¬-nacos-é…ç½®å˜åŒ–-æ‰‹åŠ¨åˆ·æ–°-logger" tabindex="-1"><strong>æ–¹æ¡ˆ Aï¼šç›‘å¬ Nacos é…ç½®å˜åŒ–ï¼Œæ‰‹åŠ¨åˆ·æ–° Logger</strong> <a class="header-anchor" href="#æ–¹æ¡ˆ-a-ç›‘å¬-nacos-é…ç½®å˜åŒ–-æ‰‹åŠ¨åˆ·æ–°-logger" aria-label="Permalink to &quot;**æ–¹æ¡ˆ Aï¼šç›‘å¬ Nacos é…ç½®å˜åŒ–ï¼Œæ‰‹åŠ¨åˆ·æ–° Logger**&quot;">â€‹</a></h3><p>é€‚ç”¨äºéœ€è¦æ›´ç²¾ç»†æ§åˆ¶çš„åœºæ™¯ï¼ˆå¦‚åªæ”¹æ—¥å¿—çº§åˆ«ï¼‰ï¼š</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Component</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LogbackConfigListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NacosConfigListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dataId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;logback-config.yml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onLogbackConfigChange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(String </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Yaml yaml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Map&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> yaml.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">load</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        String level </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (String) ((Map) map.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;logging&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;level&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        LoggerContext context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (LoggerContext) LoggerFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getILoggerFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Logger root </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getLogger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Logger.ROOT_LOGGER_NAME);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        root.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Level.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">valueOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(level));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="æ–¹æ¡ˆ-b-æœ¬åœ°-fallback-é…ç½®" tabindex="-1"><strong>æ–¹æ¡ˆ Bï¼šæœ¬åœ° fallback é…ç½®</strong> <a class="header-anchor" href="#æ–¹æ¡ˆ-b-æœ¬åœ°-fallback-é…ç½®" aria-label="Permalink to &quot;**æ–¹æ¡ˆ Bï¼šæœ¬åœ° fallback é…ç½®**&quot;">â€‹</a></h3><p>åœ¨ <code>src/main/resources</code> æ”¾ä¸€ä¸ª <code>logback-local.xml</code> ä½œä¸ºå¼€å‘æ—¶é»˜è®¤é…ç½®ï¼Œé¿å… Nacos ä¸å¯ç”¨æ—¶å¯åŠ¨å¤±è´¥ã€‚</p><hr><h2 id="å…­ã€æ€»ç»“" tabindex="-1"><strong>å…­ã€æ€»ç»“</strong> <a class="header-anchor" href="#å…­ã€æ€»ç»“" aria-label="Permalink to &quot;**å…­ã€æ€»ç»“**&quot;">â€‹</a></h2><p>è¦å®ç° <strong>Nacos åŠ¨æ€è¯»å– XML æ—¥å¿—é…ç½®</strong>ï¼Œæ ¸å¿ƒåœ¨äºï¼š</p><ol><li><strong>ä½¿ç”¨ <code>logback-spring.xml</code></strong>ï¼ˆè€Œé <code>logback.xml</code>ï¼‰</li><li><strong>å°† <code>logging.config</code> é…ç½®é¡¹æœ¬èº«æ”¾åœ¨ Nacos ä¸­</strong>ï¼Œå¹¶é€šè¿‡ HTTP URL æŒ‡å‘ Nacos ä¸Šçš„ XML å†…å®¹</li><li><strong>åœ¨ XML ä¸­é€šè¿‡ \`\` å¼•ç”¨ Nacos ä¸­çš„å˜é‡</strong></li><li><strong>è§„é¿ Spring Cloud åˆ·æ–°æ—¥å¿—ä¸Šä¸‹æ–‡æ—¶çš„é…ç½®è¦†ç›–é—®é¢˜</strong></li></ol><blockquote><p>âœ… æŒ‰æ­¤æ–¹å¼é…ç½®ï¼Œå³å¯å®ç° <strong>æ—¥å¿—çº§åˆ«ã€è·¯å¾„ã€æ ¼å¼ç­‰å‚æ•°çš„å®æ—¶çƒ­æ›´æ–°</strong>ï¼Œå¤§å¹…æå‡è¿ç»´æ•ˆç‡ã€‚</p></blockquote><h2 id="å‚è€ƒèµ„æ–™" tabindex="-1">å‚è€ƒèµ„æ–™ <a class="header-anchor" href="#å‚è€ƒèµ„æ–™" aria-label="Permalink to &quot;å‚è€ƒèµ„æ–™&quot;">â€‹</a></h2><p><a href="https://blog.csdn.net/qq_35429398/article/details/131516382" target="_blank" rel="noreferrer">https://blog.csdn.net/qq_35429398/article/details/131516382</a></p><p><a href="https://www.cnblogs.com/gaomanito/p/14755232.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/gaomanito/p/14755232.html</a></p><p><a href="https://blog.csdn.net/qq_39313596/article/details/131011629" target="_blank" rel="noreferrer">https://blog.csdn.net/qq_39313596/article/details/131011629</a></p>`,42)])])}const d=i(t,[["render",e]]);export{E as __pageData,d as default};
