import{_ as s,c as i,o as a,aN as e}from"./chunks/framework.CMIDsdwV.js";const y=JSON.parse('{"title":"Python数据分析—清理数据","description":"","frontmatter":{"title":"Python数据分析—清理数据","tags":["Python"],"categories":["Python"]},"headers":[],"relativePath":"Python/数据分析/9_Python数据分析—清理数据.md","filePath":"Python/数据分析/9_Python数据分析—清理数据.md","lastUpdated":1767444225000}'),l={name:"Python/数据分析/9_Python数据分析—清理数据.md"};function n(d,t,h,p,r,k){return a(),i("div",null,[...t[0]||(t[0]=[e(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /Python\\数据分析\\9_Python数据分析—清理数据.md for this page in Markdown format</div><h1 id="python数据分析—清理数据" tabindex="-1">Python数据分析—清理数据 <a class="header-anchor" href="#python数据分析—清理数据" aria-label="Permalink to &quot;Python数据分析—清理数据&quot;">​</a></h1><h2 id="一、清理数据注意事项" tabindex="-1">一、清理数据注意事项 <a class="header-anchor" href="#一、清理数据注意事项" aria-label="Permalink to &quot;一、清理数据注意事项&quot;">​</a></h2><p>在评估之后，下一步是根据评估结果，对数据进行清洗。</p><h3 id="一-、清洗数据之前" tabindex="-1">（一）、清洗数据之前 <a class="header-anchor" href="#一-、清洗数据之前" aria-label="Permalink to &quot;（一）、清洗数据之前&quot;">​</a></h3><p>在清洗数据之前，我们要先看看索引或列名是否有意义。</p><p>如果索引或列名都是乱七八糟的，应该对它们进行重命名，或重新排序，以便我们理解数据。</p><h3 id="二-、结构性问题" tabindex="-1">（二）、结构性问题 <a class="header-anchor" href="#二-、结构性问题" aria-label="Permalink to &quot;（二）、结构性问题&quot;">​</a></h3><p>清洗数据，我们一般会先解决结构性问题，再处理内容性问题。</p><p>整洁数据，根据埃德加科德的第三范式，包括以下三个特点：</p><ol><li>每列是一个变量</li><li>每行是一个观察值</li><li>每个单元格是一个值</li></ol><p>任何不符合以上三个特点的数据都是乱数据。</p><h4 id="_1、每列是观察值-每行是变量" tabindex="-1">1、每列是观察值，每行是变量 <a class="header-anchor" href="#_1、每列是观察值-每行是变量" aria-label="Permalink to &quot;1、每列是观察值，每行是变量&quot;">​</a></h4><p>对行和列进行转置</p><h4 id="_2、每列包含多个变量" tabindex="-1">2、每列包含多个变量 <a class="header-anchor" href="#_2、每列包含多个变量" aria-label="Permalink to &quot;2、每列包含多个变量&quot;">​</a></h4><ul><li>对列进行拆分，把多的变量分到其它列去</li><li>有的时候光拆分还不够，还要进行重塑，确保每列只包含一种变量</li></ul><p>比如：许多列同时包含两个或多个变量的时候</p><h4 id="_3、每行包含多个观察值" tabindex="-1">3、每行包含多个观察值 <a class="header-anchor" href="#_3、每行包含多个观察值" aria-label="Permalink to &quot;3、每行包含多个观察值&quot;">​</a></h4><ul><li>对行进行拆分，让每个观察值为独立的一行</li><li>有的时候光拆分还不够，还要进行重塑，确保每列只包含一种观察值</li></ul><p>比如：许多行同时包含两个或多个观察值的时候</p><p>很多时候，清理前的数据是宽数据，清理后的数据是长数据。</p><p>我们清理的目的，是为了后续能更高效地用程序处理数据，而不是更方便地让人类理解，所以清理前的宽数据更直观易懂也是正常的。</p><h3 id="三-、内容性问题" tabindex="-1">（三）、内容性问题 <a class="header-anchor" href="#三-、内容性问题" aria-label="Permalink to &quot;（三）、内容性问题&quot;">​</a></h3><p>在确保结构不存在问题后，我们再去深入到内容，处理脏数据。</p><h4 id="_1、缺失数据" tabindex="-1">1、缺失数据 <a class="header-anchor" href="#_1、缺失数据" aria-label="Permalink to &quot;1、缺失数据&quot;">​</a></h4><p>针对缺失数据，处理方式需要具体情况具体分析。</p><ul><li>如果恰好知道空缺值的实际值，可以更新表格数据，人工把那个值填进去。</li><li>如果我们不知道空缺值的实际值，而缺失值并不影响此次分析，最直接的办法是不处理缺失值。</li></ul><p>Pandas在计算的时候，会自动忽略缺失值，所以很多时候放着不管不会造成什么问题。</p><ul><li>如果是关键变量缺失，我们可以把变量为空缺的行删掉，只留下对分析结果有意义的数据。</li><li>如果是关键变量缺失，我们也可以用填充值的方式去处理，比如说把平均数、中位数、众数等填充进去，来代替空缺值</li></ul><h4 id="_2、重复数据" tabindex="-1">2、重复数据 <a class="header-anchor" href="#_2、重复数据" aria-label="Permalink to &quot;2、重复数据&quot;">​</a></h4><p>针对重复数据，我们的处理方式就很简单了。</p><p>找到后删除即可，不删除的话，重复数据可能影响分析结论</p><h4 id="_3、不一致数据" tabindex="-1">3、不一致数据 <a class="header-anchor" href="#_3、不一致数据" aria-label="Permalink to &quot;3、不一致数据&quot;">​</a></h4><p>针对不一致数据，我们的目标是对它们进行统一。针对同一含义，只保留一种表达方式，把其余的都进行替换</p><h4 id="_4、无效-错误数据" tabindex="-1">4、无效/错误数据 <a class="header-anchor" href="#_4、无效-错误数据" aria-label="Permalink to &quot;4、无效/错误数据&quot;">​</a></h4><p>针对无效/错误数据，也有不同的清洗途径。</p><p>比如删除/替换，否则留下无效/错误数据，也可能影响分析结论。比如说一个负数的身高记录值，可以严重拉低平均值的分析。</p><ol><li>把那条记录值进行删除。因为Pandas会自动忽略空缺值，所以NaN值反而不影响平均值计算</li><li>替换成其他值。比如说平均数。</li></ol><h3 id="四-、其他问题" tabindex="-1">（四）、其他问题 <a class="header-anchor" href="#四-、其他问题" aria-label="Permalink to &quot;（四）、其他问题&quot;">​</a></h3><p>除了数据本身的问题以外，我们清理数据时，有时候还要针对编程语言或库，做一些其他的处理，包括对数据类型进行转换。</p><p>比如：把手机号从数字类型转换成字符串类型；把&#39;是&#39;和&#39;否&#39;转换成布尔值True和False，能让我们之后针对这个变量的分析更加方便，包括能更简洁地进行逻辑判断</p><h2 id="二、清理索引和列名" tabindex="-1">二、清理索引和列名 <a class="header-anchor" href="#二、清理索引和列名" aria-label="Permalink to &quot;二、清理索引和列名&quot;">​</a></h2><h3 id="一-、-重命名索引和列名-使用字典" tabindex="-1">（一）、 重命名索引和列名(使用字典) <a class="header-anchor" href="#一-、-重命名索引和列名-使用字典" aria-label="Permalink to &quot;（一）、 重命名索引和列名(使用字典)&quot;">​</a></h3><p>DataFrame的<code>rename</code>方法，<code>rename</code>方法会返回一个新的DataFrame</p><p>适用于列名或索引数量少的情况</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;example1.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index_col</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户_姓名</strong></th><th style="text-align:left;"><strong>客户 性别</strong></th><th style="text-align:left;"><strong>age</strong></th><th style="text-align:left;"><strong>邮箱</strong></th></tr></thead><tbody><tr><td><strong>1</strong></td><td style="text-align:left;">李十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:yVaQXekW@example.com" target="_blank" rel="noreferrer">yVaQXekW@example.com</a></td></tr><tr><td><strong>2_</strong></td><td style="text-align:left;">冯三</td><td style="text-align:left;">男</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:LctXbrEM@example.com" target="_blank" rel="noreferrer">LctXbrEM@example.com</a></td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">吴十</td><td style="text-align:left;">男</td><td style="text-align:left;">32</td><td style="text-align:left;"><a href="mailto:UyTYBzUZ@example.com" target="_blank" rel="noreferrer">UyTYBzUZ@example.com</a></td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">王十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:KCixgciF@example.com" target="_blank" rel="noreferrer">KCixgciF@example.com</a></td></tr><tr><td><strong>_5</strong></td><td style="text-align:left;">钱十</td><td style="text-align:left;">女</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:nqRBXOtA@example.com" target="_blank" rel="noreferrer">nqRBXOtA@example.com</a></td></tr><tr><td><strong>6</strong>*</td><td style="text-align:left;">赵八</td><td style="text-align:left;">女</td><td style="text-align:left;">51</td><td style="text-align:left;"><a href="mailto:GyKwILAL@example.com" target="_blank" rel="noreferrer">GyKwILAL@example.com</a></td></tr></tbody></table><h4 id="_1、重命名索引" tabindex="-1">1、重命名索引 <a class="header-anchor" href="#_1、重命名索引" aria-label="Permalink to &quot;1、重命名索引&quot;">​</a></h4><p>放入可选参数index，并赋值为一个字典。</p><p>字典中，把需要修改的老的名字作为键，把对应的新的名字作为值。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df1.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2_&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_5&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;5&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;6*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;6&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户_姓名</strong></th><th style="text-align:left;"><strong>客户 性别</strong></th><th style="text-align:left;"><strong>age</strong></th><th style="text-align:left;"><strong>邮箱</strong></th></tr></thead><tbody><tr><td><strong>1</strong></td><td style="text-align:left;">李十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:yVaQXekW@example.com" target="_blank" rel="noreferrer">yVaQXekW@example.com</a></td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">冯三</td><td style="text-align:left;">男</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:LctXbrEM@example.com" target="_blank" rel="noreferrer">LctXbrEM@example.com</a></td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">吴十</td><td style="text-align:left;">男</td><td style="text-align:left;">32</td><td style="text-align:left;"><a href="mailto:UyTYBzUZ@example.com" target="_blank" rel="noreferrer">UyTYBzUZ@example.com</a></td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">王十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:KCixgciF@example.com" target="_blank" rel="noreferrer">KCixgciF@example.com</a></td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">钱十</td><td style="text-align:left;">女</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:nqRBXOtA@example.com" target="_blank" rel="noreferrer">nqRBXOtA@example.com</a></td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">赵八</td><td style="text-align:left;">女</td><td style="text-align:left;">51</td><td style="text-align:left;"><a href="mailto:GyKwILAL@example.com" target="_blank" rel="noreferrer">GyKwILAL@example.com</a></td></tr></tbody></table><h4 id="_2、重命名列名" tabindex="-1">2、重命名列名 <a class="header-anchor" href="#_2、重命名列名" aria-label="Permalink to &quot;2、重命名列名&quot;">​</a></h4><p>放入可选参数columns，并赋值为一个字典</p><p>字典中，把需要修改的老的名字作为键，把对应的新的名字作为值。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df1.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户_姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户 性别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户性别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;age&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户年龄&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;邮箱&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;客户邮箱&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户姓名</strong></th><th style="text-align:left;"><strong>客户性别</strong></th><th style="text-align:left;"><strong>客户年龄</strong></th><th style="text-align:left;"><strong>客户邮箱</strong></th></tr></thead><tbody><tr><td><strong>1</strong></td><td style="text-align:left;">李十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:yVaQXekW@example.com" target="_blank" rel="noreferrer">yVaQXekW@example.com</a></td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">冯三</td><td style="text-align:left;">男</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:LctXbrEM@example.com" target="_blank" rel="noreferrer">LctXbrEM@example.com</a></td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">吴十</td><td style="text-align:left;">男</td><td style="text-align:left;">32</td><td style="text-align:left;"><a href="mailto:UyTYBzUZ@example.com" target="_blank" rel="noreferrer">UyTYBzUZ@example.com</a></td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">王十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:KCixgciF@example.com" target="_blank" rel="noreferrer">KCixgciF@example.com</a></td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">钱十</td><td style="text-align:left;">女</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:nqRBXOtA@example.com" target="_blank" rel="noreferrer">nqRBXOtA@example.com</a></td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">赵八</td><td style="text-align:left;">女</td><td style="text-align:left;">51</td><td style="text-align:left;"><a href="mailto:GyKwILAL@example.com" target="_blank" rel="noreferrer">GyKwILAL@example.com</a></td></tr></tbody></table><h3 id="二-、重命名索引和列名-函数-方法" tabindex="-1">（二）、重命名索引和列名(函数/方法) <a class="header-anchor" href="#二-、重命名索引和列名-函数-方法" aria-label="Permalink to &quot;（二）、重命名索引和列名(函数/方法)&quot;">​</a></h3><p>rename方法，除了传入字典，还可以传入一个针对Series的函数或方法，可以是Pandas库里面的，也可以是我们自行定义的</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">函数</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">方法)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">函数</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">方法)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这个函数/方法会把原本索引或列名作为参数，然后返回新的名字。</p><p>举个例子:</p><h4 id="_1、把所有列名变成大写" tabindex="-1">1、把所有列名变成大写 <a class="header-anchor" href="#_1、把所有列名变成大写" aria-label="Permalink to &quot;1、把所有列名变成大写&quot;">​</a></h4><p>可以给columns这个可选参数，传入str.upper方法</p><p>str是Series类自带的一个属性，会返回一个包含了很多字符串相关操作方法的,StringMethods类的实例(返回实例才可以调用方法)，对这个StringMethods实例调用upper方法，就会把Series里所有字符变成大写。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.Series([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hello&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;this&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;is&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Zheng&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    hello</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     this</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       is</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Zheng</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.str</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pandas.core.strings.accessor.StringMethods at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e6708d9710</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.str.upper()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    HELLO</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     THIS</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       IS</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    ZHENG</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>作为columns参数的值，传给rename，执行后就会返回一个列名全变成了大写的DataFrame</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;example2.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>Date</strong></th><th style="text-align:left;"><strong>Amount</strong></th><th style="text-align:left;"><strong>Salesperson</strong></th><th style="text-align:left;"><strong>Location</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">2022-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">Alice</td><td style="text-align:left;">New York</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2022-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">Bob</td><td style="text-align:left;">San Francisco</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2022-01-03</td><td style="text-align:left;">800</td><td style="text-align:left;">Charlie</td><td style="text-align:left;">New York</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">2022-01-04</td><td style="text-align:left;">1200</td><td style="text-align:left;">David</td><td style="text-align:left;">San Francisco</td></tr></tbody></table><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.upper)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>DATE</strong></th><th style="text-align:left;"><strong>AMOUNT</strong></th><th style="text-align:left;"><strong>SALESPERSON</strong></th><th style="text-align:left;"><strong>LOCATION</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">2022-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">Alice</td><td style="text-align:left;">New York</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2022-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">Bob</td><td style="text-align:left;">San Francisco</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">2022-01-03</td><td style="text-align:left;">800</td><td style="text-align:left;">Charlie</td><td style="text-align:left;">New York</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">2022-01-04</td><td style="text-align:left;">1200</td><td style="text-align:left;">David</td><td style="text-align:left;">San Francisco</td></tr></tbody></table><h4 id="_2、其他操作" tabindex="-1">2、其他操作 <a class="header-anchor" href="#_2、其他操作" aria-label="Permalink to &quot;2、其他操作&quot;">​</a></h4><ol><li>如果想了解其它对字符串Series调用的方法，可以查看Pandas官方文档</li></ol><p>像这些所有以<code>pandas.Series.str</code>开头的，都是可以用在<code>Pandas Series</code>上的字符串操作</p><p>所有Series的方法相关文档：</p><p><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html" target="_blank" rel="noreferrer">https://pandas.pydata.org/docs/reference/api/pandas.Series.html</a></p><ol start="2"><li>所有DataFrame的方法相关文档：</li></ol><p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html" target="_blank" rel="noreferrer">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html</a></p><ol start="3"><li>Pandas 官万文档: <a href="https://pandas.pydata.org/docs/reference" target="_blank" rel="noreferrer">https://pandas.pydata.org/docs/reference</a></li></ol><p>里面有所有 Pandas 库里面的类、类方法、类属性介绍等等。包括Series、DataFrame等</p><h3 id="三-、设置索引" tabindex="-1">（三）、设置索引 <a class="header-anchor" href="#三-、设置索引" aria-label="Permalink to &quot;（三）、设置索引&quot;">​</a></h3><h4 id="_1、把某列设为索引" tabindex="-1">1、把某列设为索引 <a class="header-anchor" href="#_1、把某列设为索引" aria-label="Permalink to &quot;1、把某列设为索引&quot;">​</a></h4><p>set_index方法，可以直接把某列属性的值用来作为索引，里面直接传入列名，会返回一个新的DataFrame，其索引变成了那列的值</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df2.set_index(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Salesperson&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th><strong>Date</strong></th><th><strong>Amount</strong></th><th><strong>Location</strong></th></tr></thead><tbody><tr><td><strong>Salesperson</strong></td><td></td><td></td><td></td></tr><tr><td><strong>Alice</strong></td><td>2022-01-01</td><td>1000</td><td>New York</td></tr><tr><td><strong>Bob</strong></td><td>2022-01-02</td><td>1500</td><td>San Francisco</td></tr><tr><td><strong>Charlie</strong></td><td>2022-01-03</td><td>800</td><td>New York</td></tr><tr><td><strong>David</strong></td><td>2022-01-04</td><td>1200</td><td>San Francisco</td></tr></tbody></table><h4 id="_2、重置索引" tabindex="-1">2、重置索引 <a class="header-anchor" href="#_2、重置索引" aria-label="Permalink to &quot;2、重置索引&quot;">​</a></h4><p>reset_index方法，相当于做的和set_index相反的事，即把索引重设为初始默认的位置索引，并且把原本作为index的值变成单独一列</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3.reset_index()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>Salesperson</strong></th><th style="text-align:left;"><strong>Date</strong></th><th style="text-align:left;"><strong>Amount</strong></th><th style="text-align:left;"><strong>Location</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">2022-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">New York</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">2022-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">San Francisco</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Charlie</td><td style="text-align:left;">2022-01-03</td><td style="text-align:left;">800</td><td style="text-align:left;">New York</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">David</td><td style="text-align:left;">2022-01-04</td><td style="text-align:left;">1200</td><td style="text-align:left;">San Francisco</td></tr></tbody></table><h3 id="四-、对索引和列名重新排序" tabindex="-1">（四）、对索引和列名重新排序 <a class="header-anchor" href="#四-、对索引和列名重新排序" aria-label="Permalink to &quot;（四）、对索引和列名重新排序&quot;">​</a></h3><p>sort_index方法，适用于数据的索引或列名符合要求，但它的顺序是乱的情况</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;example3.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index_col</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户姓名</strong></th><th style="text-align:left;"><strong>客户性别</strong></th><th style="text-align:left;"><strong>客户年龄</strong></th><th style="text-align:left;"><strong>客户邮箱</strong></th></tr></thead><tbody><tr><td><strong>a</strong></td><td style="text-align:left;">李十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:yVaQXekW@example.com" target="_blank" rel="noreferrer">yVaQXekW@example.com</a></td></tr><tr><td><strong>c</strong></td><td style="text-align:left;">冯三</td><td style="text-align:left;">男</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:LctXbrEM@example.com" target="_blank" rel="noreferrer">LctXbrEM@example.com</a></td></tr><tr><td><strong>b</strong></td><td style="text-align:left;">吴十</td><td style="text-align:left;">男</td><td style="text-align:left;">32</td><td style="text-align:left;"><a href="mailto:UyTYBzUZ@example.com" target="_blank" rel="noreferrer">UyTYBzUZ@example.com</a></td></tr><tr><td><strong>e</strong></td><td style="text-align:left;">王十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:KCixgciF@example.com" target="_blank" rel="noreferrer">KCixgciF@example.com</a></td></tr><tr><td><strong>d</strong></td><td style="text-align:left;">钱十</td><td style="text-align:left;">女</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:nqRBXOtA@example.com" target="_blank" rel="noreferrer">nqRBXOtA@example.com</a></td></tr><tr><td><strong>f</strong></td><td style="text-align:left;">赵八</td><td style="text-align:left;">女</td><td style="text-align:left;">51</td><td style="text-align:left;"><a href="mailto:GyKwILAL@example.com" target="_blank" rel="noreferrer">GyKwILAL@example.com</a></td></tr></tbody></table><h4 id="_1、对索引进行排序" tabindex="-1">1、对索引进行排序 <a class="header-anchor" href="#_1、对索引进行排序" aria-label="Permalink to &quot;1、对索引进行排序&quot;">​</a></h4><p>默认axis=0,沿着索引纵向操作，对索引排序</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df4.sort_index()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户姓名</strong></th><th style="text-align:left;"><strong>客户性别</strong></th><th style="text-align:left;"><strong>客户年龄</strong></th><th style="text-align:left;"><strong>客户邮箱</strong></th></tr></thead><tbody><tr><td><strong>a</strong></td><td style="text-align:left;">李十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:yVaQXekW@example.com" target="_blank" rel="noreferrer">yVaQXekW@example.com</a></td></tr><tr><td><strong>b</strong></td><td style="text-align:left;">吴十</td><td style="text-align:left;">男</td><td style="text-align:left;">32</td><td style="text-align:left;"><a href="mailto:UyTYBzUZ@example.com" target="_blank" rel="noreferrer">UyTYBzUZ@example.com</a></td></tr><tr><td><strong>c</strong></td><td style="text-align:left;">冯三</td><td style="text-align:left;">男</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:LctXbrEM@example.com" target="_blank" rel="noreferrer">LctXbrEM@example.com</a></td></tr><tr><td><strong>d</strong></td><td style="text-align:left;">钱十</td><td style="text-align:left;">女</td><td style="text-align:left;">27</td><td style="text-align:left;"><a href="mailto:nqRBXOtA@example.com" target="_blank" rel="noreferrer">nqRBXOtA@example.com</a></td></tr><tr><td><strong>e</strong></td><td style="text-align:left;">王十</td><td style="text-align:left;">女</td><td style="text-align:left;">58</td><td style="text-align:left;"><a href="mailto:KCixgciF@example.com" target="_blank" rel="noreferrer">KCixgciF@example.com</a></td></tr><tr><td><strong>f</strong></td><td style="text-align:left;">赵八</td><td style="text-align:left;">女</td><td style="text-align:left;">51</td><td style="text-align:left;"><a href="mailto:GyKwILAL@example.com" target="_blank" rel="noreferrer">GyKwILAL@example.com</a></td></tr></tbody></table><h4 id="_2、对列名进行排序" tabindex="-1">2、对列名进行排序 <a class="header-anchor" href="#_2、对列名进行排序" aria-label="Permalink to &quot;2、对列名进行排序&quot;">​</a></h4><p>指定axis=1,沿着列名纵向操作，对列名排序</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4.sort_index(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>客户姓名</strong></th><th style="text-align:left;"><strong>客户年龄</strong></th><th style="text-align:left;"><strong>客户性别</strong></th><th style="text-align:left;"><strong>客户邮箱</strong></th></tr></thead><tbody><tr><td><strong>a</strong></td><td style="text-align:left;">李十</td><td style="text-align:left;">58</td><td style="text-align:left;">女</td><td style="text-align:left;"><a href="mailto:yVaQXekW@example.com" target="_blank" rel="noreferrer">yVaQXekW@example.com</a></td></tr><tr><td><strong>b</strong></td><td style="text-align:left;">吴十</td><td style="text-align:left;">32</td><td style="text-align:left;">男</td><td style="text-align:left;"><a href="mailto:UyTYBzUZ@example.com" target="_blank" rel="noreferrer">UyTYBzUZ@example.com</a></td></tr><tr><td><strong>c</strong></td><td style="text-align:left;">冯三</td><td style="text-align:left;">27</td><td style="text-align:left;">男</td><td style="text-align:left;"><a href="mailto:LctXbrEM@example.com" target="_blank" rel="noreferrer">LctXbrEM@example.com</a></td></tr><tr><td><strong>d</strong></td><td style="text-align:left;">钱十</td><td style="text-align:left;">27</td><td style="text-align:left;">女</td><td style="text-align:left;"><a href="mailto:nqRBXOtA@example.com" target="_blank" rel="noreferrer">nqRBXOtA@example.com</a></td></tr><tr><td><strong>e</strong></td><td style="text-align:left;">王十</td><td style="text-align:left;">58</td><td style="text-align:left;">女</td><td style="text-align:left;"><a href="mailto:KCixgciF@example.com" target="_blank" rel="noreferrer">KCixgciF@example.com</a></td></tr><tr><td><strong>f</strong></td><td style="text-align:left;">赵八</td><td style="text-align:left;">51</td><td style="text-align:left;">女</td><td style="text-align:left;"><a href="mailto:GyKwILAL@example.com" target="_blank" rel="noreferrer">GyKwILAL@example.com</a></td></tr></tbody></table><h3 id="五-、可选参数inplace" tabindex="-1">（五）、可选参数inplace <a class="header-anchor" href="#五-、可选参数inplace" aria-label="Permalink to &quot;（五）、可选参数inplace&quot;">​</a></h3><p>适用于rename、set_index、reset_index、sort_index方法</p><p>传入&#39;inplace=True&#39;，表示直接原地修改原始DataFrame，就不用进行赋值了；</p><p>并且此时方法不返回新的DataFrame，如果赋值给变量，则变量变为空值。</p><h2 id="三、清理乱数据" tabindex="-1">三、清理乱数据 <a class="header-anchor" href="#三、清理乱数据" aria-label="Permalink to &quot;三、清理乱数据&quot;">​</a></h2><p>整洁数据，根据埃德加科德的第三范式，包括以下三个特点：</p><ol><li>每列是一个变量</li><li>每行是一个观察值</li><li>每个单元格是一个值</li></ol><p>任何不符合以上三个特点的数据都是乱数据。</p><h3 id="一-、对数据进行转置" tabindex="-1">（一）、对数据进行转置 <a class="header-anchor" href="#一-、对数据进行转置" aria-label="Permalink to &quot;（一）、对数据进行转置&quot;">​</a></h3><p>当数据的列和行是反的，也就是每列是观察值，每行是变量，需要对数据进行转置</p><p>DataFrame的T属性，能返回一个行和列调换后的DataFrame</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;example4.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index_col</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>0</strong></th><th style="text-align:left;"><strong>1</strong></th><th style="text-align:left;"><strong>2</strong></th></tr></thead><tbody><tr><td><strong>姓名</strong></td><td style="text-align:left;">张三</td><td style="text-align:left;">李四</td><td style="text-align:left;">王五</td></tr><tr><td><strong>年龄</strong></td><td style="text-align:left;">30</td><td style="text-align:left;">25</td><td style="text-align:left;">28</td></tr><tr><td><strong>地址</strong></td><td style="text-align:left;">北京</td><td style="text-align:left;">上海</td><td style="text-align:left;">广州</td></tr></tbody></table><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df1.T</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>地址</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">张三</td><td style="text-align:left;">30</td><td style="text-align:left;">北京</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">李四</td><td style="text-align:left;">25</td><td style="text-align:left;">上海</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王五</td><td style="text-align:left;">28</td><td style="text-align:left;">广州</td></tr></tbody></table><h3 id="二-、对列进行拆分" tabindex="-1">（二）、对列进行拆分 <a class="header-anchor" href="#二-、对列进行拆分" aria-label="Permalink to &quot;（二）、对列进行拆分&quot;">​</a></h3><p>当一列有多个变量时，把一列拆分成多列</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;example5.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>城市</strong></th><th style="text-align:left;"><strong>人口密度</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">城市A</td><td style="text-align:left;">28.53万人/0.87平方公里</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">城市B</td><td style="text-align:left;">37.83万人/2.19平方公里</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">城市C</td><td style="text-align:left;">15.3万人/1.57平方公里</td></tr></tbody></table><h4 id="_1、拆分列" tabindex="-1">1、拆分列 <a class="header-anchor" href="#_1、拆分列" aria-label="Permalink to &quot;1、拆分列&quot;">​</a></h4><p>1）针对Python字符串</p><p>split方法，参数可以指定分隔符，就会得到拆分后字符串所组成的列表</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;28.53万人/0.87平方公里&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.split(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;28.53万人&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;0.87平方公里&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2）针对Series</p><p>str.split方法，参数可以指定分隔符，拆分字符串，调用后返回一个新的Series，每一个元素是一个列表。</p><p>但这没有达到拆分列的效果，因为Series只能表示DataFrame的一列，而我们希望拆分成多列。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;人口密度&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].str.split(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">53万人</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">87平方公里</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">37.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">83万人</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">19平方公里</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">3万人</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">57平方公里</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 人口密度, dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>3）拆分列(其实也是针对Series)</p><p>str.split方法，额外指定一个可选参数expand=True，表示把分隔后的结果分别用单独的Series表示，这样输出结果就会变成一个包含多列的DataFrame</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;人口密度&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].str.split(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expand</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>0</strong></th><th style="text-align:left;"><strong>1</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">28.53万人</td><td style="text-align:left;">0.87平方公里</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">37.83万人</td><td style="text-align:left;">2.19平方公里</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">15.3万人</td><td style="text-align:left;">1.57平方公里</td></tr></tbody></table><h4 id="_2、把新生成的dataframe添加进原先的dataframe" tabindex="-1">2、把新生成的DataFrame添加进原先的DataFrame <a class="header-anchor" href="#_2、把新生成的dataframe添加进原先的dataframe" aria-label="Permalink to &quot;2、把新生成的DataFrame添加进原先的DataFrame&quot;">​</a></h4><p>其实就是添加多列</p><p>在DataFrame后面方括号里放入列表，列表里放入多个列名，赋值给要加入的新列所组成的DataFrame</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;人口&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;面积&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df2[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;人口密度&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].str.split(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expand</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>城市</strong></th><th style="text-align:left;"><strong>人口密度</strong></th><th style="text-align:left;"><strong>人口</strong></th><th style="text-align:left;"><strong>面积</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">城市A</td><td style="text-align:left;">28.53万人/0.87平方公里</td><td style="text-align:left;">28.53万人</td><td style="text-align:left;">0.87平方公里</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">城市B</td><td style="text-align:left;">37.83万人/2.19平方公里</td><td style="text-align:left;">37.83万人</td><td style="text-align:left;">2.19平方公里</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">城市C</td><td style="text-align:left;">15.3万人/1.57平方公里</td><td style="text-align:left;">15.3万人</td><td style="text-align:left;">1.57平方公里</td></tr></tbody></table><h4 id="_3、删除拆分前的列" tabindex="-1">3、删除拆分前的列 <a class="header-anchor" href="#_3、删除拆分前的列" aria-label="Permalink to &quot;3、删除拆分前的列&quot;">​</a></h4><p>drop方法，指定axis=1</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df2.drop(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;人口密度&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>城市</strong></th><th style="text-align:left;"><strong>人口</strong></th><th style="text-align:left;"><strong>面积</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">城市A</td><td style="text-align:left;">28.53万人</td><td style="text-align:left;">0.87平方公里</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">城市B</td><td style="text-align:left;">37.83万人</td><td style="text-align:left;">2.19平方公里</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">城市C</td><td style="text-align:left;">15.3万人</td><td style="text-align:left;">1.57平方公里</td></tr></tbody></table><h3 id="三-、把不同列合并成一列" tabindex="-1">（三）、把不同列合并成一列 <a class="header-anchor" href="#三-、把不同列合并成一列" aria-label="Permalink to &quot;（三）、把不同列合并成一列&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;姓&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;三&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;四&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;五&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;年龄&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">35</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓</strong></th><th style="text-align:left;"><strong>名</strong></th><th style="text-align:left;"><strong>年龄</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">张</td><td style="text-align:left;">三</td><td style="text-align:left;">30</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">李</td><td style="text-align:left;">四</td><td style="text-align:left;">25</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王</td><td style="text-align:left;">五</td><td style="text-align:left;">35</td></tr></tbody></table><ol><li>拼接字符串</li></ol><p>str.cat方法，参数传入拼接的Series，可以拼接2个Series。</p><p>可以传入可选参数sep，来指定拼接时的分隔符</p><ol start="2"><li>添加列</li><li>删除拼接前的列</li></ol><p>df3.姓.str.cat(df3.名)</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    张三</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    李四</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    王五</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 姓, dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>df3[&#39;姓&#39;].str.cat(df3[&#39;名&#39;], sep=&#39;-&#39;)</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    张</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">三</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    李</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">四</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    王</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">五</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 姓, dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df3.姓.str.cat(df3.名)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df3.drop([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;姓&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>姓名</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">30</td><td style="text-align:left;">张三</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">25</td><td style="text-align:left;">李四</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">35</td><td style="text-align:left;">王五</td></tr></tbody></table><h3 id="四-、把宽数据转换成长数据" tabindex="-1">（四）、把宽数据转换成长数据 <a class="header-anchor" href="#四-、把宽数据转换成长数据" aria-label="Permalink to &quot;（四）、把宽数据转换成长数据&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;example6.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>国家代码</strong></th><th style="text-align:left;"><strong>年份</strong></th><th style="text-align:left;"><strong>男性年龄组（0-4岁）</strong></th><th style="text-align:left;"><strong>男性年龄组（5-14岁）</strong></th><th style="text-align:left;"><strong>男性年龄组（15-24岁）</strong></th><th style="text-align:left;"><strong>女性年龄组（0-4岁）</strong></th><th style="text-align:left;"><strong>女性年龄组（5-14岁）</strong></th><th style="text-align:left;"><strong>女性年龄组（15-24岁）</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">CN</td><td style="text-align:left;">2019</td><td style="text-align:left;">100</td><td style="text-align:left;">200</td><td style="text-align:left;">500</td><td style="text-align:left;">80</td><td style="text-align:left;">150</td><td style="text-align:left;">400</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">US</td><td style="text-align:left;">2019</td><td style="text-align:left;">50</td><td style="text-align:left;">150</td><td style="text-align:left;">300</td><td style="text-align:left;">40</td><td style="text-align:left;">100</td><td style="text-align:left;">200</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">JP</td><td style="text-align:left;">2019</td><td style="text-align:left;">30</td><td style="text-align:left;">120</td><td style="text-align:left;">250</td><td style="text-align:left;">20</td><td style="text-align:left;">80</td><td style="text-align:left;">150</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">IN</td><td style="text-align:left;">2019</td><td style="text-align:left;">80</td><td style="text-align:left;">180</td><td style="text-align:left;">400</td><td style="text-align:left;">60</td><td style="text-align:left;">120</td><td style="text-align:left;">300</td></tr></tbody></table><p>即重塑列，具体来说是在把一部分列名的值，转换为变量的值</p><p>pd.melt方法，可以帮我们进行这方面的转换。</p><p>第一个参数传入要转换的DataFrame</p><p>可选参数id_vars传入一个列表，里面放入想保持原样的列，那么除了id_vars列表里面之外的列，都会被视为要进行转换的列</p><p>可选参数var_name，要被赋值为在转换后的DataFrame中，包含原本列名值的新列列名</p><p>可选参数value_name，要被赋值为在转换后的DataFrame中，包含原本变量值的新列列名</p><p>运行后，就会返回一个从原本宽数据转换成长数据的DataFrame</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.melt(df4, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">              id_vars</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;国家代码&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;年份&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">              var_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;年龄组&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">              value_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;肺结核病例数&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>国家代码</strong></th><th style="text-align:left;"><strong>年份</strong></th><th style="text-align:left;"><strong>年龄组</strong></th><th style="text-align:left;"><strong>肺结核病例数</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">CN</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（0-4岁）</td><td style="text-align:left;">100</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">US</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（0-4岁）</td><td style="text-align:left;">50</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">JP</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（0-4岁）</td><td style="text-align:left;">30</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">IN</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（0-4岁）</td><td style="text-align:left;">80</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">CN</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（5-14岁）</td><td style="text-align:left;">200</td></tr><tr><td><strong>5</strong></td><td style="text-align:left;">US</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（5-14岁）</td><td style="text-align:left;">150</td></tr><tr><td><strong>6</strong></td><td style="text-align:left;">JP</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（5-14岁）</td><td style="text-align:left;">120</td></tr><tr><td><strong>7</strong></td><td style="text-align:left;">IN</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（5-14岁）</td><td style="text-align:left;">180</td></tr><tr><td><strong>8</strong></td><td style="text-align:left;">CN</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（15-24岁）</td><td style="text-align:left;">500</td></tr><tr><td><strong>9</strong></td><td style="text-align:left;">US</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（15-24岁）</td><td style="text-align:left;">300</td></tr><tr><td><strong>10</strong></td><td style="text-align:left;">JP</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（15-24岁）</td><td style="text-align:left;">250</td></tr><tr><td><strong>11</strong></td><td style="text-align:left;">IN</td><td style="text-align:left;">2019</td><td style="text-align:left;">男性年龄组（15-24岁）</td><td style="text-align:left;">400</td></tr><tr><td><strong>12</strong></td><td style="text-align:left;">CN</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（0-4岁）</td><td style="text-align:left;">80</td></tr><tr><td><strong>13</strong></td><td style="text-align:left;">US</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（0-4岁）</td><td style="text-align:left;">40</td></tr><tr><td><strong>14</strong></td><td style="text-align:left;">JP</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（0-4岁）</td><td style="text-align:left;">20</td></tr><tr><td><strong>15</strong></td><td style="text-align:left;">IN</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（0-4岁）</td><td style="text-align:left;">60</td></tr><tr><td><strong>16</strong></td><td style="text-align:left;">CN</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（5-14岁）</td><td style="text-align:left;">150</td></tr><tr><td><strong>17</strong></td><td style="text-align:left;">US</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（5-14岁）</td><td style="text-align:left;">100</td></tr><tr><td><strong>18</strong></td><td style="text-align:left;">JP</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（5-14岁）</td><td style="text-align:left;">80</td></tr><tr><td><strong>19</strong></td><td style="text-align:left;">IN</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（5-14岁）</td><td style="text-align:left;">120</td></tr><tr><td><strong>20</strong></td><td style="text-align:left;">CN</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（15-24岁）</td><td style="text-align:left;">400</td></tr><tr><td><strong>21</strong></td><td style="text-align:left;">US</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（15-24岁）</td><td style="text-align:left;">200</td></tr><tr><td><strong>22</strong></td><td style="text-align:left;">JP</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（15-24岁）</td><td style="text-align:left;">150</td></tr><tr><td><strong>23</strong></td><td style="text-align:left;">IN</td><td style="text-align:left;">2019</td><td style="text-align:left;">女性年龄组（15-24岁）</td><td style="text-align:left;">300</td></tr></tbody></table><h3 id="五-、对行进行拆分" tabindex="-1">（五）、对行进行拆分 <a class="header-anchor" href="#五-、对行进行拆分" aria-label="Permalink to &quot;（五）、对行进行拆分&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;example7.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>学生姓名</strong></th><th style="text-align:left;"><strong>学号</strong></th><th style="text-align:left;"><strong>课程列表</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">张三</td><td style="text-align:left;">1</td><td style="text-align:left;">[&#39;数学&#39;, &#39;物理&#39;]</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">李四</td><td style="text-align:left;">2</td><td style="text-align:left;">[&#39;英语&#39;, &#39;化学&#39;, &#39;历史&#39;]</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王五</td><td style="text-align:left;">3</td><td style="text-align:left;">[&#39;语文&#39;, &#39;数学&#39;, &#39;英语&#39;, &#39;政治&#39;]</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">赵六</td><td style="text-align:left;">4</td><td style="text-align:left;">[&#39;物理&#39;, &#39;生物&#39;]</td></tr></tbody></table><p>虽然上面的课程列表变量看起来像是列表，但实际上是字符串</p><p>比如第一行里的课程列表实际为字符串&quot;[&#39;数学&#39;, &#39;物理&#39;]&quot;，而不是列表[&#39;数学&#39;, &#39;物理&#39;]</p><p>所以我们需要先将字符串形式的列表转换为实际的列表对象，这样explode才能对列表进行拆分</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> json</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;课程列表&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df5[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;课程列表&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].apply(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">lambda</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x: json.loads(x.replace(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>学生姓名</strong></th><th style="text-align:left;"><strong>学号</strong></th><th style="text-align:left;"><strong>课程列表</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">张三</td><td style="text-align:left;">1</td><td style="text-align:left;">[数学, 物理]</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">李四</td><td style="text-align:left;">2</td><td style="text-align:left;">[英语, 化学, 历史]</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王五</td><td style="text-align:left;">3</td><td style="text-align:left;">[语文, 数学, 英语, 政治]</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">赵六</td><td style="text-align:left;">4</td><td style="text-align:left;">[物理, 生物]</td></tr></tbody></table><p>当某列的值都是列表，而不是一个个独立的值</p><p>df.explode方法，传入需要拆分的变量名，就会返回一个把该列列表中每一个元素，转换为单独一行的新DataFrame</p><p>这个方法很实用，当每个单元格是一个值而不是列表时，更好进行统计</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df5.explode(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;课程列表&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>学生姓名</strong></th><th style="text-align:left;"><strong>学号</strong></th><th style="text-align:left;"><strong>课程列表</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">张三</td><td style="text-align:left;">1</td><td style="text-align:left;">数学</td></tr><tr><td><strong>0</strong></td><td style="text-align:left;">张三</td><td style="text-align:left;">1</td><td style="text-align:left;">物理</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">李四</td><td style="text-align:left;">2</td><td style="text-align:left;">英语</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">李四</td><td style="text-align:left;">2</td><td style="text-align:left;">化学</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">李四</td><td style="text-align:left;">2</td><td style="text-align:left;">历史</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王五</td><td style="text-align:left;">3</td><td style="text-align:left;">语文</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王五</td><td style="text-align:left;">3</td><td style="text-align:left;">数学</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王五</td><td style="text-align:left;">3</td><td style="text-align:left;">英语</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">王五</td><td style="text-align:left;">3</td><td style="text-align:left;">政治</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">赵六</td><td style="text-align:left;">4</td><td style="text-align:left;">物理</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">赵六</td><td style="text-align:left;">4</td><td style="text-align:left;">生物</td></tr></tbody></table><h3 id="六-、对行或列进行删除" tabindex="-1">（六）、对行或列进行删除 <a class="header-anchor" href="#六-、对行或列进行删除" aria-label="Permalink to &quot;（六）、对行或列进行删除&quot;">​</a></h3><p>当我们想清理无效或无用的行或列</p><p>drop方法</p><p><strong>基本上，对DataFrame的操作方法，都是默认不改变原始DataFrame的，而是返回一个新的DataFrame</strong></p><p><strong>要么就得进行重新赋值，要么指定可选参数inplace=True</strong></p><h2 id="四、清理脏数据" tabindex="-1">四、清理脏数据 <a class="header-anchor" href="#四、清理脏数据" aria-label="Permalink to &quot;四、清理脏数据&quot;">​</a></h2><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="一-、处理缺失数据" tabindex="-1">（一）、处理缺失数据 <a class="header-anchor" href="#一-、处理缺失数据" aria-label="Permalink to &quot;（一）、处理缺失数据&quot;">​</a></h3><h4 id="_1、对整列缺失值进行填充" tabindex="-1">1、对整列缺失值进行填充 <a class="header-anchor" href="#_1、对整列缺失值进行填充" aria-label="Permalink to &quot;1、对整列缺失值进行填充&quot;">​</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建示例 DataFrame</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售人员&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王磊&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;刘娜&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张洋&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;地址&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;苏州&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;郑州&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;南京&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;西安&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df1.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;004&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;国家&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.nan</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th><th style="text-align:left;"><strong>国家</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">800</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td><td style="text-align:left;">NaN</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">1200</td><td style="text-align:left;">张洋</td><td style="text-align:left;">西安</td><td style="text-align:left;">NaN</td></tr></tbody></table><ol><li>对全是缺失值的列填入统一值，可以通过针对列的赋值操作</li><li>对全是缺失值的列填入不同值</li></ol><p>见更新DataFrame的一列值 2.15.一.1.</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;国家&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;中国&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th><th style="text-align:left;"><strong>国家</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td><td style="text-align:left;">中国</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td><td style="text-align:left;">中国</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">800</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td><td style="text-align:left;">中国</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">1200</td><td style="text-align:left;">张洋</td><td style="text-align:left;">西安</td><td style="text-align:left;">中国</td></tr></tbody></table><h4 id="_2、对整行缺失值进行填充" tabindex="-1">2、对整行缺失值进行填充 <a class="header-anchor" href="#_2、对整行缺失值进行填充" aria-label="Permalink to &quot;2、对整行缺失值进行填充&quot;">​</a></h4><ol><li>对全是缺失值的行填入统一值，可以通过针对行的赋值操作</li><li>对全是缺失值的行填入不同值，见更新DataFrame的一行值</li></ol><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.iloc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.nan</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th><th style="text-align:left;"><strong>国家</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000.0</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td><td style="text-align:left;">中国</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500.0</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td><td style="text-align:left;">中国</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">800.0</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td><td style="text-align:left;">中国</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td><td style="text-align:left;">NaN</td></tr></tbody></table><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1.iloc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;test&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th><th style="text-align:left;"><strong>国家</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000.0</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td><td style="text-align:left;">中国</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500.0</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td><td style="text-align:left;">中国</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">800.0</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td><td style="text-align:left;">中国</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">test</td><td style="text-align:left;">test</td><td style="text-align:left;">test</td><td style="text-align:left;">test</td><td style="text-align:left;">test</td></tr></tbody></table><h4 id="_3、对某个缺失值进行填充" tabindex="-1">3、对某个缺失值进行填充 <a class="header-anchor" href="#_3、对某个缺失值进行填充" aria-label="Permalink to &quot;3、对某个缺失值进行填充&quot;">​</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建示例 DataFrame</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.nan, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售人员&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王磊&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;刘娜&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张洋&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;地址&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;苏州&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;郑州&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;南京&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;西安&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df2.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;004&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000.0</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500.0</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">NaN</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">1200.0</td><td style="text-align:left;">张洋</td><td style="text-align:left;">西安</td></tr></tbody></table><p>可以先用loc或iloc先去定位到那个值，然后重新赋值</p><p>用loc或iloc先去定位值，见Dataframe章节</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2.loc[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 800</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000.0</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500.0</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">800.0</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">1200.0</td><td style="text-align:left;">张洋</td><td style="text-align:left;">西安</td></tr></tbody></table><h4 id="_4、对部分缺失值进行填充" tabindex="-1">4、对部分缺失值进行填充 <a class="header-anchor" href="#_4、对部分缺失值进行填充" aria-label="Permalink to &quot;4、对部分缺失值进行填充&quot;">​</a></h4><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.nan, np.nan],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售额&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;销售人员&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;王磊&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;刘娜&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;张洋&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;地址&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;苏州&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;郑州&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;南京&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;西安&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df3.rename(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;001&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;004&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">NaN</td><td style="text-align:left;">800</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">NaN</td><td style="text-align:left;">1200</td><td style="text-align:left;">张洋</td><td style="text-align:left;">西安</td></tr></tbody></table><h5 id="_1-填入统一值" tabindex="-1">1）填入统一值 <a class="header-anchor" href="#_1-填入统一值" aria-label="Permalink to &quot;1）填入统一值&quot;">​</a></h5><p>如果要替换某一部分的值，也是一样的道理，能用loc或iloc提取出来的部分，都可以通过赋值来填充或替换值。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3.loc[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;004&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;2005-01-03&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">800</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">1200</td><td style="text-align:left;">张洋</td><td style="text-align:left;">西安</td></tr></tbody></table><h5 id="_2-分别填入值" tabindex="-1">2）分别填入值 <a class="header-anchor" href="#_2-分别填入值" aria-label="Permalink to &quot;2）分别填入值&quot;">​</a></h5><p>如果要对部分缺失值，分别填入不同值，可以用元组或列表的形式来赋值</p><p><strong>缺失值的个数和元组或列表里元素的个数，要一致</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3.loc[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;003&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;004&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2005-01-03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;2023-9-15&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>日期</strong></th><th style="text-align:left;"><strong>销售额</strong></th><th style="text-align:left;"><strong>销售人员</strong></th><th style="text-align:left;"><strong>地址</strong></th></tr></thead><tbody><tr><td><strong>001</strong></td><td style="text-align:left;">2005-01-01</td><td style="text-align:left;">1000</td><td style="text-align:left;">李华</td><td style="text-align:left;">苏州</td></tr><tr><td><strong>002</strong></td><td style="text-align:left;">2005-01-02</td><td style="text-align:left;">1500</td><td style="text-align:left;">王磊</td><td style="text-align:left;">郑州</td></tr><tr><td><strong>003</strong></td><td style="text-align:left;">2005-01-03</td><td style="text-align:left;">800</td><td style="text-align:left;">刘娜</td><td style="text-align:left;">南京</td></tr><tr><td><strong>004</strong></td><td style="text-align:left;">2023-9-15</td><td style="text-align:left;">1200</td><td style="text-align:left;">张洋</td><td style="text-align:left;">西安</td></tr></tbody></table><h4 id="_5、自动找到缺失值进行填充" tabindex="-1">5、自动找到缺失值进行填充 <a class="header-anchor" href="#_5、自动找到缺失值进行填充" aria-label="Permalink to &quot;5、自动找到缺失值进行填充&quot;">​</a></h4><p>以上方法都需要我们自行定位缺失值的位置，但在数据量很大，缺失值很多的情况下，更需要程序能自动找到所有为NaN的值，然后根据我们的指示进行填充</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.nan, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.nan, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.nan],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>A</strong></th><th style="text-align:left;"><strong>B</strong></th><th style="text-align:left;"><strong>C</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1.0</td><td style="text-align:left;">5.0</td><td style="text-align:left;">8</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2.0</td><td style="text-align:left;">NaN</td><td style="text-align:left;">9</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">NaN</td><td style="text-align:left;">7.0</td><td style="text-align:left;">10</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4.0</td><td style="text-align:left;">NaN</td><td style="text-align:left;">11</td></tr></tbody></table><h5 id="_1-series的fillna方法" tabindex="-1">1）Series的fillna方法 <a class="header-anchor" href="#_1-series的fillna方法" aria-label="Permalink to &quot;1）Series的fillna方法&quot;">​</a></h5><p>Series有个叫fillna的方法，调用时列里面所有NaN值都会被替换成传入的参数，就不需要一个个去定位缺失值的位置了</p><p>a、对缺失值填入确定的值</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].fillna(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    5.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    7.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: B, dtype: float64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>b、对缺失值填入某个计算结果</p><p>fillna方法里，除了传入确定的参数，还可以替换成某个计算结果，如平均值</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].fillna(df4[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].mean())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    5.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    6.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    7.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    6.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: B, dtype: float64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="_2-dataframe的fillna方法" tabindex="-1">2）DataFrame的fillna方法 <a class="header-anchor" href="#_2-dataframe的fillna方法" aria-label="Permalink to &quot;2）DataFrame的fillna方法&quot;">​</a></h5><p>DataFrame也有fillna方法，所以除了能填充某列的缺失值，还能直接对整个DataFrame里的缺失值进行填充。</p><p>a、对缺失值填入统一值</p><p>传入某个值后，返回的新DataFrame里，所有缺失值都会变成那个值</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4.fillna(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>A</strong></th><th style="text-align:left;"><strong>B</strong></th><th style="text-align:left;"><strong>C</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1.0</td><td style="text-align:left;">5.0</td><td style="text-align:left;">8</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2.0</td><td style="text-align:left;">0.0</td><td style="text-align:left;">9</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">0.0</td><td style="text-align:left;">7.0</td><td style="text-align:left;">10</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4.0</td><td style="text-align:left;">0.0</td><td style="text-align:left;">11</td></tr></tbody></table><p>b、对缺失值按列填入不同值</p><p>还可以传入一个字典，键为列名，值为替换值，能实现把不同列里的空缺值，替换成不同值的效果。这个相比Series的fillna方法逐列操作要高效得多</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df4.fillna({</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>A</strong></th><th style="text-align:left;"><strong>B</strong></th><th style="text-align:left;"><strong>C</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">1.0</td><td style="text-align:left;">5.0</td><td style="text-align:left;">8</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">2.0</td><td style="text-align:left;">10.0</td><td style="text-align:left;">9</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">0.0</td><td style="text-align:left;">7.0</td><td style="text-align:left;">10</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">4.0</td><td style="text-align:left;">10.0</td><td style="text-align:left;">11</td></tr></tbody></table><p><strong>只返回替换好的新DataFrame</strong></p><h4 id="_6、删除存在缺失值的行" tabindex="-1">6、删除存在缺失值的行 <a class="header-anchor" href="#_6、删除存在缺失值的行" aria-label="Permalink to &quot;6、删除存在缺失值的行&quot;">​</a></h4><p>如果丢失的是对分析目标有关键意义的数据，同时又没有合适的值进行填充，这时我们或许需要抛弃存在空缺值的观察值，调用dropna方法，被用于删除有缺失值的数据</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Bob&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Mary&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;年龄&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.nan, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;工资&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, np.nan, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">70000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;性别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;M&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;F&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;M&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;F&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">25.0</td><td style="text-align:left;">50000.0</td><td style="text-align:left;">M</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">30.0</td><td style="text-align:left;">NaN</td><td style="text-align:left;">F</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">NaN</td><td style="text-align:left;">70000.0</td><td style="text-align:left;">M</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Mary</td><td style="text-align:left;">40.0</td><td style="text-align:left;">60000.0</td><td style="text-align:left;">F</td></tr></tbody></table><h5 id="_1-删除所有有缺失值的行" tabindex="-1">1）删除所有有缺失值的行 <a class="header-anchor" href="#_1-删除所有有缺失值的行" aria-label="Permalink to &quot;1）删除所有有缺失值的行&quot;">​</a></h5><p>DataFrame在dropna方法直接调用时，会返回没有任何缺失值的行，所组成的新DataFrame。也就是说，只要某行任何一个值是空缺的，调用dropna后就见不到它了。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5.dropna()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">25.0</td><td style="text-align:left;">50000.0</td><td style="text-align:left;">M</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Mary</td><td style="text-align:left;">40.0</td><td style="text-align:left;">60000.0</td><td style="text-align:left;">F</td></tr></tbody></table><h5 id="_2-删除关键值缺失的行" tabindex="-1">2）删除关键值缺失的行 <a class="header-anchor" href="#_2-删除关键值缺失的行" aria-label="Permalink to &quot;2）删除关键值缺失的行&quot;">​</a></h5><p>但我们一般清理数据的时候，更关注的是某些有关键信息的列，不太关键的变量，即使缺失也问题不大</p><p>那我们调用dropna方法时，可以传入一个可选参数subset=[&#39;关键值缺失的列的列名1&#39;，...]。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5.dropna(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;工资&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>工资</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">25.0</td><td style="text-align:left;">50000.0</td><td style="text-align:left;">M</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">NaN</td><td style="text-align:left;">70000.0</td><td style="text-align:left;">M</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Mary</td><td style="text-align:left;">40.0</td><td style="text-align:left;">60000.0</td><td style="text-align:left;">F</td></tr></tbody></table><h5 id="_3-删除有缺失值的列" tabindex="-1">3）删除有缺失值的列 <a class="header-anchor" href="#_3-删除有缺失值的列" aria-label="Permalink to &quot;3）删除有缺失值的列&quot;">​</a></h5><p>指定axis=1</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5.dropna(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">M</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">F</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">M</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Mary</td><td style="text-align:left;">F</td></tr></tbody></table><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df5.dropna(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">25.0</td><td style="text-align:left;">M</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">30.0</td><td style="text-align:left;">F</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">NaN</td><td style="text-align:left;">M</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Mary</td><td style="text-align:left;">40.0</td><td style="text-align:left;">F</td></tr></tbody></table><h3 id="二-、删除重复数据" tabindex="-1">（二）、删除重复数据 <a class="header-anchor" href="#二-、删除重复数据" aria-label="Permalink to &quot;（二）、删除重复数据&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Bob&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;年龄&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">35</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;性别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;M&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;F&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;M&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;F&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;M&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">25</td><td style="text-align:left;">M</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">30</td><td style="text-align:left;">F</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td><td style="text-align:left;">M</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">30</td><td style="text-align:left;">F</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">40</td><td style="text-align:left;">M</td></tr></tbody></table><p>drop_duplicates方法，可以用于删除Series里的重复值，或是DataFrame里的重复行</p><h4 id="_1、删除所有变量的值都重复的行" tabindex="-1">1、删除所有变量的值都重复的行 <a class="header-anchor" href="#_1、删除所有变量的值都重复的行" aria-label="Permalink to &quot;1、删除所有变量的值都重复的行&quot;">​</a></h4><p>直接调用DataFrame的drop_duplicates时，只有当所有变量都一样的时候，才会被视为重复，也因此才会被删除掉。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].drop_duplicates()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     John</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Alice</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      Bob</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 姓名, dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6.drop_duplicates()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">25</td><td style="text-align:left;">M</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">30</td><td style="text-align:left;">F</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td><td style="text-align:left;">M</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">40</td><td style="text-align:left;">M</td></tr></tbody></table><h4 id="_2、删除特定变量的值重复的行" tabindex="-1">2、删除特定变量的值重复的行 <a class="header-anchor" href="#_2、删除特定变量的值重复的行" aria-label="Permalink to &quot;2、删除特定变量的值重复的行&quot;">​</a></h4><p>也可以用subset=[&#39;变量1&#39;, &#39;变量2&#39;...],只要这个列表里的变量同时重复，就会被删除</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6.drop_duplicates(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;性别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">25</td><td style="text-align:left;">M</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">30</td><td style="text-align:left;">F</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td><td style="text-align:left;">M</td></tr></tbody></table><h4 id="_3、可选参数keep" tabindex="-1">3、可选参数keep <a class="header-anchor" href="#_3、可选参数keep" aria-label="Permalink to &quot;3、可选参数keep&quot;">​</a></h4><p>删除的时候，默认是删除第二次及之后出现的值。</p><p>但我们也可以把让可选参数keep=&#39;last&#39;，这样会保留最后一个出现的值，删除掉之前出现的重复值</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df6.drop_duplicates(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">subset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;性别&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">keep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;last&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>年龄</strong></th><th style="text-align:left;"><strong>性别</strong></th></tr></thead><tbody><tr><td><strong>2</strong></td><td style="text-align:left;">Bob</td><td style="text-align:left;">35</td><td style="text-align:left;">M</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">Alice</td><td style="text-align:left;">30</td><td style="text-align:left;">F</td></tr><tr><td><strong>4</strong></td><td style="text-align:left;">John</td><td style="text-align:left;">40</td><td style="text-align:left;">M</td></tr></tbody></table><h3 id="三-、处理不一致数据" tabindex="-1">（三）、处理不一致数据 <a class="header-anchor" href="#三-、处理不一致数据" aria-label="Permalink to &quot;（三）、处理不一致数据&quot;">​</a></h3><p>不一致数据是指，存在不同的值实际含义相同，或指代的是同一目标</p><p>处理方法是，把数值都替换成统一的。</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;姓名&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;小明&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;小红&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;小张&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;小李&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;家乡&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;北京&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;上海&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;广州&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;深圳&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;学校&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;北京大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;华南理工&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>家乡</strong></th><th style="text-align:left;"><strong>学校</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">小明</td><td style="text-align:left;">北京</td><td style="text-align:left;">北京大学</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">小红</td><td style="text-align:left;">上海</td><td style="text-align:left;">清华大学</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">小张</td><td style="text-align:left;">广州</td><td style="text-align:left;">华南理工</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">小李</td><td style="text-align:left;">深圳</td><td style="text-align:left;">清华</td></tr></tbody></table><p>可以用Series或DataFrame的replace方法，在Series和DataFrame上用法差不多</p><h4 id="_1、replace方法参数是两个数字或字符串" tabindex="-1">1、replace方法参数是两个数字或字符串 <a class="header-anchor" href="#_1、replace方法参数是两个数字或字符串" aria-label="Permalink to &quot;1、replace方法参数是两个数字或字符串&quot;">​</a></h4><p>表示想把前面值全部替换成后面值</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;学校&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].replace(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    北京大学</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    清华大学</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    华南理工</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    清华大学</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 学校, dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-plain vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">plain</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>df7.replace(&#39;清华&#39;, &#39;清华大学&#39;)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>家乡</strong></th><th style="text-align:left;"><strong>学校</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">小明</td><td style="text-align:left;">北京</td><td style="text-align:left;">北京大学</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">小红</td><td style="text-align:left;">上海</td><td style="text-align:left;">清华大学</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">小张</td><td style="text-align:left;">广州</td><td style="text-align:left;">华南理工</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">小李</td><td style="text-align:left;">深圳</td><td style="text-align:left;">清华大学</td></tr></tbody></table><h4 id="_2、replace方法第一个参数是一个列表" tabindex="-1">2、replace方法第一个参数是一个列表 <a class="header-anchor" href="#_2、replace方法第一个参数是一个列表" aria-label="Permalink to &quot;2、replace方法第一个参数是一个列表&quot;">​</a></h4><p>那么列表里面所有值都会被替换成后面那个，这样就可以一次性，对多个不同指代词进行统一</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;学校&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].replace([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;五道口职业技术学院&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Tsinghua University&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    北京大学</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    清华大学</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    华南理工</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    清华大学</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 学校, dtype: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7.replace([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;五道口职业技术学院&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Tsinghua University&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>家乡</strong></th><th style="text-align:left;"><strong>学校</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">小明</td><td style="text-align:left;">北京</td><td style="text-align:left;">北京大学</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">小红</td><td style="text-align:left;">上海</td><td style="text-align:left;">清华大学</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">小张</td><td style="text-align:left;">广州</td><td style="text-align:left;">华南理工</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">小李</td><td style="text-align:left;">深圳</td><td style="text-align:left;">清华大学</td></tr></tbody></table><h4 id="_3、replace方法参数是单个字典" tabindex="-1">3、replace方法参数是单个字典 <a class="header-anchor" href="#_3、replace方法参数是单个字典" aria-label="Permalink to &quot;3、replace方法参数是单个字典&quot;">​</a></h4><p>去指定不同的值要被什么值替换</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">replace_dict </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;华南理工&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;华南理工大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;清华&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;清华大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;北大&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;北京大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;中大&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;中山大学&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df7.replace(replace_dict)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><table tabindex="0"><thead><tr><th></th><th style="text-align:left;"><strong>姓名</strong></th><th style="text-align:left;"><strong>家乡</strong></th><th style="text-align:left;"><strong>学校</strong></th></tr></thead><tbody><tr><td><strong>0</strong></td><td style="text-align:left;">小明</td><td style="text-align:left;">北京</td><td style="text-align:left;">北京大学</td></tr><tr><td><strong>1</strong></td><td style="text-align:left;">小红</td><td style="text-align:left;">上海</td><td style="text-align:left;">清华大学</td></tr><tr><td><strong>2</strong></td><td style="text-align:left;">小张</td><td style="text-align:left;">广州</td><td style="text-align:left;">华南理工大学</td></tr><tr><td><strong>3</strong></td><td style="text-align:left;">小李</td><td style="text-align:left;">深圳</td><td style="text-align:left;">清华大学</td></tr></tbody></table><h3 id="四-、进行数据类型转换" tabindex="-1">（四）、进行数据类型转换 <a class="header-anchor" href="#四-、进行数据类型转换" aria-label="Permalink to &quot;（四）、进行数据类型转换&quot;">​</a></h3><p>数据类型转换，在很多时候是有必要，因为某些方法只能用在特定类型的数据上。比如说：不能对字符串求平均值</p><h4 id="_1、series的astype方法" tabindex="-1">1、Series的astype方法 <a class="header-anchor" href="#_1、series的astype方法" aria-label="Permalink to &quot;1、Series的astype方法&quot;">​</a></h4><p>参数为数据类型，比如int、float、str、bool等，调用后，返回的新Series里的数据就被转换成了那个类型</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.Series([</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s1.astype(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">float</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    1.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    2.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    3.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtype: float64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_2、type函数" tabindex="-1">2、type函数 <a class="header-anchor" href="#_2、type函数" aria-label="Permalink to &quot;2、type函数&quot;">​</a></h4><p>在Python里面，如果你想知道数据类型，可以调用type函数</p><h4 id="_3、pandas的数据类型category" tabindex="-1">3、Pandas的数据类型category <a class="header-anchor" href="#_3、pandas的数据类型category" aria-label="Permalink to &quot;3、Pandas的数据类型category&quot;">​</a></h4><p>数据可以被划分为两种类型，分类数据和数值数据。</p><p>分类数据，指的是包含有限数量的不同类别的数据，比如：出生时的性别，就两种，是有限的；奥运会的奖牌，金银铜，也是有限的</p><p>数值数据，指的是测量出的观测值，是某个具体的数值，种类不受限制。比如：0到1之间就有无限个数字，那对它进行求和或求平均值等数学运算也是有意义的</p><p>当分类数据种类有限时，Pandas会推荐把它们转换成category这个数据类型。</p><p>好处：节约内存空间，并且在后续分析或可视化的时候，也有利于让Pandas自动选用合适的统计方法或图标类型</p><p><strong>category不是Python自带的类型名称，而是Pandas库里面的，所以我们在用astype进行转换的时候，要传入一个用引号包围的category，不然Python不认</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.Series([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;红色&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;红色&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;橙色&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;蓝色&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s2.astype(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;category&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    红色</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    红色</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    橙色</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    蓝色</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dtype: category</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Categories (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;橙色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;红色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;蓝色&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_4、转换成datetime日期时间类型" tabindex="-1">4、转换成datetime日期时间类型 <a class="header-anchor" href="#_4、转换成datetime日期时间类型" aria-label="Permalink to &quot;4、转换成datetime日期时间类型&quot;">​</a></h4><p>可以用Pandas的to_datetime方法，参数传入Series，可以返回转换成日期时间类型的Series</p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.to_datetime(df3[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;日期&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df3.日期</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">01</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   2005</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">02</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   2005</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">03</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   2005</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">3</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">04</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   2023</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">9</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name: 日期, dtype: datetime64[ns]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,322)])])}const o=s(l,[["render",n]]);export{y as __pageData,o as default};
