import{_ as a,c as i,o as n,aN as e}from"./chunks/framework.CMIDsdwV.js";const l="/assets/image-20260128154944173.CobSjvd5.png",p="/assets/image-20260128155721668.DCIzqQa7.png",t="/assets/image-20260128160103375.B4AaQYNP.png",r="/assets/image-20260128170016263.BWhG7Bxf.png",m=JSON.parse('{"title":"spring-boot-docker-compose","description":"","frontmatter":{},"headers":[],"relativePath":"Java/容器/Docker/03.Docker使用/spring-boot-docker-compose.md","filePath":"Java/容器/Docker/03.Docker使用/spring-boot-docker-compose.md","lastUpdated":1769765079000}'),h={name:"Java/容器/Docker/03.Docker使用/spring-boot-docker-compose.md"};function k(o,s,c,d,E,g){return n(),i("div",null,[...s[0]||(s[0]=[e(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /Java\\容器\\Docker\\03.Docker使用\\spring-boot-docker-compose.md for this page in Markdown format</div><h1 id="spring-boot-docker-compose" tabindex="-1">spring-boot-docker-compose <a class="header-anchor" href="#spring-boot-docker-compose" aria-label="Permalink to &quot;spring-boot-docker-compose&quot;">​</a></h1><p>新拿到一个 Spring Boot 项目的代码，想把代码跑起来试试，第一个烦恼是不是自己的电脑上没有安装或没有启动对应环境（MySQL、Redis、MQ消息队列等等）。</p><p>这些环境装完或者启动完，大半天就过去了。然后还要设置账号密码和配置里的一致等等。最崩溃的是换个项目又要重新忙活一次。</p><p><strong>Spring Boot 3</strong> 引入了对 Docker Compose 的支持，使得在 Spring Boot 应用程序中管理容器变得更加方便。</p><blockquote><p><strong>Docker Compose</strong> 是一个用于定义和运行多容器 Docker 应用程序的工具。通过一个简单的 YAML 文件，可以配置应用程序所需的所有服务，并使用单个命令启动和停止它们。</p></blockquote><h3 id="引入依赖" tabindex="-1">引入依赖 <a class="header-anchor" href="#引入依赖" aria-label="Permalink to &quot;引入依赖&quot;">​</a></h3><p>现在 Spring Boot 3 新加了一个包 <code>spring-boot-docker-compose</code>：</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;org.springframework.boot&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;spring-boot-docker-compose&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;3.4.0&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这个包用处就是自动帮你在docker里拉取对应的镜像环境并且自动启动。</p><h3 id="创建-docker-compose-文件" tabindex="-1">创建 Docker Compose 文件 <a class="header-anchor" href="#创建-docker-compose-文件" aria-label="Permalink to &quot;创建 Docker Compose 文件&quot;">​</a></h3><p>创建一个 docker-compose.yml 文件来定义服务</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Docker Compose配置文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用版本3.8的Compose文件格式</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3.8&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 定义服务</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # MongoDB服务</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 使用最新版本的MongoDB镜像</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mongo:latest</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 映射端口：主机端口:容器端口</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # - &#39;27017:27017&#39; # 固定端口映射方式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;27017&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 左边不写固定端口，让Docker分配随机端口防止冲突</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 挂载卷，用于持久化数据</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">db:/data/db</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # MySQL服务</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 使用8.0版本的MySQL镜像</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mysql:8.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 映射端口：只指定容器端口，让Docker分配随机主机端口防止冲突</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # - &#39;3306:3306&#39;  # 固定端口映射方式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3306&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 左边不写固定端口，让Docker分配随机端口防止冲突</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 环境变量配置</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      MYSQL_ROOT_PASSWORD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">root</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # MySQL root用户密码</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      MYSQL_DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">test</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 默认创建的数据库名称</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      MYSQL_USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">test</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # 创建的普通用户名称</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      MYSQL_PASSWORD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">test</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 普通用户的密码</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 挂载卷</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mysql-data:/var/lib/mysql</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           # 持久化MySQL数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mysql-init:/docker-entrypoint-initdb.d</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 初始化脚本目录</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    healthcheck</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CMD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mysqladmin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ping&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-h&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查MySQL是否健康</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">10s</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 检查间隔时间</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5s</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 超时时间</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      retries</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 重试次数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Redis服务</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  redis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 使用7.0版本的Redis镜像</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">redis:7.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 映射端口：主机端口:容器端口</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # - &#39;6379:6379&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;6379&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 左边不写固定端口，让Docker分配随机端口防止冲突</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 挂载卷，用于持久化数据</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # volumes:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #   - redis-data:/data</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 启动命令，启用AOF持久化</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # command: redis-server --appendonly yes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 定义卷</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # MongoDB数据卷</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">local</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # MySQL数据卷</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  mysql-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">local</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # MySQL初始化脚本卷</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  mysql-init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">local</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Redis数据卷</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  redis-data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">local</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h3 id="配置-spring-boot-应用程序" tabindex="-1">配置 Spring Boot 应用程序 <a class="header-anchor" href="#配置-spring-boot-应用程序" aria-label="Permalink to &quot;配置 Spring Boot 应用程序&quot;">​</a></h3><p>需要告诉 Spring Boot 3 Docker Compose 文件的位置。可以在 application.yml 文件中添加以下配置：</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;"> docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   compose</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">     enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">     file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">docker-compose.yml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>启动之后会看到拉取镜像的日志了：</p><h2 id="idea连接远程" tabindex="-1">IDEA连接远程 <a class="header-anchor" href="#idea连接远程" aria-label="Permalink to &quot;IDEA连接远程&quot;">​</a></h2><p>在 IDEA 中使用<code>spring-boot-docker-compose</code>插件，将 Spring Boot 项目部署到<strong>远程服务器的 Docker</strong>上并启动，核心是配置 IDEA 连接远程 Docker、编写<code>docker-compose.yml</code>，并通过插件或命令完成部署启动。下面分步骤讲解，从环境准备到项目启动，确保每一步都可落地。</p><h3 id="一、前置条件-必做" tabindex="-1">一、前置条件（必做） <a class="header-anchor" href="#一、前置条件-必做" aria-label="Permalink to &quot;一、前置条件（必做）&quot;">​</a></h3><ol><li>远程服务器准备： <ul><li>已安装 Docker 和 Docker Compose（推荐 Docker 20.10+）；</li><li>开启 Docker 远程访问（允许 IDEA 连接）；</li><li>服务器开放 Docker 远程端口（默认 2375，需防火墙放行）。</li></ul></li><li>本地 IDEA 准备： <ul><li>IDEA 2022.3+（内置<code>spring-boot-docker-compose</code>插件，低版本需手动安装）；</li><li>项目引入 Spring Boot 3.1+（<code>spring-boot-docker-compose</code>从 3.1 开始内置支持）；</li><li>本地安装<code>docker-compose</code>（可选，仅用于本地调试命令）。</li></ul></li></ol><h3 id="二、步骤-1-配置远程-docker-让-idea-连接远程服务器的-docker" tabindex="-1">二、步骤 1：配置远程 Docker（让 IDEA 连接远程服务器的 Docker） <a class="header-anchor" href="#二、步骤-1-配置远程-docker-让-idea-连接远程服务器的-docker" aria-label="Permalink to &quot;二、步骤 1：配置远程 Docker（让 IDEA 连接远程服务器的 Docker）&quot;">​</a></h3><p>这是核心前提，IDEA 需能访问远程服务器的 Docker 守护进程：</p><h4 id="_1-1-远程服务器开启-docker-远程访问" tabindex="-1">1.1 远程服务器开启 Docker 远程访问 <a class="header-anchor" href="#_1-1-远程服务器开启-docker-远程访问" aria-label="Permalink to &quot;1.1 远程服务器开启 Docker 远程访问&quot;">​</a></h4><p>编辑 Docker 配置文件，开启 TCP 端口访问：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 编辑Docker配置（不同系统路径可能不同）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/docker/daemon.json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 添加以下内容（允许远程访问，注意替换服务器内网IP）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  &quot;hosts&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tcp://0.0.0.0:2375&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;unix:///var/run/docker.sock&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 重启Docker服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 验证端口是否开放（服务器执行）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tnlp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2375</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输出类似：tcp6       0      0 :::2375                 :::*                    LISTEN      1234/dockerd</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>安全提示：生产环境需限制 IP 访问（如仅允许你的本地 IP），或使用 TLS 加密（参考 Docker 官方文档）。</p></blockquote><h4 id="_1-2-idea-配置远程-docker-连接" tabindex="-1">1.2 IDEA 配置远程 Docker 连接 <a class="header-anchor" href="#_1-2-idea-配置远程-docker-连接" aria-label="Permalink to &quot;1.2 IDEA 配置远程 Docker 连接&quot;">​</a></h4><ol><li>打开 IDEA → 点击顶部<code>File</code> → <code>Settings</code> → <code>Build, Execution, Deployment</code> → <code>Docker</code>；</li><li>点击<code>+</code>添加 Docker 连接，选择<code>TCP socket</code>；</li><li>配置参数： <ul><li>Name：自定义（如<code>Remote-Docker</code>）；</li><li>Engine API URL：<code>tcp://远程服务器IP:2375</code>（如<code>tcp://192.168.1.100:2375</code>）；</li></ul></li><li>点击<code>Test Connection</code>，提示<code>Connection successful</code>即配置成功；</li><li>点击<code>Apply</code> → <code>OK</code>保存。</li></ol><p>注意上述设置完还会报错</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>com.intellij.execution.ExecutionException: Cannot run program &quot;docker&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="`+l+'" alt="image-20260128154944173" loading="lazy"></p><p>需要取消自动检测，手动设置下Docker的执行路径</p><p>Docker执行脚本的下载地址：<a href="https://download.docker.com/win/static/stable/x86_64/" target="_blank" rel="noreferrer">https://download.docker.com/win/static/stable/x86_64/</a></p><p><img src="'+p+'" alt="image-20260128155721668" loading="lazy"></p><p>执行后还会报错</p><p><img src="'+t+'" alt="image-20260128160103375" loading="lazy"></p><p>在上述流程后，仍有可能出现buildx工具无法找到的情况，此时进行如下操作</p><ul><li>在你的用户文件夹下（或在文件管理地址栏输入 <code>%USERPROFILE%</code> 定位）</li><li>新建 <code>.docker</code> 文件夹（注意有个“.”）</li><li>在 <code>.docker</code> 下面再新建一个 <code>cli-plugins</code>文件夹</li><li>下载文件：</li></ul><p><a href="https://github.com/docker/buildx/releases/download/v0.13.1/buildx-v0.13.1.windows-amd64.exe" target="_blank" rel="noreferrer">https://github.com/docker/buildx/releases/download/v0.13.1/buildx-v0.13.1.windows-amd64.exe</a></p><ul><li>下载下来，然后重命名为 <code>docker-buildx.exe</code>，然后放入<code>cli-plugins</code>文件夹中</li></ul><p><img src="'+r+'" alt="image-20260128170016263" loading="lazy"></p><h2 id="tls认证连接" tabindex="-1">TLS认证连接 <a class="header-anchor" href="#tls认证连接" aria-label="Permalink to &quot;TLS认证连接&quot;">​</a></h2><p>直接暴露<code>tcp://0.0.0.0:2375</code> 存在安全风险（无认证），且该配置在部分 Docker 版本中会与系统默认配置冲突；更推荐使用 TLS 认证的方式，而非直接暴露 2375 端口（无认证的 2375 端口是高危操作）。</p><p><a href="https://www.cnblogs.com/guangdelw/p/17565051.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/guangdelw/p/17565051.html</a></p><p><a href="https://www.cnblogs.com/walterlong/articles/11444770.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/walterlong/articles/11444770.html</a></p><p><a href="https://blog.csdn.net/wssdds/article/details/124916924" target="_blank" rel="noreferrer">https://blog.csdn.net/wssdds/article/details/124916924</a></p><p><a href="https://blog.csdn.net/refuse_wwj/article/details/119242525" target="_blank" rel="noreferrer">https://blog.csdn.net/refuse_wwj/article/details/119242525</a></p><p><a href="https://www.jetbrains.com/zh-cn/help/idea/running-a-dbms-image.html" target="_blank" rel="noreferrer">在 Docker 容器中运行数据库 | IntelliJ IDEA 文档</a></p><p><a href="https://springdoc.cn/docker-compose-support-spring-boot/" target="_blank" rel="noreferrer">Spring Boot 3 中对 Docker Compose 的支持 - spring 中文网</a></p><p><a href="https://blog.csdn.net/2301_76154806/article/details/141404952" target="_blank" rel="noreferrer">https://blog.csdn.net/2301_76154806/article/details/141404952</a></p><p><a href="https://ximeneschen.blog.csdn.net/article/details/125651027" target="_blank" rel="noreferrer">https://ximeneschen.blog.csdn.net/article/details/125651027</a></p><p><a href="https://blog.csdn.net/xujingyiss/article/details/119179987" target="_blank" rel="noreferrer">docker-compose部署springboot项目_docker-compose springboot-CSDN博客</a></p><p><a href="https://blog.csdn.net/qq_46028493/article/details/148593977" target="_blank" rel="noreferrer">https://blog.csdn.net/qq_46028493/article/details/148593977</a></p><p><a href="https://blog.csdn.net/Equent/article/details/137779505" target="_blank" rel="noreferrer">【IDEA】解决idea2024无法使用远程构建dockerfile的问题_idea2024 docker-CSDN博客</a></p>',55)])])}const y=a(h,[["render",k]]);export{m as __pageData,y as default};
