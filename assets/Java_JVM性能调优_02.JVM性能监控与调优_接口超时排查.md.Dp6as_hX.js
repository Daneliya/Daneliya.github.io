import{_ as a,c as i,o as n,aN as e}from"./chunks/framework.CMIDsdwV.js";const o=JSON.parse('{"title":"æ¥å£è¶…æ—¶æ’æŸ¥","description":"","frontmatter":{"title":"æ¥å£è¶…æ—¶æ’æŸ¥","permalink":"/java/jvm/brokenPipe","tags":["ç³»ç»Ÿä¼˜åŒ–"],"categories":["ç³»ç»Ÿä¼˜åŒ–"]},"headers":[],"relativePath":"Java/JVMæ€§èƒ½è°ƒä¼˜/02.JVMæ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜/æ¥å£è¶…æ—¶æ’æŸ¥.md","filePath":"Java/JVMæ€§èƒ½è°ƒä¼˜/02.JVMæ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜/æ¥å£è¶…æ—¶æ’æŸ¥.md","lastUpdated":1767444225000}'),l={name:"Java/JVMæ€§èƒ½è°ƒä¼˜/02.JVMæ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜/æ¥å£è¶…æ—¶æ’æŸ¥.md"};function p(t,s,h,r,k,d){return n(),i("div",null,[...s[0]||(s[0]=[e(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /Java\\JVMæ€§èƒ½è°ƒä¼˜\\02.JVMæ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜\\æ¥å£è¶…æ—¶æ’æŸ¥.md for this page in Markdown format</div><h1 id="æ¥å£è¶…æ—¶æ’æŸ¥" tabindex="-1">æ¥å£è¶…æ—¶æ’æŸ¥ <a class="header-anchor" href="#æ¥å£è¶…æ—¶æ’æŸ¥" aria-label="Permalink to &quot;æ¥å£è¶…æ—¶æ’æŸ¥&quot;">â€‹</a></h1><p>ç”Ÿäº§ç¯å¢ƒçªç„¶æŠ¥ç³»ç»Ÿç¹å¿™ï¼Œé€šè¿‡æŸ¥çœ‹å½“æ—¶çš„æ—¥å¿—å‘ç°æ¥å£æŠ¥ <strong>java.io.IOException:Broken pipe</strong> ï¼Œå¤ç°æŠ“åŒ…çœ‹åˆ°ç½‘å…³æŠ¥ 504(Gateway Timeout)ã€‚</p><h2 id="åŸå› åˆ†æ" tabindex="-1">åŸå› åˆ†æ <a class="header-anchor" href="#åŸå› åˆ†æ" aria-label="Permalink to &quot;åŸå› åˆ†æ&quot;">â€‹</a></h2><p>éšç€æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œåˆ†é¡µçš„é¡µæ•°ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå½“ç¿»é¡µè¿‡å¤šçš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿæ·±åˆ†é¡µï¼Œå¯¼è‡´æŸ¥è¯¢æ•ˆç‡æ€¥å‰§ä¸‹é™ã€‚</p><h2 id="é—®é¢˜å®šä½" tabindex="-1">é—®é¢˜å®šä½ <a class="header-anchor" href="#é—®é¢˜å®šä½" aria-label="Permalink to &quot;é—®é¢˜å®šä½&quot;">â€‹</a></h2><h3 id="ä½¿ç”¨arthaså®šä½é—®é¢˜" tabindex="-1">ä½¿ç”¨arthaså®šä½é—®é¢˜ <a class="header-anchor" href="#ä½¿ç”¨arthaså®šä½é—®é¢˜" aria-label="Permalink to &quot;ä½¿ç”¨arthaså®šä½é—®é¢˜&quot;">â€‹</a></h3><p>ä¸€èˆ¬é€šè¿‡ä»£ç reviewï¼Œå°±èƒ½å¤§æ¦‚çŒœæµ‹é—®é¢˜ç‚¹ã€‚å¦‚æœé¡¹ç›®åŸºå»ºæˆç†Ÿï¼Œä½¿ç”¨skywalkingå¯ä»¥çœ‹åˆ°æ¯æ¬¡è¯·æ±‚è€—æ—¶ã€‚ä¹Ÿå¯ä»¥é€šè¿‡arthaså·¥å…·ï¼Œå¸®å¿™å®šä½ä¸‹å…·ä½“çš„è€—æ—¶æ–¹æ³•ã€‚</p><p>åœ¨æœåŠ¡å™¨ä¸Šä¸‹è½½arthas</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://arthas.aliyun.com/arthas-boot.jar</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxl@xxl-ubuntu:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/xxl/tools</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxl@xxl-ubuntu:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arthas</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxl@xxl-ubuntu:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://arthas.aliyun.com/arthas-boot.jar</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å¯åŠ¨arthas</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxl@xxl-ubuntu:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arthas-boot.jar</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>é€‰æ‹©è¦æŠ“å–çš„jaråŒ…</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxl@xxl-ubuntu:~/tools/arthas$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arthas-boot.jar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[INFO] JAVA_HOME: /usr/lib/jvm/java-11-openjdk-amd64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[INFO] arthas-boot version: 3.7.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[INFO] Can not find java process. Try to run </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">jps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lists</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instrumented</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Java</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HotSpot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VMs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> select</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> an</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pid.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xxl@xxl-ubuntu:~/tools/arthas$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arthas-boot.jar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[INFO] JAVA_HOME: /usr/lib/jvm/java-11-openjdk-amd64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[INFO] arthas-boot version: 3.7.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[INFO] Found existing java process, please choose one and input the serial number of the process, eg </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1. Then hit ENTER.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [1]: 13059 xxl-ubuntu-springboot-0.0.1-SNAPSHOT.jar</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>ä½¿ç”¨ stack å‘½ä»¤å¯ä»¥çœ‹åˆ°æ–¹æ³•å†…éƒ¨è°ƒç”¨å‘½ä»¤ ğŸ‘‰ï¼šâ€‹<a href="https://arthas.aliyun.com/doc/trace.html" target="_blank" rel="noreferrer">trace | arthas (aliyun.com)</a></p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ç±»å+æ–¹æ³•å</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> com.xxl.xxl.controller.UbuntuController</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> helloUbuntu</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ä¸‹è½½æ’ä»¶ <code>arthas idea</code>ï¼Œåœ¨æ–¹æ³•åä¸Šå³é”® <code>Arthas Command</code> ï¼Œ<code>Trace</code>ã€‚</p><p>åˆ°shellä¸­ç²˜è´´å‘½ä»¤ï¼ŒæŸ¥çœ‹æ–¹æ³•å†…è¯¦ç»†è€—æ—¶ä¿¡æ¯</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[arthas@16342]$ trace com.xxl.xxl.controller.UbuntuController helloUbuntu2  -n 5 --skipJDKMethod false </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Press</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Q</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Ctrl+C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> abort.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Affect(class</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> method</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) cost in 68 ms, listenerId: 2</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">---ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2023-09-24 </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">19:50:59</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">thread_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http-nio-8080-exec-5;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">16;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">is_daemon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">true;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">priority</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">5;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TCCL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">org.springframework.boot.web.embedded.tomcat.TomcatEmbeddedWebappClassLoader@7ba8c737</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---[0.281693ms]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> com.xxl.xxl.controller.UbuntuController:helloUbuntu2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">---[54.11%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0.152427ms ] com.xxl.xxl.controller.UbuntuController:add() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#20</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="mybatis-plusæ•´åˆp6spyæ‰“å°sqlè€—æ—¶" tabindex="-1">Mybatis-Plusæ•´åˆp6spyæ‰“å°SQLè€—æ—¶ <a class="header-anchor" href="#mybatis-plusæ•´åˆp6spyæ‰“å°sqlè€—æ—¶" aria-label="Permalink to &quot;Mybatis-Plusæ•´åˆp6spyæ‰“å°SQLè€—æ—¶&quot;">â€‹</a></h3><p>æ·»åŠ ä¾èµ–</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;p6spy&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;p6spy&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;3.9.1&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ä¿®æ”¹æ•°æ®åº“è¿æ¥é…ç½®</p><p><code>driver-class-name</code>ç”¨<code>p6spy</code>æä¾›çš„é©±åŠ¨ç±»</p><p><code>url</code>å‰ç¼€ä¸º<code>jdbc:p6spy</code>è·Ÿç€å†’å·ï¼Œåé¢å¯¹åº”æ•°æ®åº“è¿æ¥åœ°å€</p><div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">spring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    datasource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">com.alibaba.druid.pool.DruidDataSource</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        driver-class-name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">com.p6spy.engine.spy.P6SpyDriver</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jdbc:p6spy:mysql://127.0.0.1:3306/test?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true&amp;serverTimezone=UTC</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å¢åŠ é…ç½®æ–‡ä»¶ï¼šåœ¨resourcesæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºp6spyçš„é…ç½®æ–‡ä»¶<code>spy.properties</code></p><div class="language-properties vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#3.2.1ä»¥ä¸Šä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">modulelist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=com.baomidou.mybatisplus.extension.p6spy.MybatisPlusLogFactory,com.p6spy.engine.outage.P6OutageFactory</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#3.2.1ä»¥ä¸‹ä½¿ç”¨æˆ–è€…ä¸é…ç½®</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#modulelist=com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è‡ªå®šä¹‰æ—¥å¿—æ‰“å°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">logMessageFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=com.baomidou.mybatisplus.extension.p6spy.P6SpyLogger</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#appender=com.baomidou.mybatisplus.extension.p6spy.StdoutLogger</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿè®°å½• sql</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">appender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=com.p6spy.engine.spy.appender.Slf4JLogger</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è®¾ç½® p6spy driver ä»£ç†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">deregisterdrivers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=true</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å–æ¶ˆJDBC URLå‰ç¼€</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">useprefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=true</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é…ç½®è®°å½• Log ä¾‹å¤–,å¯å»æ‰çš„ç»“æœé›†æœ‰error,info,batch,debug,statement,commit,rollback,result,resultset.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">excludecategories</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=info,debug,result,commit,resultset</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ—¥æœŸæ ¼å¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">dateformat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=yyyy-MM-dd HH:mm:ss</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å®é™…é©±åŠ¨å¯å¤šä¸ª</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#driverlist=org.h2.Driver</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ˜¯å¦å¼€å¯æ…¢SQLè®°å½•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">outagedetection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=true</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ…¢SQLè®°å½•æ ‡å‡† 2 ç§’</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">outagedetectioninterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="è§£å†³" tabindex="-1">è§£å†³ <a class="header-anchor" href="#è§£å†³" aria-label="Permalink to &quot;è§£å†³&quot;">â€‹</a></h2><p>1ã€åˆ†é¡µå…³é—­æŸ¥è¯¢æ€»æ•°</p><p>å¦‚æœä½¿ç”¨mybatis-plusæä¾›çš„åˆ†é¡µæ’ä»¶ï¼Œä¼šé»˜è®¤å¼€å¯æŸ¥è¯¢æ€»æ•°çš„SQLï¼Œå¦‚æœä¸éœ€è¦å¯ä»¥å…³é—­å‡å°‘ä¸€æ¬¡æŸ¥è¯¢ã€‚</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Page pageReq </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> request.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plusPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pageReq.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setSearchCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2ã€æ¸¸æ ‡åˆ†é¡µ</p><p>æ¸¸æ ‡ç¿»é¡µï¼Œåªè¦å‘½ä¸­ç´¢å¼•ï¼Œé€Ÿåº¦å°±éå¸¸å¿«ï¼Œå’Œæ¶ˆæ¯é‡åŸºæœ¬æ²¡å…³ç³»</p><p><a href="https://blog.51cto.com/u_16213305/7029596" target="_blank" rel="noreferrer">mysqlåˆ†é¡µä½¿ç”¨æ¸¸æ ‡_mob64ca12d1a59eçš„æŠ€æœ¯åšå®¢_51CTOåšå®¢</a></p><p><a href="https://baijiahao.baidu.com/s?id=1773258061474240109&amp;wfr=spider&amp;for=pc" target="_blank" rel="noreferrer">è§£å¯†é«˜æ•ˆåˆ†é¡µæŸ¥è¯¢ï¼šJavaå®ç°MySQLåˆ†é¡µçš„å¥¥ç§˜ (baidu.com)</a></p><p><a href="https://www.zhihu.com/question/590227060/answer/2974873775?utm_id=0" target="_blank" rel="noreferrer">mysql åˆ†é¡µçš„æ–¹æ³•æŠ€å·§æœ‰å“ªäº›ï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://www.zhihu.com/question/432910565/answer/2557661575" target="_blank" rel="noreferrer">MySQLåˆ†é¡µåˆ°äº†åé¢è¶Šæ¥è¶Šæ…¢ï¼Œæœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•ï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p>`,38)])])}const g=a(l,[["render",p]]);export{o as __pageData,g as default};
